<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¬å¯“ç‰©ä¸šæ”¶è´¹ç³»ç»Ÿ - å·¥ä½œå°</title>
    
    <!-- èµ„æºé¢„åŠ è½½ -->
    <link rel="preload" href="/static/lib/vue.global.js" as="script">
    <link rel="preload" href="/static/lib/element-plus.full.js" as="script">
    <link rel="preload" href="/static/lib/element-plus.css" as="style">
    <link rel="preload" href="/static/lib/font-awesome.min.css?v=5" as="style">
    
    <!-- å¼•å…¥ Element Plus æ ·å¼ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¢</text></svg>">
    <link rel="stylesheet" href="/static/lib/element-plus.css">
    <link rel="stylesheet" href="/static/lib/font-awesome.min.css?v=5">
    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="/static/lib/flatpickr/flatpickr.min.css">
    <link rel="stylesheet" href="/static/lib/flatpickr/airbnb.css">
    <!-- Laydate CSS -->
    <link rel="stylesheet" href="/static/lib/layui/layui.min.css">
    <!-- å¼•å…¥ Vue 3 å’Œ Element Plus -->
    <script src="/static/lib/vue.global.js"></script>
    <script src="/static/lib/element-plus.full.js"></script>
    <script src="/static/lib/element-plus-icons.umd.js"></script>
    <!-- Flatpickr JS -->
    <script src="/static/lib/flatpickr/flatpickr.min.js"></script>
    <script src="/static/lib/flatpickr/zh.js"></script>
    <!-- Laydate JS -->
    <script src="/static/lib/layui/layui.min.js?v=7"></script>
    <!-- å†…è”æ—¥å†æ§ä»¶æ ·å¼ -->
    <style>
        .datetime-picker-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .datetime-picker-input {
            width: 100%;
            height: 40px;
            padding: 0 10px;
            border: 1px solid #e6e6e6;
            border-radius: 4px;
            background-color: #fff;
            cursor: pointer;
            box-sizing: border-box;
        }
        
        .datetime-picker-input:focus {
            border-color: #409eff;
            outline: none;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .datetime-picker-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #c0c4cc;
            pointer-events: none;
        }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f2f5;
        }
        
        /* å…¨å±€è¾“å…¥æ¡†è¾¹æ¡†ä¿®å¤ */
        .el-input .el-input__wrapper,
        .el-input-number .el-input-number__wrapper,
        .el-date-editor .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
            overflow: hidden;
        }
        
        .sidebar {
            width: 240px;
            background-color: #001529;
            color: white;
            padding: 0;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);
            position: relative;
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .sidebar-title {
            font-size: 18px;
            font-weight: bold;
            color: white;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }
        
        .sidebar-title i {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .user-info {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
        }
        
        .nav-menu {
            list-style: none;
            padding: 10px 0;
            flex: 1;
            overflow-y: auto;
        }
        
        .nav-item {
            padding: 14px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            position: relative;
            margin: 2px 12px;
            border-radius: 6px;
        }
        
        .nav-item:hover {
            background-color: rgba(24, 144, 255, 0.8);
            transform: translateX(3px);
        }
  /*      
        .nav-item.active {
            background-color: #1890ff;
            box-shadow: 0 2px 8px rgba(24, 144, 255, 0.3);
        }
 */       
        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            /*top: 0;*/
            bottom: 0;
            width: 4px;
            background-color: #fff;
            border-radius: 0 2px 2px 0;
        }
        
        .nav-item i {
            margin-right: 12px;
            font-size: 16px;
            width: 16px;
            text-align: center;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: #f0f2f5;
            overflow: hidden;
        }
        
        .content-wrapper {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .header {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        
        .workbench-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: visible;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            min-width: 120px;
            white-space: nowrap;
            overflow: visible;
            display: block;
            width: 100%;
        }
        
        .address-selector {
            margin-bottom: 30px;
            overflow: visible;
            display: block;
            width: 100%;
        }
        
        .fee-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        /* ä¿®å¤æŒ‰é’®èƒŒæ™¯è‰² */
        .fee-buttons .el-button--primary {
            background-color: #409eff;
            border-color: #409eff;
        }
        
        .fee-buttons .el-button--primary:hover {
            background-color: #66b1ff;
            border-color: #66b1ff;
        }
        
        .fee-buttons .el-button--primary.is-disabled {
            background-color: #a0cfff;
            border-color: #a0cfff;
            opacity: 0.6;
        }
        
        .fee-table {
            width: 100%;
            margin-bottom: 30px;
            border-collapse: collapse;
        }
        
        .fee-table th,
        .fee-table td {
            border: 1px solid #e8e8e8;
            padding: 10px;
            text-align: center;
        }
        
        .fee-table th {
            background-color: #fafafa;
            font-weight: bold;
        }
        
        /* è°ƒæ•´è¡¨æ ¼åˆ—å®½ - è‡ªé€‚åº” */
        .fee-table th:nth-child(1), .fee-table td:nth-child(1) { /* é¡¹ç›®åç§° */
            width: auto;
            min-width: 120px;
        }
        
        .fee-table th:nth-child(2), .fee-table td:nth-child(2) { /* å•ä½ */
            width: auto;
            min-width: 60px;
        }
        
        .fee-table th:nth-child(3), .fee-table td:nth-child(3) { /* æ•°é‡ */
            width: auto;
            min-width: 120px;
        }
        
        .fee-table th:nth-child(4), .fee-table td:nth-child(4) { /* å•ä»· */
            width: auto;
            min-width: 100px;
        }
        
        .fee-table th:nth-child(5), .fee-table td:nth-child(5) { /* é‡‘é¢ */
            width: auto;
            min-width: 120px;
        }
        
        .fee-table th:nth-child(6), .fee-table td:nth-child(6) { /* æ“ä½œ */
            width: auto;
            min-width: 80px;
        }
        
        /* è°ƒæ•´å­—ä½“å¤§å° - æ•°é‡ã€é‡‘é¢ä¸å•ä»·ä¸€è‡´ */
        .fee-table td .el-input,
        .fee-table td .el-input-number,
        .fee-table td .el-input__inner {
            font-size: 14px !important;
            text-align: center;
        }
        
        .fee-table td .el-input-number .el-input__inner {
            font-size: 14px !important;
        }
        
        .fee-table .el-input {
            width: 100% !important;
            max-width: 120px;
        }
        
        .fee-table .el-input-number {
            width: 100% !important;
            max-width: 120px;
        }
        
        .summary-section {
            background: #fafafa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .empty-table {
            text-align: center;
            color: #999;
            padding: 40px;
        }
        
        .fee-item-actions {
            display: flex;
            gap: 5px;
            justify-content: center;
        }
        
        /* åœ°å€é€‰æ‹©å™¨æ ·å¼ - ç§»é™¤å¤šä½™è¾¹æ¡† */
        .address-selector .el-input .el-input__wrapper,
        .address-selector .el-select .el-select__wrapper {
            border: none !important;
            box-shadow: none !important;
            background-color: transparent !important;
        }
        
        /* åœ°å€é€‰æ‹©å™¨ä¸­çš„form-controlæ ·å¼ */
        .address-selector .form-control {
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background-color: #ffffff;
            padding: 0;
        }
        
        }
        
        /* ç¡®ä¿åœ°å€é€‰æ‹©å™¨ä¸­çš„è¾“å…¥æ¡†å’Œä¸‹æ‹‰æ¡†ä¸æ˜¾ç¤ºå†…éƒ¨è¾¹æ¡† */
        .address-selector .el-input .el-input__inner,
        .address-selector .el-select .el-select__inner {
            border: none !important;
            box-shadow: none !important;
        }
        
        /* åœ°å€é€‰æ‹©å™¨æ ·å¼ - æ¨ªå‘æ’åˆ— */
        .address-row {
            display: flex;
            flex-wrap: nowrap;  /* ç¦æ­¢æ¢è¡Œ */
            gap: 20px;
            align-items: flex-start;
            justify-content: flex-start;
            overflow-x: auto;   /* å…è®¸æ¨ªå‘æ»šåŠ¨ */
            width: 100%;
            min-height: auto;
            height: auto;
        }
        
        .address-row > .address-field:first-child {
            margin-left: 10px;
        }
        
        .address-field {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 150px;
            flex-shrink: 0;
        }

        .field-label {
            font-size: 14px;
            color: #606266;
            font-weight: 500;
            margin-bottom: 4px;
        }

        /* é”™è¯¯æç¤ºæ ·å¼ */
        .phone-error {
            color: #f56c6c;
            font-size: 12px;
            margin-top: 5px;
        }

        /* ç”¨æˆ·å†å²ç¼´è´¹è®°å½•æ ·å¼ */
        .user-history-section {
            margin-top: 20px;
            border: 1px solid #e4e7ed;
            border-radius: 6px;
            overflow: hidden;
        }

        .history-header {
            background: #f5f7fa;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #e4e7ed;
            transition: background-color 0.3s ease;
        }

        .history-header:hover {
            background: #ecf5ff;
        }

        .history-title {
            font-size: 14px;
            font-weight: 500;
            color: #303133;
            display: flex;
            align-items: center;
        }

        .collapse-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            margin-right: 8px;
            font-size: 22px;
            color: #909399;
            transition: transform 0.3s ease;
        }

        .history-content {
            padding: 15px;
            background: white;
        }

        .history-loading {
            text-align: center;
            padding: 20px;
            color: #909399;
        }

        .history-empty {
            text-align: center;
            padding: 20px;
            color: #909399;
        }

        .user-history-table-container {
            overflow-x: auto;
        }

        .user-history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        .user-history-table th,
        .user-history-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #ebeef5;
        }
        
        .user-history-table td:last-child {
            text-align: left;
        }

        .user-history-table th {
            background: #fafafa;
            font-weight: 500;
            color: #606266;
        }

        .user-history-table tr:hover {
            background: #f5f7fa;
        }

        .fee-items-cell {
            font-size: 12px;
            line-height: 1.4;
        }

        /* æŒ‰é’®ç¦ç”¨çŠ¶æ€æ ·å¼ */
        .el-button.is-disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* åœè½¦è´¹è¯¦æƒ…åŒºåŸŸæ ·å¼ */
        .parking-detail-row {
            background-color: #f9f9f9;
        }
        
        .parking-detail-cell {
            text-align: left !important;
            padding-left: 20px !important;
            font-size: 14px;
        }
        
        .parking-fields {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .parking-field {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .parking-label {
            font-size: 14px;
            color: #666;
            white-space: nowrap;
        }
        
        .parking-input {
            width: 180px;
        }
        
        .parking-input .el-input__inner,
        .parking-input .el-input-number__inner {
            font-size: 14px;
            padding: 10px;
        }
        
        /* åœè½¦è´¹æ—¥æœŸé€‰æ‹©å™¨æ ·å¼ */
        .parking-date-input {
            width: 150px;
            height: 32px;
            padding: 0 10px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
            color: #606266;
            background-color: #ffffff;
            cursor: pointer;
            box-sizing: border-box;
            transition: none;
        }
        
        /* æ·»åŠ åœ†è§’æ ·å¼ - æ”¶è´¹é¡¹ç›®è¡¨æ ¼ä¸­çš„è¾“å…¥æ¡† */
        .fee-table .el-input .el-input__wrapper,
        .fee-table .el-input-number .el-input-number__wrapper {
            border-radius: 4px !important;
        }
        
        /* æ·»åŠ åœ†è§’æ ·å¼ - åœè½¦è´¹è¯¦ç»†ä¿¡æ¯ä¸­çš„è¾“å…¥æ¡† */
        .parking-detail-cell .el-input .el-input__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-field .el-input .el-input__wrapper,
        .parking-field .el-input-number .el-input-number__wrapper {
            border-radius: 4px !important;
        }
        
        .parking-date-input:hover {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
        }
        
        .parking-date-input:focus {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            outline: none;
        }
        
        .parking-date-input::placeholder {
            color: #c0c4cc;
        }
        
        /* ç§»é™¤è¾“å…¥æ¡†é¼ æ ‡æ‚¬æµ®æ•ˆæœ - æ›´å…·ä½“çš„æ ·å¼ */
        .fee-table .el-input:hover .el-input__inner,
        .fee-table .el-input-number:hover .el-input__inner,
        .fee-table .el-input:hover .el-input__wrapper,
        .fee-table .el-input-number:hover .el-input__wrapper,
        .parking-input .el-input:hover .el-input__inner,
        .parking-input .el-input-number:hover .el-input__inner,
        .parking-input .el-input:hover .el-input__wrapper,
        .parking-input .el-input-number:hover .el-input__wrapper,
        .parking-field .el-input:hover .el-input__inner,
        .parking-field .el-input-number:hover .el-input__inner,
        .parking-field .el-input:hover .el-input__wrapper,
        .parking-field .el-input-number:hover .el-input__wrapper,
        .parking-field .el-date-picker:hover .el-input__inner,
        .parking-field .el-date-picker:hover .el-input__wrapper,
        .fee-table td .el-input:hover,
        .fee-table td .el-input-number:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            transform: none !important;
        }
        
        /* æ›´å¼ºåˆ¶çš„ç§»é™¤æ‚¬æµ®æ•ˆæœ - é’ˆå¯¹æ‰€æœ‰ç›¸å…³å…ƒç´  */
        .fee-table .el-input__wrapper:hover,
        .fee-table .el-input-number__wrapper:hover,
        .parking-field .el-input__wrapper:hover,
        .parking-field .el-input-number__wrapper:hover,
        .parking-field .el-date-editor__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            transform: none !important;
        }
        
        /* ä¿®å¤è¾“å…¥æ¡†è¾¹æ¡†æ˜¾ç¤ºé—®é¢˜ */
        .fee-table .el-input .el-input__wrapper,
        .fee-table .el-input-number .el-input-number__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-field .el-input-number .el-input-number__wrapper,
        .parking-field .el-date-editor .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
        }
        
        /* ç¡®ä¿è¾“å…¥æ¡†å†…éƒ¨å…ƒç´ ä¹Ÿæœ‰æ­£ç¡®çš„è¾¹æ¡† */
        .fee-table .el-input .el-input__inner,
        .fee-table .el-input-number .el-input__inner,
        .parking-detail-cell .el-input-number .el-input__inner,
        .parking-field .el-input-number .el-input__inner,
        .parking-field .el-date-editor .el-input__inner {
            border: none !important;
            box-shadow: none !important;
            background-color: transparent !important;
        }
        
        /* è½¦ç‰Œå·è¾“å…¥æ¡†ä¸“ç”¨æ ·å¼ - ç¡®ä¿æ­£å¸¸äº¤äº’ */
        .parking-detail-cell .parking-field .el-input .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
            pointer-events: auto !important;
            cursor: text !important;
        }
        
        .parking-detail-cell .parking-field .el-input .el-input__inner {
            background-color: #ffffff !important;
            pointer-events: auto !important;
            cursor: text !important;
        }
        
        /* å¼ºåˆ¶æ˜¾ç¤ºæ‰€æœ‰è¾“å…¥æ¡†çš„è¾¹æ¡† - æœ€é«˜ä¼˜å…ˆçº§ */
        .fee-table .el-input__wrapper,
        .fee-table .el-input-number__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-field .el-input__wrapper,
        .parking-field .el-input-number__wrapper,
        .parking-field .el-date-editor__wrapper,
        .el-input__wrapper,
        .el-input-number__wrapper {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        /* è¦†ç›–æ‰€æœ‰å¯èƒ½çš„éšè—è¾¹æ¡†æ ·å¼ */
        .fee-table .el-input__wrapper,
        .fee-table .el-input-number__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-field .el-input__wrapper,
        .parking-field .el-input-number__wrapper,
        .parking-field .el-date-editor__wrapper {
            border-width: 1px !important;
            border-style: solid !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        /* ç‰¹åˆ«é’ˆå¯¹æ”¶è´¹å·¥ä½œå°ä¸­çš„è¾“å…¥æ¡† */
        .fee-table td .el-input-number,
        .fee-table td .el-input,
        .parking-field .el-input,
        .parking-field .el-input-number,
        .parking-field .el-date-editor {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* ç¡®ä¿æ‰€æœ‰è¾“å…¥æ¡†ç»„ä»¶éƒ½æœ‰è¾¹æ¡† */
        .el-input,
        .el-input-number,
        .el-date-editor {
            border: 1px solid #dcdfe6 !important;
        }
        
        .el-input .el-input__wrapper,
        .el-input-number .el-input-number__wrapper,
        .el-date-editor .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        /* æœ€å¼ºåˆ¶çš„ç§»é™¤æ‚¬æµ®æ•ˆæœ - è¦†ç›–æ‰€æœ‰å¯èƒ½çš„æ ·å¼ */
        .fee-table *:hover > .el-input__wrapper,
        .fee-table *:hover > .el-input-number__wrapper,
        .parking-detail-cell *:hover > .el-input__wrapper,
        .parking-detail-cell *:hover > .el-input-number__wrapper,
        .parking-detail-cell *:hover > .el-date-editor__wrapper {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            transform: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„è¾“å…¥æ¡†æ‚¬æµ®æ•ˆæœ */
        .fee-table .el-input:hover,
        .fee-table .el-input-number:hover,
        .fee-table .el-date-picker:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover,
        .fee-table td .el-input:hover,
        .fee-table td .el-input-number:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„è¾“å…¥æ¡†wrapperæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-input__wrapper:hover,
        .fee-table .el-input-number__wrapper:hover,
        .fee-table .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
        }
        
        /* å½»åº•ç§»é™¤æ”¶è´¹é¡¹ç›®å’Œåœè½¦è´¹è¾“å…¥æ¡†çš„æ‰€æœ‰åŠ¨æ€æ•ˆæœ */
        .fee-table .el-input,
        .fee-table .el-input-number,
        .fee-table .el-date-picker,
        .fee-table .el-select,
        .parking-detail-cell .el-input,
        .parking-detail-cell .el-input-number,
        .parking-detail-cell .el-select,
        .fee-table td .el-input,
        .fee-table td .el-input-number,
        .fee-table td .el-date-picker,
        .fee-table td .el-select,
        .parking-detail-cell .el-input,
        .parking-detail-cell .el-input-number,
        .parking-detail-cell .el-select {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-input *,
        .fee-table .el-input-number *,
        .fee-table .el-date-picker *,
        .fee-table .el-select *,
        .parking-detail-cell .el-input *,
        .parking-detail-cell .el-input-number *,
        .parking-detail-cell .el-date-picker *,
        .parking-detail-cell .el-select *,
        .fee-table td .el-input *,
        .fee-table td .el-input-number *,
        .fee-table td .el-date-picker *,
        .fee-table td .el-select *,
        .parking-detail-cell .el-input *,
        .parking-detail-cell .el-input-number *,
        .parking-detail-cell .el-date-picker *,
        .parking-detail-cell .el-select * {
            transition: none !important;
            transform: none !important;
        }
        
        /* ç§»é™¤æ‰€æœ‰å¯èƒ½çš„æ‚¬æµ®æ•ˆæœ */
        .fee-table .el-input:hover,
        .fee-table .el-input-number:hover,
        .fee-table .el-date-picker:hover,
        .fee-table .el-select:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover,
        .parking-detail-cell .el-select:hover,
        .fee-table td .el-input:hover,
        .fee-table td .el-input-number:hover,
        .fee-table td .el-date-picker:hover,
        .fee-table td .el-select:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover,
        .parking-detail-cell .el-select:hover,
        .fee-table .el-input:hover *,
        .fee-table .el-input-number:hover *,
        .fee-table .el-date-picker:hover *,
        .fee-table .el-select:hover *,
        .parking-detail-cell .el-input:hover *,
        .parking-detail-cell .el-input-number:hover *,
        .parking-detail-cell .el-date-picker:hover *,
        .parking-detail-cell .el-select:hover *,
        .fee-table td .el-input:hover *,
        .fee-table td .el-input-number:hover *,
        .fee-table td .el-date-picker:hover *,
        .fee-table td .el-select:hover *,
        .parking-detail-cell .el-input:hover *,
        .parking-detail-cell .el-input-number:hover *,
        .parking-detail-cell .el-date-picker:hover *,
        .parking-detail-cell .el-select:hover * {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* ç§»é™¤æ‰€æœ‰å¯èƒ½çš„ç„¦ç‚¹æ•ˆæœ */
        .fee-table .el-input.is-focus,
        .fee-table .el-input-number.is-focus,
        .fee-table .el-date-picker.is-focus,
        .fee-table .el-select.is-focus,
        .parking-detail-cell .el-input.is-focus,
        .parking-detail-cell .el-input-number.is-focus,
        .parking-detail-cell .el-date-picker.is-focus,
        .parking-detail-cell .el-select.is-focus,
        .fee-table td .el-input.is-focus,
        .fee-table td .el-input-number.is-focus,
        .fee-table td .el-date-picker.is-focus,
        .fee-table td .el-select.is-focus,
        .parking-detail-cell .el-input.is-focus,
        .parking-detail-cell .el-input-number.is-focus,
        .parking-detail-cell .el-date-picker.is-focus,
        .parking-detail-cell .el-select.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* ç§»é™¤æ‰€æœ‰å¯èƒ½çš„wrapperæ‚¬æµ®å’Œç„¦ç‚¹æ•ˆæœ */
        .fee-table .el-input__wrapper,
        .fee-table .el-input-number__wrapper,
        .fee-table .el-date-editor__wrapper,
        .fee-table .el-select__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-detail-cell .el-date-editor__wrapper,
        .parking-detail-cell .el-select__wrapper,
        .fee-table td .el-input__wrapper,
        .fee-table td .el-input-number__wrapper,
        .fee-table td .el-date-editor__wrapper,
        .fee-table td .el-select__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-detail-cell .el-date-editor__wrapper,
        .parking-detail-cell .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input__wrapper:hover,
        .fee-table .el-input-number__wrapper:hover,
        .fee-table .el-date-editor__wrapper:hover,
        .fee-table .el-select__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .fee-table td .el-date-editor__wrapper:hover,
        .fee-table td .el-select__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* ç§»é™¤æ‰€æœ‰å¯èƒ½çš„inneræ‚¬æµ®å’Œç„¦ç‚¹æ•ˆæœ */
        .fee-table .el-input__inner,
        .fee-table .el-input-number__inner,
        .fee-table .el-date-editor__inner,
        .fee-table .el-select__inner,
        .parking-detail-cell .el-input__inner,
        .parking-detail-cell .el-input-number__inner,
        .parking-detail-cell .el-date-editor__inner,
        .parking-detail-cell .el-select__inner,
        .fee-table td .el-input__inner,
        .fee-table td .el-input-number__inner,
        .fee-table td .el-date-editor__inner,
        .fee-table td .el-select__inner,
        .parking-detail-cell .el-input__inner,
        .parking-detail-cell .el-input-number__inner,
        .parking-detail-cell .el-date-editor__inner,
        .parking-detail-cell .el-select__inner {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input__inner:hover,
        .fee-table .el-input-number__inner:hover,
        .fee-table .el-date-editor__inner:hover,
        .fee-table .el-select__inner:hover,
        .parking-detail-cell .el-input__inner:hover,
        .parking-detail-cell .el-input-number__inner:hover,
        .parking-detail-cell .el-date-editor__inner:hover,
        .parking-detail-cell .el-select__inner:hover,
        .fee-table td .el-input__inner:hover,
        .fee-table td .el-input-number__inner:hover,
        .fee-table td .el-date-editor__inner:hover,
        .fee-table td .el-select__inner:hover,
        .parking-detail-cell .el-input__inner:hover,
        .parking-detail-cell .el-input-number__inner:hover,
        .parking-detail-cell .el-date-editor__inner:hover,
        .parking-detail-cell .el-select__inner:hover {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„form-controlæ‚¬æµ®æ•ˆæœ */
        .fee-table .form-control,
        .parking-detail-cell .form-control,
        .fee-table td .form-control,
        .parking-detail-cell .form-control {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .form-control:hover,
        .parking-detail-cell .form-control:hover,
        .fee-table td .form-control:hover,
        .parking-detail-cell .form-control:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .form-control:focus-within,
        .parking-detail-cell .form-control:focus-within,
        .fee-table td .form-control:focus-within,
        .parking-detail-cell .form-control:focus-within {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-inputæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-input,
        .parking-detail-cell .el-input,
        .fee-table td .el-input,
        .parking-detail-cell .el-input {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-input:hover,
        .parking-detail-cell .el-input:hover,
        .fee-table td .el-input:hover,
        .parking-detail-cell .el-input:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-input.is-focus,
        .parking-detail-cell .el-input.is-focus,
        .fee-table td .el-input.is-focus,
        .parking-detail-cell .el-input.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-input-wrapperæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-input__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .fee-table td .el-input__wrapper,
        .parking-detail-cell .el-input__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-input-numberæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-input-number,
        .parking-detail-cell .el-input-number,
        .fee-table td .el-input-number,
        .parking-detail-cell .el-input-number {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-input-number:hover,
        .parking-detail-cell .el-input-number:hover,
        .fee-table td .el-input-number:hover,
        .parking-detail-cell .el-input-number:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-input-number.is-focus,
        .parking-detail-cell .el-input-number.is-focus,
        .fee-table td .el-input-number.is-focus,
        .parking-detail-cell .el-input-number.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-input-number-wrapperæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-input-number__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .fee-table td .el-input-number__wrapper,
        .parking-detail-cell .el-input-number__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-date-pickeræ‚¬æµ®æ•ˆæœ */
        .fee-table .el-date-picker,
        .parking-detail-cell .el-date-picker,
        .fee-table td .el-date-picker,
        .parking-detail-cell .el-date-picker {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-date-picker:hover,
        .parking-detail-cell .el-date-picker:hover,
        .fee-table td .el-date-picker:hover,
        .parking-detail-cell .el-date-picker:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-date-picker.is-focus,
        .parking-detail-cell .el-date-picker.is-focus,
        .fee-table td .el-date-picker.is-focus,
        .parking-detail-cell .el-date-picker.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-date-editor-wrapperæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-date-editor__wrapper,
        .parking-detail-cell .el-date-editor__wrapper,
        .fee-table td .el-date-editor__wrapper,
        .parking-detail-cell .el-date-editor__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .fee-table td .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-selectæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-select,
        .parking-detail-cell .el-select,
        .fee-table td .el-select,
        .parking-detail-cell .el-select {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-select:hover,
        .parking-detail-cell .el-select:hover,
        .fee-table td .el-select:hover,
        .parking-detail-cell .el-select:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-select.is-focus,
        .parking-detail-cell .el-select.is-focus,
        .fee-table td .el-select.is-focus,
        .parking-detail-cell .el-select.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–å…¨å±€çš„el-select-wrapperæ‚¬æµ®æ•ˆæœ */
        .fee-table .el-select__wrapper,
        .parking-detail-cell .el-select__wrapper,
        .fee-table td .el-select__wrapper,
        .parking-detail-cell .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-select__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover,
        .fee-table td .el-select__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›–Element Pluså…¨å±€è¾“å…¥æ¡†æ ·å¼ - æœ€å¼ºä¼˜å…ˆçº§ */
        .fee-table .el-input .el-input__wrapper,
        .fee-table .el-input-number .el-input-number__wrapper,
        .fee-table .el-date-picker .el-input__wrapper,
        .fee-table .el-select .el-select__wrapper,
        .parking-detail-cell .el-input .el-input__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-detail-cell .el-select .el-select__wrapper,
        .fee-table td .el-input .el-input__wrapper,
        .fee-table td .el-input-number .el-input-number__wrapper,
        .fee-table td .el-date-picker .el-input__wrapper,
        .fee-table td .el-select .el-select__wrapper,
        .parking-detail-cell .el-input .el-input__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-detail-cell .el-select .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input:hover .el-input__wrapper,
        .fee-table .el-input-number:hover .el-input-number__wrapper,
        .fee-table .el-date-picker:hover .el-input__wrapper,
        .fee-table .el-select:hover .el-select__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-select:hover .el-select__wrapper,
        .fee-table td .el-input:hover .el-input__wrapper,
        .fee-table td .el-input-number:hover .el-input-number__wrapper,
        .fee-table td .el-date-picker:hover .el-input__wrapper,
        .fee-table td .el-select:hover .el-select__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-select:hover .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input.is-focus .el-input__wrapper,
        .fee-table .el-input-number.is-focus .el-input-number__wrapper,
        .fee-table .el-date-picker.is-focus .el-input__wrapper,
        .fee-table .el-select.is-focus .el-select__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-select.is-focus .el-select__wrapper,
        .fee-table td .el-input.is-focus .el-input__wrapper,
        .fee-table td .el-input-number.is-focus .el-input-number__wrapper,
        .fee-table td .el-date-picker.is-focus .el-input__wrapper,
        .fee-table td .el-select.is-focus .el-select__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-select.is-focus .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* è¦†ç›–Element Pluså…¨å±€è¾“å…¥æ¡†æ ·å¼ - é’ˆå¯¹innerå…ƒç´  */
        .fee-table .el-input .el-input__inner,
        .fee-table .el-input-number .el-input__inner,
        .fee-table .el-date-picker .el-input__inner,
        .fee-table .el-select .el-select__inner,
        .parking-detail-cell .el-input .el-input__inner,
        .parking-detail-cell .el-input-number .el-input__inner,
        .parking-detail-cell .el-select .el-select__inner,
        .fee-table td .el-input .el-input__inner,
        .fee-table td .el-input-number .el-input__inner,
        .fee-table td .el-date-picker .el-input__inner,
        .fee-table td .el-select .el-select__inner,
        .parking-detail-cell .el-input .el-input__inner,
        .parking-detail-cell .el-input-number .el-input__inner,
        .parking-detail-cell .el-select .el-select__inner {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input:hover .el-input__inner,
        .fee-table .el-input-number:hover .el-input__inner,
        .fee-table .el-date-picker:hover .el-input__inner,
        .fee-table .el-select:hover .el-select__inner,
        .parking-detail-cell .el-input:hover .el-input__inner,
        .parking-detail-cell .el-input-number:hover .el-input__inner,
        .parking-detail-cell .el-select:hover .el-select__inner,
        .fee-table td .el-input:hover .el-input__inner,
        .fee-table td .el-input-number:hover .el-input__inner,
        .fee-table td .el-date-picker:hover .el-input__inner,
        .fee-table td .el-select:hover .el-select__inner,
        .parking-detail-cell .el-input:hover .el-input__inner,
        .parking-detail-cell .el-input-number:hover .el-input__inner,
        .parking-detail-cell .el-select:hover .el-select__inner {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* è¦†ç›–æ‰€æœ‰å¯èƒ½çš„åŠ¨æ€æ•ˆæœ - æœ€ç»ˆä¿éšœ */
        .fee-table *,
        .parking-detail-cell *,
        .fee-table td *,
        .parking-detail-cell * {
            transition: none !important;
        }
        
        .fee-table *:hover,
        .parking-detail-cell *:hover,
        .fee-table td *:hover,
        .parking-detail-cell *:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* ç‰¹åˆ«è¦†ç›–å…¨å±€çš„ .el-input:hover .el-input__wrapper æ ·å¼ */
        .fee-table .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper,
        .fee-table td .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* ç‰¹åˆ«è¦†ç›–å…¨å±€çš„ .form-control:hover æ ·å¼ */
        .fee-table .form-control:hover,
        .parking-detail-cell .form-control:hover,
        .fee-table td .form-control:hover,
        .parking-detail-cell .form-control:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* ç‰¹åˆ«è¦†ç›–å…¨å±€çš„ .el-date-editor .el-input__inner:hover æ ·å¼ */
        .fee-table .el-date-editor .el-input__inner:hover,
        .parking-detail-cell .el-date-editor .el-input__inner:hover,
        .fee-table td .el-date-editor .el-input__inner:hover,
        .parking-detail-cell .el-date-editor .el-input__inner:hover {
            border-color: #dcdfe6 !important;
            transform: none !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›– el-select çš„ hover å’Œ focus æ•ˆæœ */
        .fee-table .el-select:hover .el-input__wrapper,
        .parking-detail-cell .el-select:hover .el-input__wrapper,
        .fee-table td .el-select:hover .el-input__wrapper,
        .parking-detail-cell .el-select:hover .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-select.is-focus .el-input__wrapper,
        .parking-detail-cell .el-select.is-focus .el-input__wrapper,
        .fee-table td .el-select.is-focus .el-input__wrapper,
        .parking-detail-cell .el-select.is-focus .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›– el-input çš„ focus æ•ˆæœ */
        .fee-table .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper,
        .fee-table td .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›– el-date-editor çš„ focus æ•ˆæœ */
        .fee-table .el-date-editor .el-input__inner:focus,
        .parking-detail-cell .el-date-editor .el-input__inner:focus,
        .fee-table td .el-date-editor .el-input__inner:focus,
        .parking-detail-cell .el-date-editor .el-input__inner:focus {
            border-color: #dcdfe6 !important;
            transform: none !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* è¦†ç›– el-input-number çš„ hover å’Œ focus æ•ˆæœ */
        .fee-table .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper,
        .fee-table td .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper,
        .fee-table td .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* æ±‡æ€»ä¿¡æ¯åŒºå—æ ·å¼ */
        .summary-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        /* æ“ä½œæ ä½æŒ‰é’®æ ·å¼ */
        .action-buttons-cell {
            display: flex;
            gap: 5px;
            justify-content: center;
            align-items: center;
        }
        
        .action-buttons-cell .el-button {
            margin: 0 !important;
            padding: 5px 8px;
            font-size: 12px;
        }

        /* æ—¥æœŸé€‰æ‹©å™¨æ ·å¼ç¾åŒ– - ç°ä»£åŒ–é£æ ¼ */
        .el-date-editor.el-input {
            width: 240px !important;
            position: relative;
        }
        
        .el-date-editor .el-input__inner {
            border-radius: 10px;
            border: 2px solid #e4e7ed;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding-left: 40px;
            height: 40px;
            font-size: 14px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        }
        
        .el-date-editor .el-input__inner:hover {
            border-color: #409eff;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
        }
        
        .el-date-editor .el-input__inner:focus {
            border-color: #409eff;
            box-shadow: 0 0 0 3px rgba(64, 158, 255, 0.15);
            transform: translateY(-1px);
        }
        
        .el-date-editor .el-input__prefix {
            color: #409eff;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .el-date-editor .el-input__prefix .el-input__icon {
            font-size: 16px;
        }
        
        /* æ—¥æœŸé€‰æ‹©é¢æ¿ç¾åŒ– */
        .el-picker-panel {
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            border: 1px solid #e4e7ed;
            overflow: hidden;
        }
        
        .el-picker-panel__body-wrapper {
            background: #ffffff;
        }
        
        .el-picker-panel__header {
            background: linear-gradient(135deg, #409eff 0%, #66b1ff 100%);
            color: white;
            padding: 12px;
            border-bottom: none;
        }
        
        .el-picker-panel__header .el-picker-panel__icon-btn {
            color: white;
            font-size: 16px;
        }
        
        .el-picker-panel__header .el-picker-panel__link-btn {
            color: white;
            font-weight: 500;
        }
        
        .el-date-table th {
            background: #f5f7fa;
            color: #606266;
            font-weight: 600;
            padding: 8px;
            border-bottom: 1px solid #ebeef5;
        }
        
        .el-date-table td.today .el-date-table-cell__text {
            background: #ecf5ff;
            color: #409eff;
            font-weight: 600;
            border-radius: 4px;
        }
        
        .el-date-table td.current:not(.disabled) .el-date-table-cell__text {
            background: #409eff;
            color: white;
            font-weight: 600;
            border-radius: 4px;
        }
        
        .el-date-table td.available:hover .el-date-table-cell__text {
            background: #f0f9ff;
            color: #409eff;
            border-radius: 4px;
        }
        
        /* æ—¶é—´é€‰æ‹©é¢æ¿ç¾åŒ– */
        .el-time-panel {
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }
        
        .el-time-panel__header {
            background: linear-gradient(135deg, #409eff 0%, #66b1ff 100%);
            color: white;
        }
        
        .el-time-spinner__item:hover:not(.disabled):not(.active) {
            background: #f0f9ff;
            color: #409eff;
        }
        
        .el-time-spinner__item.active:not(.disabled) {
            background: #409eff;
            color: white;
            font-weight: 600;
        }

        /* ç°ä»£åŒ–æ—¥æœŸæ§ä»¶æ ·å¼ - æ–¹æ¡†å½¢çŠ¶ï¼Œä¸å…¶ä»–æ§ä»¶ä¿æŒä¸€è‡´ */
        .modern-date-picker {
            position: relative;
            background: #ffffff;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            box-shadow: 0 0 0 0;
            transition: all 0.3s ease;
            overflow: visible;
            z-index: 1;
            height: 36px;
            width: 180px;
        }

        .modern-date-picker:hover {
            border-color: #c0c4cc;
        }

        .modern-date-picker:focus-within {
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        .modern-date-picker::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.5) 20%, 
                rgba(255, 255, 255, 0.5) 80%, 
                transparent);
            z-index: 1;
        }

        .modern-date-picker:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(64, 158, 255, 0.3);
        }

        .modern-date-picker:focus-within {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1);
            border-color: rgba(64, 158, 255, 0.4);
        }

        /* ç»Ÿä¸€è¡¨å•æ§ä»¶æ‚¬æµ®æ•ˆæœ */
        .form-control {
            position: relative;
            background: #ffffff;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            box-shadow: 0 0 0 0;
            transition: all 0.3s ease;
            overflow: visible;
            z-index: 1;
        }

        .form-control::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.5) 20%, 
                rgba(255, 255, 255, 0.5) 80%, 
                transparent);
            z-index: 1;
        }

        .form-control:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(64, 158, 255, 0.3);
        }

        .form-control:focus-within {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1);
            border-color: rgba(64, 158, 255, 0.4);
        }

        /* Element Plus æ§ä»¶æ ·å¼è°ƒæ•´ */
        .el-select .el-input__wrapper {
            border-radius: 4px !important;
            transition: all 0.3s ease !important;
        }

        .el-select:hover .el-input__wrapper {
            transform: translateY(-3px) scale(1.02) !important;
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15) !important;
            border-color: rgba(64, 158, 255, 0.3) !important;
        }

        .el-select.is-focus .el-input__wrapper {
            transform: translateY(-2px) scale(1.01) !important;
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1) !important;
            border-color: rgba(64, 158, 255, 0.4) !important;
        }

        .el-input .el-input__wrapper {
            border-radius: 4px !important;
            transition: all 0.3s ease !important;
        }

        .el-input:hover .el-input__wrapper {
            transform: translateY(-3px) scale(1.02) !important;
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15) !important;
            border-color: rgba(64, 158, 255, 0.3) !important;
        }

        .el-input.is-focus .el-input__wrapper {
            transform: translateY(-2px) scale(1.01) !important;
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1) !important;
            border-color: rgba(64, 158, 255, 0.4) !important;
        }

        .modern-date-picker input {
            background: transparent;
            border: none;
            outline: none;
            width: 100%;
            height: 100%;
            padding: 0 15px;
            font-size: 14px;
            color: #303133;
            font-weight: 500;
            position: relative;
            z-index: 2;
        }

        .modern-date-picker input::placeholder {
            color: rgba(48, 49, 51, 0.6);
            font-weight: 400;
        }

        .modern-date-picker .date-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #409eff;
            font-size: 16px;
            z-index: 2;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .modern-date-picker:hover .date-icon {
            color: #66b1ff;
            transform: translateY(-50%) scale(1.1);
        }

        /* æ—¥å†æ§ä»¶æ ·å¼ */
        .datetime-picker-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .datetime-picker-input {
            width: 100%;
            height: 40px;
            padding: 0 10px;
            border: 1px solid #e6e6e6;
            border-radius: 4px;
            background-color: #fff;
            cursor: pointer;
            box-sizing: border-box;
        }
        
        .datetime-picker-input:focus {
            border-color: #409eff;
            outline: none;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .datetime-picker-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #c0c4cc;
            pointer-events: none;
        }

        /* Flatpickr ç°ä»£åŒ–ä¸»é¢˜è¦†ç›– */
        .flatpickr-calendar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 
                0 20px 60px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: visible;
            animation: slideUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 999999 !important;
            position: absolute !important;
            margin-top: 5px !important;
            width: 300px !important;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .flatpickr-calendar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(64, 158, 255, 0.6) 20%, 
                rgba(64, 158, 255, 0.6) 80%, 
                transparent);
            z-index: 1;
        }

        .flatpickr-month {
            background: linear-gradient(135deg, rgba(64, 158, 255, 0.1) 0%, rgba(102, 177, 255, 0.1) 100%);
            color: #303133;
            font-weight: 600;
            padding: 12px 10px;
            border-radius: 20px 20px 0 0;
            border-bottom: 1px solid rgba(64, 158, 255, 0.1);
            position: relative;
            z-index: 100;
            overflow: visible;
            min-height: 45px;
            height: auto;
        }

        .flatpickr-month .flatpickr-prev-month,
        .flatpickr-month .flatpickr-next-month {
            color: #409eff;
            fill: #409eff;
            transition: all 0.3s ease;
            position: relative;
            z-index: 101;
        }

        .flatpickr-month .flatpickr-prev-month:hover,
        .flatpickr-month .flatpickr-next-month:hover {
            color: #66b1ff;
            fill: #66b1ff;
            transform: scale(1.2);
        }

        .flatpickr-current-month {
            font-weight: 700;
            color: #303133;
            position: relative;
            z-index: 100;
        }

        .flatpickr-weekdays {
            background: rgba(64, 158, 255, 0.05);
            border-bottom: 1px solid rgba(64, 158, 255, 0.1);
        }

        .flatpickr-weekday {
            color: #606266;
            font-weight: 600;
            font-size: 12px;
        }

        .flatpickr-day {
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: 500;
        }

        .flatpickr-day:hover {
            background: rgba(64, 158, 255, 0.1);
            color: #409eff;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.2);
        }

        .flatpickr-day.today {
            border-color: #409eff;
            background: rgba(64, 158, 255, 0.15);
            color: #409eff;
            font-weight: 700;
        }

        .flatpickr-day.selected {
            background: linear-gradient(135deg, #409eff 0%, #66b1ff 100%);
            color: white;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(64, 158, 255, 0.4);
            transform: scale(1.05);
        }

        .flatpickr-time {
            border-top: 1px solid rgba(64, 158, 255, 0.1);
            background: rgba(64, 158, 255, 0.05);
            border-radius: 0 0 20px 20px;
        }

        .flatpickr-time .numInputWrapper {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            border: 1px solid rgba(64, 158, 255, 0.2);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .flatpickr-time .numInputWrapper:hover {
            border-color: rgba(64, 158, 255, 0.4);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.15);
        }

        .flatpickr-time .numInputWrapper:focus {
            border-color: #409eff;
            box-shadow: 0 0 0 3px rgba(64, 158, 255, 0.1);
        }

        /* æ”¶æ¬¾æ–¹å¼è¡Œæ ·å¼ - æ¢å¤åŸæ¥å¤§å° */
        .payment-method-row {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .payment-label-container {
            min-width: 80px;
        }

        .payment-label {
            font-weight: 500;
            color: #606266;
            font-size: 14px;
        }

        .payment-options-container {
            flex: 1;
        }

        .payment-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .payment-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 120px;
            height: 100px;
            border: 2px solid #e4e7ed;
            border-radius: 8px;
            padding: 15px 10px;
            background-color: #fff;
            transition: all 0.3s ease;
            position: relative;
        }

        .payment-option:hover {
            border-color: #409eff;
            box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .payment-option.selected {
            border-color: #409eff;
            background-color: #ecf5ff;
            box-shadow: 0 2px 12px 0 rgba(64, 158, 255, 0.2);
        }

        .payment-icon {
            font-size: 45px;
            margin-bottom: 8px;
        }

        .wechat-icon {
            color: #07c160; /* å¾®ä¿¡ç»¿è‰² */
        }

        .alipay-icon {
            color: #1677ff; /* æ”¯ä»˜å®è“è‰² */
        }

        .cash-icon {
            color: #f56c6c; /* ç°é‡‘çº¢è‰² */
        }

        .payment-text {
            font-size: 14px;
            font-weight: 500;
            color: #606266;
        }

        .payment-check {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background-color: #409eff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        /* å¤‡æ³¨æ–‡æœ¬æ¡†å·¦å¯¹é½ */
        .summary-row .el-textarea__inner {
            text-align: left;
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
            min-height: 80px;
        }

        /* æ€»è®¡é‡‘é¢æ ·å¼ */
        .total-amount {
            font-size: 20px;
            font-weight: bold;
            color: #303133;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid #e8e8e8;
        }

        /* ä»Šæ—¥æ”¶è´¹è®°å½•è¡¨æ ¼æ ·å¼ */
        .recent-records-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .today-total {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
        }

        .today-total .amount {
            font-size: 24px;
            margin-left: 10px;
            color: #ffd700;
            font-weight: bold;
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* è¡¨æ ¼å®¹å™¨æ ·å¼ - æ·»åŠ æ¨ªå‘æ»šåŠ¨ */
        .recent-records-table-container {
            overflow-x: auto;
            margin-top: 15px;
            border-radius: 4px;
            border: 1px solid #e4e7ed;
        }

        .recent-records-table {
            width: auto;
            border-collapse: collapse;
            table-layout: auto;
            font-size: 13px;
            min-width: 100%;
        }

        .recent-records-table th {
            background-color: #f5f7fa;
            color: #606266;
            font-weight: 500;
            text-align: center;
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            white-space: nowrap;
        }

        .recent-records-table td {
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
        }

        /* å¤‡æ³¨æ ä½å…è®¸æ¢è¡Œ */
        .recent-records-table th:nth-child(8),
        .recent-records-table td:nth-child(8) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 150px;
            max-width: 200px;
            text-align: left;  /* æ·»åŠ å·¦å¯¹é½ */
        }

        /* æ”¶è´¹é¡¹ç›®æ ä½å…è®¸æ¢è¡Œ */
        .recent-records-table th:nth-child(6),
        .recent-records-table td:nth-child(6) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 300px;
            max-width: 500px;
            text-align: left;
        }

        .recent-records-table .fee-items-cell {
            text-align: left;
            padding: 5px 15px;
            line-height: 1.5;
        }

        .recent-records-table .fee-items-cell div {
            margin-bottom: 3px;
        }

        .recent-records-table tr:hover {
            background-color: #f5f7fa;
        }

        .recent-records-table .action-buttons-cell {
            display: flex;
            gap: 5px;
            justify-content: center;
            white-space: nowrap;
        }
        
        /* é‡æ‰“å°ç¥¨æŒ‰é’® */
        .reprint-button {
            margin-left: 5px;
        }

        /* æ‰“å°æ ·å¼ */
        @media print {
            /* éšè—æ‰€æœ‰å†…å®¹ */
            body * {
                visibility: hidden;
            }
            /* åªæ˜¾ç¤ºæ‰“å°åŒºåŸŸ */
            #print-receipt, #print-receipt * {
                visibility: visible;
            }
            /* æ‰“å°åŒºåŸŸæ ·å¼ - è‡ªé€‚åº”çº¸å¼ å°ºå¯¸ */
            #print-receipt {
                position: fixed !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                height: 100vh !important;
                max-width: 100% !important;
                max-height: 100vh !important;
                padding: 10mm !important;
                margin: 0 !important;
                font-family: 'å®‹ä½“', 'SimSun', sans-serif !important;
                font-size: 12px !important;
                overflow: hidden !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                z-index: 9999 !important;
                box-sizing: border-box !important;
                display: flex !important;
                align-items: flex-start !important;
                justify-content: center !important;
            }
            
            /* å°ç¥¨å†…å®¹å®¹å™¨ - å±…ä¸­æ˜¾ç¤ºä¸”è‡ªé€‚åº” */
            #print-receipt .receipt-content {
                width: auto !important;
                max-width: 80mm !important;
                min-width: 60mm !important;
                height: auto !important;
                max-height: calc(100vh - 20mm) !important;
                margin: 0 auto !important;
                padding: 5mm !important;
                box-sizing: border-box !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                overflow: hidden !important;
                background: white !important;
                border: 1px solid #ddd !important;
                font-size: 12px !important;
                line-height: 1.4 !important;
            }
            
            /* å¼ºåˆ¶è®¾ç½®é¡µé¢å°ºå¯¸ä¸ºå•é¡µ */
            @page {
                size: auto !important;
                margin: 0mm !important;
                padding: 0 !important;
                marks: none !important;
                bleed: 0 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                /* å¼ºåˆ¶å•é¡µæ‰“å° */
                overflow: hidden !important;
                /* é˜²æ­¢æµè§ˆå™¨è‡ªåŠ¨ç¼©æ”¾ */
                zoom: 1 !important;
                transform-origin: top left !important;
            }
            
            /* é˜²æ­¢ä»»ä½•å…ƒç´ åˆ†é¡µ */
            #print-receipt,
            #print-receipt *,
            #print-receipt .receipt-content,
            #print-receipt .receipt-content * {
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                orphans: 1 !important;
                widows: 1 !important;
            }
            
            /* ç¡®ä¿HTMLå’ŒBODYä¸ä¼šå½±å“æ‰“å° */
            html, body {
                margin: 0 !important;
                padding: 0 !important;
                visibility: hidden !important;
                background: transparent !important;
                overflow: hidden !important;
                height: 100vh !important;
                width: 100% !important;
            }
            
            /* å°ç¥¨å†…å®¹æ ·å¼ä¼˜åŒ– */
            #print-receipt .receipt-header {
                text-align: center !important;
                margin-bottom: 10px !important;
                padding-bottom: 5px !important;
                border-bottom: 1px dashed #000 !important;
            }
            
            #print-receipt .receipt-header h2 {
                font-size: 14px !important;
                margin: 3px 0 !important;
                font-weight: bold !important;
            }
            
            #print-receipt .receipt-info {
                margin-bottom: 8px !important;
                line-height: 1.3 !important;
                font-size: 11px !important;
            }
            
            #print-receipt .receipt-items {
                margin: 10px 0 !important;
                border-top: 1px dashed #000 !important;
                border-bottom: 1px dashed #000 !important;
                padding: 8px 0 !important;
                font-size: 11px !important;
            }
            
            #print-receipt .receipt-total {
                text-align: right !important;
                font-weight: bold !important;
                font-size: 12px !important;
                margin-top: 8px !important;
                padding-top: 8px !important;
                border-top: 1px solid #000 !important;
            }
            
            #print-receipt .receipt-footer {
                text-align: center !important;
                margin-top: 8px !important;
                padding-top: 5px !important;
                border-top: 1px dashed #000 !important;
                font-size: 10px !important;
                color: #666 !important;
            }
            
            /* ç¡®ä¿æ‰€æœ‰æ–‡æœ¬ä¸ä¼šæ¢è¡Œé™¤éå¿…è¦ */
            #print-receipt .receipt-content > div {
                white-space: nowrap !important;
                overflow: hidden !important;
                text-overflow: ellipsis !important;
            }
            
            /* å…è®¸æ”¶è´¹é¡¹ç›®æ¢è¡Œ */
            #print-receipt .receipt-items div {
                white-space: normal !important;
                word-wrap: break-word !important;
                line-height: 1.2 !important;
            }
        }

        .receipt-content {
            max-width: 80mm;
            font-family: 'å®‹ä½“', 'SimSun', sans-serif;
            font-size: 12px;
            padding: 5mm;
            margin: 0;
            border: 1px dashed #ddd;
            background-color: white;
            box-sizing: border-box;
            page-break-inside: avoid;
        }

        .receipt-header {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #000;
        }

        .receipt-header h2 {
            font-size: 16px;
            margin: 5px 0;
            font-weight: bold;
        }

        .receipt-info {
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .receipt-info .label {
            font-weight: bold;
            margin-right: 5px;
        }

        .receipt-items {
            margin: 15px 0;
            border-top: 1px dashed #000;
            border-bottom: 1px dashed #000;
            padding: 10px 0;
        }

        .receipt-total {
            text-align: right;
            font-weight: bold;
            font-size: 14px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 2px solid #000;
        }

        .receipt-footer {
            text-align: center;
            margin-top: 10px;
            padding-top: 5px;
            border-top: 1px dashed #000;
            font-size: 11px;
            color: #666;
            page-break-after: avoid;
            page-break-inside: avoid;
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .payment-options {
                justify-content: flex-start;
            }
            
            .payment-option {
                width: 100px;
                height: 90px;
            }
            
            .payment-icon {
                font-size: 30px;
            }
            
            .summary-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .summary-row .el-textarea {
                width: 100%;
                max-width: 100% !important;
            }
            
            .parking-fields {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .parking-field {
                width: 100%;
            }
            
            .parking-input {
                width: 100%;
            }
            
            .parking-input .el-input__inner,
            .parking-input .el-input-number__inner {
                font-size: 14px;
                padding: 10px;
            }
            
            .recent-records-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            
            .fee-buttons {
                justify-content: flex-start;
            }
        }
        
        /* ç”¨æˆ·å†å²ç¼´è´¹è®°å½•æ ·å¼ */
        .user-history-section {
            margin-top: 15px;
            border: 1px solid #e4e7ed;
            border-radius: 8px;
            overflow: hidden;
            clear: both; /* ç¡®ä¿åŒºå—å¦èµ·ä¸€è¡Œ */
            width: 100%; /* ç¡®ä¿å æ»¡å®½åº¦ */
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background-color: #f5f7fa;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s;
        }
        
        .history-header:hover {
            background-color: #edf2fc;
        }
        
        .history-title {
            font-weight: 500;
            color: #303133;
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        
        .collapse-icon {
            margin-right: 8px;
            color: #409eff;
            transition: transform 0.3s ease;
            font-size: 22px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            text-align: center;
            line-height: 1;
        }
        
        .history-header:hover .collapse-icon {
            transform: scale(1.1);
        }
        
        .history-toggle-icon {
            color: #909399;
            transition: transform 0.3s;
        }
        
        .history-content {
            padding: 0;
            background-color: #fff;
        }
        
        .user-history-table {
            width: auto;
            border-collapse: collapse;
            table-layout: auto;
            font-size: 13px;
            min-width: 100%;
        }
        
        .user-history-table th {
            background-color: #f5f7fa;
            color: #606266;
            font-weight: 500;
            text-align: center;
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            white-space: nowrap;
        }
        
        .user-history-table td {
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
        }
        
        /* å¤‡æ³¨æ ä½å…è®¸æ¢è¡Œ */
        .user-history-table th:nth-child(7),
        .user-history-table td:nth-child(7) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 150px;
            max-width: 200px;
        }
        
        /* æ”¶è´¹é¡¹ç›®æ ä½å…è®¸æ¢è¡Œ */
        .user-history-table th:nth-child(4),
        .user-history-table td:nth-child(4) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 300px;
            max-width: 500px;
            text-align: left;
        }
        
        .user-history-table .fee-items-cell {
            text-align: left;
            padding: 5px 15px;
            line-height: 1.5;
        }
        
        .user-history-table .fee-items-cell div {
            margin-bottom: 3px;
        }
        
        .user-history-table tr:hover {
            background-color: #f5f7fa;
        }
        
        /* å†å²ç¼´è´¹è®°å½•è¡¨æ ¼å®¹å™¨æ ·å¼ - æ·»åŠ æ¨ªå‘æ»šåŠ¨ */
        .user-history-table-container {
            overflow-x: auto;
            border-radius: 4px;
            border: 1px solid #e4e7ed;
        }
        
        .history-loading, .history-empty {
            text-align: center;
            padding: 20px;
            color: #909399;
            font-size: 14px;
        }

        /* è®¢å•æŸ¥è¯¢é¡µé¢æ ·å¼ */
        .order-query-container {
            padding: 24px;
            background-color: #fff;
            min-height: calc(100vh - 120px);
        }

        /* ç­›é€‰æ¡ä»¶åŒºåŸŸ */
        .filter-section {
            background-color: #F5F7FA;
            border: 1px solid #E5E6EB;
            border-top: none;
            border-bottom: none;
            padding: 16px 24px;
            margin: 0 -24px 16px -24px;
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: flex-start;
        }

        .filter-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            min-width: 280px;
        }

        .filter-label {
            width: 80px;
            font-size: 14px;
            color: #606266;
            line-height: 32px;
            flex-shrink: 0;
        }

        /* æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨ */
        .date-range-picker {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 320px;
        }

        .date-input-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
            flex: 1;
        }

        .date-input-group label {
            font-size: 12px;
            color: #909399;
            line-height: 1;
        }

        .datetime-input {
            width: 100%;
            height: 32px;
            padding: 0 8px;
            border: 1px solid #DCDFE6;
            border-radius: 4px;
            font-size: 14px;
            color: #606266;
            background-color: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }

        .datetime-input:hover {
            border-color: #C0C4CC;
        }

        .datetime-input:focus {
            border-color: #409EFF;
            outline: none;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        .datetime-input.error {
            border-color: #F56C6C;
        }

        .date-separator {
            color: #909399;
            font-size: 14px;
            line-height: 32px;
            margin: 0 4px;
        }

        /* åœ°å€é€‰æ‹©å™¨ */
        .address-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            width: auto;
            min-width: 360px;
        }

        /* ç­›é€‰æ“ä½œæŒ‰é’® */
        .filter-actions {
            display: flex;
            gap: 8px;
        }

        /* é”™è¯¯æç¤º */
        .error-message {
            color: #F56C6C;
            font-size: 12px;
            line-height: 1;
            margin-top: 4px;
            flex: 1;
        }

        /* æ•°æ®ç»Ÿè®¡åŒºåŸŸ */
        .statistics-section {
            background-color: #F8F9FA;
            border: 1px solid #E5E6EB;
            border-radius: 4px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .statistics-info {
            font-size: 14px;
            color: #606266;
            text-align: center;
        }

        .highlight {
            color: #409EFF;
            font-weight: bold;
        }

        /* ç»“æœå±•ç¤ºåŒºåŸŸ */
        .results-section {
            min-height: 400px;
        }

        /* åŠ è½½çŠ¶æ€æ ·å¼ */
        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 400px;
            position: relative;
        }

        .loading-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            z-index: 1;
        }

        .custom-loading {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #409EFF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 14px;
            color: #606266;
            font-weight: 500;
        }

        /* æŒ‰é’®åŠ è½½çŠ¶æ€ */
        .el-button.is-loading {
            position: relative;
            pointer-events: none;
        }

        .el-button.is-loading::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            margin: -8px 0 0 -8px;
            border: 2px solid #ffffff;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: button-spin 0.8s linear infinite;
        }

        @keyframes button-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* è¡¨æ ¼è¡Œæ‚¬åœæ•ˆæœ */
        .orders-table tbody tr {
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .orders-table tbody tr:hover {
            background-color: #F0F9FF !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        /* è¡¨æ ¼æ’åºå›¾æ ‡åŠ¨ç”» */
        .orders-table th.sortable i {
            transition: all 0.2s ease;
            margin-left: 4px;
            font-size: 12px;
            opacity: 0.6;
        }

        .orders-table th.sortable:hover i {
            opacity: 1;
            transform: scale(1.1);
        }

        /* ç­›é€‰æ¡ä»¶è¾“å…¥æ¡†èšç„¦æ•ˆæœ */
        .datetime-input:focus,
        .el-select .el-input__inner:focus {
            border-color: #409EFF;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.1);
            transition: all 0.2s ease;
        }

        /* æŸ¥è¯¢æŒ‰é’®æ‚¬åœæ•ˆæœ */
        .filter-actions .el-button {
            transition: all 0.2s ease;
        }

        .filter-actions .el-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.3);
        }

        /* æ•°æ®ç»Ÿè®¡åŒºåŸŸåŠ¨ç”» */
        .statistics-section {
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* è¡¨æ ¼å®¹å™¨å…¥åœºåŠ¨ç”» */
        .table-container {
            animation: fadeInUp 0.4s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* è¡¨æ ¼æ ·å¼ */
        .table-container {
            background-color: #fff;
            border: 1px solid #E5E6EB;
            border-radius: 4px;
            overflow: hidden;
        }

        .orders-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .orders-table th {
            background-color: #F5F7FA;
            color: #5E6C84;
            font-weight: 500;
            text-align: left;
            padding: 16px;
            border-bottom: 1px solid #E5E6EB;
            white-space: nowrap;
        }

        .orders-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }

        .orders-table th.sortable:hover {
            background-color: #EBECF0;
        }

        .orders-table td {
            padding: 16px;
            border-bottom: 1px solid #E5E6EB;
            line-height: 1.5;
        }

        .orders-table tr:last-child td {
            border-bottom: none;
        }

        .orders-table .odd-row {
            background-color: #FFFFFF;
        }

        .orders-table .even-row {
            background-color: #F9FAFB;
        }

        /* è¡¨æ ¼å•å…ƒæ ¼æ ·å¼ */
        .order-id {
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .order-id span {
            cursor: pointer;
            color: #409EFF;
            transition: color 0.2s;
        }

        .order-id span:hover {
            color: #096DD9;
            text-decoration: underline;
        }

        .copy-icon {
            margin-left: 4px;
            font-size: 12px;
            opacity: 0.6;
        }

        .customer-info {
            min-width: 120px;
        }

        .customer-name {
            font-weight: 500;
            margin-bottom: 2px;
        }

        .customer-phone {
            font-size: 12px;
            color: #909399;
        }

        .address {
            white-space: nowrap;
        }

        .fee-items {
            max-width: 200px;
            font-size: 13px;
            line-height: 1.4;
        }

        .fee-item {
            margin-bottom: 2px;
        }

        .amount {
            text-align: right;
            font-weight: 500;
            font-family: 'Courier New', monospace;
        }

        .status-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            min-width: 60px;
        }

        .status-tag.success {
            background-color: #F0F9FF;
            color: #1890FF;
            border: 1px solid #B3D8FF;
        }

        .date {
            white-space: nowrap;
            font-size: 13px;
        }

        .actions {
            text-align: center;
        }

        /* ç©ºçŠ¶æ€å’Œåˆå§‹çŠ¶æ€ä¼˜åŒ– */
        .empty-data, .initial-state {
            text-align: center;
            padding: 60px 20px;
            color: #909399;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .empty-data i, .initial-state i {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.8; }
        }

        /* åˆ†é¡µç»„ä»¶æ ·å¼ä¼˜åŒ– */
        .pagination-section .el-pagination {
            padding: 16px;
            background: #F8F9FA;
            border-radius: 4px;
            border: 1px solid #E5E6EB;
        }

        .pagination-section .el-pagination .btn-prev,
        .pagination-section .el-pagination .btn-next {
            transition: all 0.2s ease;
        }

        .pagination-section .el-pagination .btn-prev:hover,
        .pagination-section .el-pagination .btn-next:hover {
            transform: scale(1.05);
        }

        /* å¤åˆ¶æˆåŠŸæç¤º */
        .copy-success-tooltip {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            z-index: 9999;
            animation: tooltipFade 2s ease-out forwards;
        }

        @keyframes tooltipFade {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
        }

        /* é”™è¯¯çŠ¶æ€ä¼˜åŒ– */
        .error-message {
            color: #F56C6C;
            font-size: 12px;
            line-height: 1;
            margin-top: 4px;
            flex: 1;
            animation: shake 0.3s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        /* æ—¥æœŸè¾“å…¥é”™è¯¯çŠ¶æ€ */
        .datetime-input.error {
            border-color: #F56C6C;
            animation: inputError 0.3s ease-in-out;
        }

        @keyframes inputError {
            0%, 100% { box-shadow: none; }
            50% { box-shadow: 0 0 0 2px rgba(245, 108, 108, 0.2); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .order-query-container {
                padding: 16px;
            }

            .filter-section {
                flex-direction: column;
                margin: 0 -16px 16px -16px;
                padding: 16px;
            }

            .filter-item {
                width: 100%;
                min-width: auto;
                flex-direction: column;
                align-items: stretch;
            }

            .filter-label {
                width: auto;
                line-height: 1;
                margin-bottom: 8px;
            }

            .date-range-picker {
                width: 100%;
                flex-direction: column;
            }

            .date-separator {
                display: none;
            }

            .address-selector {
                width: 100%;
                flex-direction: column;
            }

            .address-row {
                flex-direction: column;
                gap: 15px;
            }

            .address-field {
                min-width: auto;
                width: 100%;
            }

            .address-selector .el-select {
                width: 100% !important;
            }

            .filter-actions {
                justify-content: center;
            }

            .table-container {
                overflow-x: auto;
            }

            .orders-table {
                min-width: 800px;
            }
        }

        @media (min-width: 769px) and (max-width: 1199px) {
            .date-range-picker {
                width: 280px;
            }

            .address-selector {
                width: 320px;
            }
        }

        /* æ‰“å°æ ·å¼ä¿®å¤ */
        @media print {
            /* éšè—æ‰€æœ‰å†…å®¹ */
            body * {
                visibility: hidden !important;
            }
            /* åªæ˜¾ç¤ºæ‰“å°åŒºåŸŸ */
            #print-receipt, #print-receipt * {
                visibility: visible !important;
            }
            /* æ‰“å°åŒºåŸŸæ ·å¼ */
            #print-receipt {
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 80mm !important;
                min-height: auto !important;
                max-height: 100vh !important;
                padding: 0 !important;
                margin: 0 !important;
                font-family: 'å®‹ä½“', 'SimSun', sans-serif !important;
                font-size: 12px !important;
                overflow: visible !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                z-index: 9999 !important;
                transform-origin: top left !important;
            }
            
            /* ç¡®ä¿å°ç¥¨å†…å®¹ä¹Ÿæ˜¯80mmå®½åº¦ */
            #print-receipt .receipt-content {
                width: 80mm !important;
                min-width: 80mm !important;
                max-width: 80mm !important;
                margin: 0 !important;
                padding: 2mm !important;
                box-sizing: border-box !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                overflow: visible !important;
            }
            
            /* å¼ºåˆ¶è®¾ç½®é¡µé¢å°ºå¯¸å’Œè¾¹è· */
            @page {
                size: auto !important;
                margin: 0mm !important;
                padding: 0 !important;
                marks: none !important;
                bleed: 0 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                /* å¼ºåˆ¶å†…å®¹é€‚åº”çº¸å¼  */
                overflow: hidden !important;
                /* ç¡®ä¿ä¸ä¼šæ ¹æ®çº¸å¼ å¤§å°è‡ªåŠ¨ç¼©æ”¾ */
                transform-origin: top left !important;
                /* é˜²æ­¢æµè§ˆå™¨è‡ªåŠ¨è°ƒæ•´å†…å®¹å¤§å° */
                zoom: 1 !important;
            }
            
            /* é˜²æ­¢ä»»ä½•å…ƒç´ åˆ†é¡µ */
            #print-receipt,
            #print-receipt *,
            #print-receipt .receipt-content,
            #print-receipt .receipt-content * {
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                orphans: 1 !important;
                widows: 1 !important;
            }
            
            /* ç¡®ä¿HTMLå’ŒBODYä¸ä¼šå½±å“æ‰“å° */
            html, body {
                margin: 0 !important;
                padding: 0 !important;
                visibility: hidden !important;
                background: transparent !important;
                overflow: visible !important;
            }
            
            /* é˜²æ­¢ä»»ä½•æ»šåŠ¨æ¡ */
            html {
                overflow: hidden !important;
            }
            
            /* ç¡®ä¿æ‰“å°å†…å®¹ä¸ä¼šè¢«è£å‰ª */
            #print-receipt {
                overflow: visible !important;
                height: auto !important;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="app-container">
            <!-- ä¾§è¾¹æ  -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">ç‰©ä¸šæ”¶è´¹ç³»ç»Ÿ</div>
                    <div class="user-info">
                        [[ user.real_name ]] <br> <!-- ä½¿ç”¨çœŸå®å§“å -->
                        [[ user.community ]] <!-- æ‰€å±å°åŒº -->
                        <span v-if="user.role" style="display: block; font-size: 11px; color: #aaa; margin-top: 2px;">
                            [[ user.role ]] <!-- æ˜¾ç¤ºç”¨æˆ·è§’è‰² -->
                        </span>
                    </div>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item active" @click="currentPage = 'workbench'">
                        <i class="el-icon-s-home"></i> æ”¶è´¹å·¥ä½œå°
                    </li>
                    <li class="nav-item" @click="currentPage = 'query'">
                        <i class="el-icon-search"></i> è®¢å•æŸ¥è¯¢
                    </li>

                    <!-- åœ¨ä¾§è¾¹æ çš„å¯¼èˆªèœå•ä¸­æ·»åŠ  -->
                    <li class="nav-item" @click="debugPrices" >
                        <i class="el-icon-info"></i> æ”¶è´¹æ ‡å‡†ç®¡ç†
                    </li>

                    <li class="nav-item" @click="logout">
                        <i class="el-icon-switch-button"></i> é€€å‡ºç™»å½•
                    </li>
                </ul>
            </div>
            
            <!-- ä¸»å†…å®¹åŒº -->
            <div class="main-content">
                <div class="content-wrapper">
                    <!-- æ”¶è´¹å·¥ä½œå°é¡µé¢ -->
                    <div v-if="currentPage === 'workbench'">
                        <div class="header">
                            <div class="header-title">æ”¶è´¹å·¥ä½œå°</div>
                        </div>
                    
                    <div class="workbench-container">
                        <!-- åœ°å€é€‰æ‹© -->
                        <div class="address-selector">
                            <div class="section-title">1. é€‰æ‹©åœ°å€</div>
                            
                            <div class="address-row">
                                
                                <!-- æ¥¼æ ‹é€‰æ‹© -->
                                <div class="address-field">
                                    <div class="field-label">æ¥¼æ ‹</div>
                                    <div class="form-control" style="width: 150px;">
                                        <el-select 
                                            v-model="selectedBuilding" 
                                            placeholder="è¯·é€‰æ‹©" 
                                            style="width: 100%;"
                                            @change="onBuildingChange"
                                            popper-append-to-body="true"
                                            clearable>
                                            <el-option
                                                v-for="building in buildings"
                                                :key="building"
                                                :label="building"
                                                :value="building">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </div>
                                
                                <!-- æˆ¿é—´é€‰æ‹© -->
                                <div class="address-field">
                                    <div class="field-label">æˆ¿é—´</div>
                                    <div class="form-control" style="width: 150px;">
                                        <el-select 
                                            v-model="selectedRoomId" 
                                            :placeholder="selectedBuilding ? 'è¯·é€‰æ‹©' : 'å…ˆé€‰æ¥¼æ ‹'" 
                                            style="width: 100%;"
                                            @change="onRoomChange"
                                            :disabled="!selectedBuilding"
                                            popper-append-to-body="true"
                                            clearable>
                                            <el-option
                                                v-for="room in rooms"
                                                :key="room.id"
                                                :label="room.room"
                                                :value="room.id">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </div>
                                
                                <!-- å§“åè¾“å…¥ -->
                                <div class="address-field">
                                    <div class="field-label">å§“å</div>
                                    <div class="form-control" style="width: 160px;">
                                        <el-input 
                                            v-model="residentName" 
                                            placeholder="è¯·è¾“å…¥" 
                                            style="width: 100%;"
                                            :maxlength="10"
                                            show-word-limit>
                                        </el-input>
                                    </div>
                                </div>
                                
                                <!-- æ‰‹æœºå·è¾“å…¥ -->
                                <div class="address-field">
                                    <div class="field-label">æ‰‹æœºå·</div>
                                    <div class="form-control" style="width: 190px;">
                                        <el-input 
                                            v-model="residentPhone" 
                                            placeholder="è¯·è¾“å…¥" 
                                            style="width: 100%;"
                                            :maxlength="11"
                                            @input="validatePhone">
                                        </el-input>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- é”™è¯¯æç¤º -->
                            <div v-if="phoneError" class="phone-error">
                                [[ phoneError ]]
                            </div>
                            
                            <!-- ç”¨æˆ·å†å²ç¼´è´¹è®°å½• - å¯æŠ˜å åŒºå— -->
                            <div class="user-history-section">
                                <div class="history-header" @click="toggleHistory">
                                    <span class="history-title">
                                        <span class="collapse-icon">[[ historyExpanded ? 'â†“' : 'â†’' ]]</span>
                                        æ­¤ç”¨æˆ·å†å²ç¼´è´¹è®°å½•
                                    </span>
                                </div>
                                <el-collapse-transition>
                                    <div v-show="historyExpanded" class="history-content">
                                        <!-- åŠ è½½çŠ¶æ€ -->
                                        <div v-if="historyLoading" class="history-loading">
                                            <i class="el-icon-loading"></i> æ­£åœ¨åŠ è½½å†å²è®°å½•...
                                        </div>
                                        <!-- æ— è®°å½•æç¤º -->
                                        <div v-else-if="userHistoryOrders.length === 0" class="history-empty">
                                            æš‚æ— å†å²ç¼´è´¹è®°å½•
                                        </div>
                                        <!-- å†å²è®°å½•è¡¨æ ¼ -->
                                        <div v-else class="user-history-table-container">
                                            <table class="user-history-table">
                                                <thead>
                                                    <tr>
                                                        <th>æ”¶è´¹æ—¥æœŸ</th>
                                                        <th>æ¥¼æ ‹</th>
                                                        <th>æˆ¿é—´</th>
                                                        <th>æ”¶è´¹é¡¹ç›®</th>
                                                        <th>é‡‘é¢</th>
                                                        <th>æ”¯ä»˜æ–¹å¼</th>
                                                        <th>å¤‡æ³¨</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr v-for="order in userHistoryOrders" :key="order.orderId">
                                                        <td>[[ formatDate(order.entryTime) ]]</td>
                                                        <td>[[ order.building || '-' ]]</td>
                                                        <td>[[ order.room || '-' ]]</td>
                                                        <td class="fee-items-cell">
                                                            <div v-for="(item, index) in order.feeItems.split('\n')" :key="index">
                                                                [[ item ]]
                                                            </div>
                                                        </td>
                                                        <td style="color: #f56c6c; font-weight: bold;">[[ formatPrice(order.totalAmount) ]]</td>
                                                        <td>[[ order.paymentMethod || '-' ]]</td>
                                                        <td>[[ order.remark ]]</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </el-collapse-transition>
                            </div>
                        </div>
                        
                        <!-- è´¹ç”¨é¡¹ç›® -->
                        <div class="fee-section">
                            <div class="section-title">
                                2. æ·»åŠ æ”¶è´¹é¡¹ç›®
                                <div class="refund-checkbox" style="display: inline-block; margin-left: 20px;">
                                    <el-checkbox v-model="isRefundMode" @change="onRefundModeChange"><strong style="font-weight: bold; font-size: 18px;">é€€è´¹</strong></el-checkbox>
                                </div>
                            </div>
                            <div class="fee-buttons">
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('electricity')" 
                                    :disabled="!selectedRoomId || buttonDisabled.electricity"
                                    :title="buttonDisabled.electricity ? 'ç”µè´¹å·²æ·»åŠ æˆ–æœªé€‰æ‹©åœ°å€' : 'æ·»åŠ ç”µè´¹'">
                                    <i class="el-icon-lightning"></i> æ·»åŠ ç”µè´¹
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('coldWater')" 
                                    :disabled="!selectedRoomId || buttonDisabled.coldWater"
                                    :title="buttonDisabled.coldWater ? 'å†·æ°´è´¹å·²æ·»åŠ æˆ–æœªé€‰æ‹©åœ°å€' : 'æ·»åŠ å†·æ°´è´¹'">
                                    <i class="el-icon-water-drop"></i> æ·»åŠ å†·æ°´è´¹
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('hotWater')" 
                                    :disabled="!selectedRoomId || buttonDisabled.hotWater"
                                    :title="buttonDisabled.hotWater ? 'çƒ­æ°´è´¹å·²æ·»åŠ æˆ–æœªé€‰æ‹©åœ°å€' : 'æ·»åŠ çƒ­æ°´è´¹'">
                                    <i class="el-icon-hot-water"></i> æ·»åŠ çƒ­æ°´è´¹
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('network')" 
                                    :disabled="!selectedRoomId || buttonDisabled.network"
                                    :title="buttonDisabled.network ? 'ç½‘è´¹å·²æ·»åŠ æˆ–æœªé€‰æ‹©åœ°å€' : 'æ·»åŠ ç½‘è´¹'">
                                    <i class="el-icon-monitor"></i> æ·»åŠ ç½‘è´¹
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('parking')" 
                                    :disabled="!selectedRoomId || buttonDisabled.parking"
                                    :title="buttonDisabled.parking ? 'åœè½¦è´¹å·²æ·»åŠ æˆ–æœªé€‰æ‹©åœ°å€' : 'æ·»åŠ åœè½¦è´¹'">
                                    <i class="el-icon-truck"></i> æ·»åŠ åœè½¦è´¹
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('rent')" 
                                    :disabled="!selectedRoomId || buttonDisabled.rent"
                                    :title="buttonDisabled.rent ? 'æˆ¿ç§Ÿå·²æ·»åŠ æˆ–æœªé€‰æ‹©åœ°å€' : 'æ·»åŠ æˆ¿ç§Ÿ'">
                                    <i class="el-icon-home"></i> æ·»åŠ æˆ¿ç§Ÿ
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('management')" 
                                    :disabled="!selectedRoomId || buttonDisabled.management"
                                    :title="buttonDisabled.management ? 'ç®¡ç†è´¹å·²æ·»åŠ æˆ–æœªé€‰æ‹©åœ°å€' : 'æ·»åŠ ç®¡ç†è´¹'">
                                    <i class="el-icon-office-building"></i> æ·»åŠ ç®¡ç†è´¹
                                </el-button>
                            </div>
                            
                            <!-- è´¹ç”¨è¡¨æ ¼ -->
                            <table class="fee-table" v-if="feeItems.length > 0">
                                <thead>
                                    <tr>
                                        <th>é¡¹ç›®åç§°</th>
                                        <th>å•ä½</th>
                                        <th>æ•°é‡</th>
                                        <th>å•ä»·ï¼ˆå…ƒï¼‰</th>
                                        <th>é‡‘é¢ï¼ˆå…ƒï¼‰</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(item, index) in feeItems" :key="index" :class="{ 'parking-detail-row': item.type === 'parking' }">
                                        <td>[[ getFeeTypeName(item.type) ]]</td>
                                        <td>[[ getFeeUnit(item.type) ]]</td>
                                        <td>
                                            <el-input-number
                                                v-model="item.quantity"
                                                :min="0"
                                                :step="item.type === 'network' || item.type === 'parking' || item.type === 'rent' || item.type === 'management' ? 1 : 0.1"
                                                @change="(value) => handleQuantityChange(index, value)"
                                                size="small"
                                                style="width: 100%; max-width: 120px;">
                                            </el-input-number>
                                        </td>
                                        <td>
                                            <el-input 
                                                :value="formatPrice(item.unitPrice)" 
                                                readonly 
                                                size="small"
                                                style="width: 100%; max-width: 120px; text-align: center;">
                                                <template #append>å…ƒ</template>
                                            </el-input>
                                        </td>
                                        <td>
                                            <el-input 
                                                v-model="item.amount" 
                                                @input="updateItemQuantityFromAmount(index)"
                                                size="small" 
                                                style="width: 100%; max-width: 120px;">
                                                <template #append>å…ƒ</template>
                                            </el-input>
                                        </td>
                                        <td>
                                            <div class="fee-item-actions">
                                                <el-button 
                                                    type="danger" 
                                                    size="small" 
                                                    @click="removeFeeItem(index)" 
                                                    circle
                                                    title="åˆ é™¤æ­¤é¡¹">
                                                    <i class="el-icon-delete"></i>
                                                </el-button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- åœè½¦è´¹è¯¦æƒ…è¡Œï¼ˆå¦‚æœæ˜¯åœè½¦è´¹ï¼Œæ˜¾ç¤ºé¢å¤–ä¿¡æ¯ï¼‰ -->
                            <div v-if="feeItems.some(item => item.type === 'parking')" class="parking-detail-cell" style="margin-top: 10px; padding: 15px; background-color: #f9f9f9; border-radius: 6px; border: 1px solid #e8e8e8;">
                                <div style="margin-bottom: 10px; font-size: 14px; font-weight: 500; color: #333;">
                                    <i class="el-icon-truck"></i> åœè½¦è´¹è¯¦ç»†ä¿¡æ¯
                                </div>
                                <div class="parking-fields">
                                    <div class="parking-field">
                                        <span class="parking-label">è½¦ç‰Œå·ï¼š</span>
                                        <input 
                                            type="text" 
                                            :value="getParkingItem() ? getParkingItem().carPlate : ''" 
                                            placeholder="è¯·è¾“å…¥è½¦ç‰Œå·" 
                                            style="width: 150px; height: 32px; padding: 0 8px; border: 1px solid #dcdfe6; border-radius: 4px; background-color: #ffffff;"
                                            @input="(event) => { 
                                                console.log('è½¦ç‰Œå·è¾“å…¥:', event.target.value); 
                                                const parkingItem = getParkingItem();
                                                if (parkingItem) {
                                                    parkingItem.carPlate = event.target.value;
                                                    console.log('æ›´æ–°è½¦ç‰Œå·:', parkingItem.carPlate);
                                                }
                                            }">
                                        </input>
                                    </div>
                                    
                                    <div class="parking-field">
                                        <span class="parking-label">å¼€å§‹æ—¥æœŸï¼š</span>
                                        <input 
                                            type="text" 
                                            id="parkingStartDatePicker" 
                                            class="parking-date-input"
                                            :value="getParkingItem() ? getParkingItem().startDate : ''"
                                            placeholder="è¯·é€‰æ‹©å¼€å§‹æ—¥æœŸ"
                                            @input="(event) => { 
                                                console.log('å¼€å§‹æ—¥æœŸè¾“å…¥:', event.target.value); 
                                                const parkingItem = getParkingItem();
                                                if (parkingItem) {
                                                    parkingItem.startDate = event.target.value;
                                                    console.log('æ›´æ–°å¼€å§‹æ—¥æœŸ:', parkingItem.startDate);
                                                }
                                            }">
                                    </div>
                                    
                                    <div class="parking-field">
                                        <span class="parking-label">ç»“æŸæ—¥æœŸï¼š</span>
                                        <input 
                                            type="text" 
                                            id="parkingEndDatePicker" 
                                            class="parking-date-input"
                                            :value="getParkingItem() ? getParkingItem().endDate : ''"
                                            placeholder="è¯·é€‰æ‹©ç»“æŸæ—¥æœŸ"
                                            @input="(event) => { 
                                                console.log('ç»“æŸæ—¥æœŸè¾“å…¥:', event.target.value); 
                                                const parkingItem = getParkingItem();
                                                if (parkingItem) {
                                                    parkingItem.endDate = event.target.value;
                                                    console.log('æ›´æ–°ç»“æŸæ—¥æœŸ:', parkingItem.endDate);
                                                }
                                            }">
                                    </div>
                            </div>

                            <!-- æ“ä½œæç¤º -->
                            <div v-if="feeItems.length > 0" style="margin-top: 10px; color: #999; font-size: 12px;">
                                <i class="el-icon-info"></i> 
                                æç¤ºï¼šå•ä»·ç”±ç³»ç»Ÿæ ¹æ®å°åŒºè‡ªåŠ¨åŠ è½½ï¼Œå¯åœ¨é‡‘é¢æ ç›´æ¥è¾“å…¥å®ç¼´é‡‘é¢ï¼Œç³»ç»Ÿè‡ªåŠ¨è®¡ç®—æ•°é‡
                            </div>
                            
                            <div v-else class="empty-table">
                                <i class="el-icon-document" style="font-size: 48px; color: #ccc; margin-bottom: 10px;"></i>
                                <p>æš‚æ— æ”¶è´¹é¡¹ç›®ï¼Œè¯·ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ </p>
                            </div>
                        </div>
                        
                        <!-- æ±‡æ€»ä¿¡æ¯ -->
                        <div class="summary-section">
                            <div class="section-title">3. æ±‡æ€»ä¿¡æ¯</div>
                            
                            <!-- æ”¶æ¬¾æ–¹å¼ - å¯å‹¾é€‰çš„å›¾æ ‡æŒ‰é’® -->
                            <div class="summary-row" style="margin-bottom: 20px;">
                                <span style="font-weight: 500; color: #606266; margin-right: 15px; min-width: 70px;">æ”¶æ¬¾æ–¹å¼ï¼š</span>
                                <div class="payment-options" style="display: flex; gap: 15px; align-items: center;">
                                    <!-- å¾®ä¿¡æ”¯ä»˜ -->
                                    <div class="payment-option" 
                                         :class="{ 'selected': paymentMethod === 'å¾®ä¿¡' }" 
                                         @click="selectPaymentMethod('å¾®ä¿¡')"
                                         style="cursor: pointer;">
                                        <div class="payment-icon wechat-icon">
                                            <i class="fab fa-weixin"></i>
                                        </div>
                                        <div class="payment-text">å¾®ä¿¡</div>
                                        <div class="payment-check" v-if="paymentMethod === 'å¾®ä¿¡'">
                                            <i class="el-icon-check"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- æ”¯ä»˜å® -->
                                    <div class="payment-option" 
                                         :class="{ 'selected': paymentMethod === 'æ”¯ä»˜å®' }" 
                                         @click="selectPaymentMethod('æ”¯ä»˜å®')"
                                         style="cursor: pointer;">
                                        <div class="payment-icon alipay-icon">
                                            <i class="fab fa-alipay"></i>
                                        </div>
                                        <div class="payment-text">æ”¯ä»˜å®</div>
                                        <div class="payment-check" v-if="paymentMethod === 'æ”¯ä»˜å®'">
                                            <i class="el-icon-check"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- ç°é‡‘ -->
                                    <div class="payment-option" 
                                         :class="{ 'selected': paymentMethod === 'ç°é‡‘' }" 
                                         @click="selectPaymentMethod('ç°é‡‘')"
                                         style="cursor: pointer;">
                                        <div class="payment-icon cash-icon">
                                            <i class="fas fa-money-bill-wave"></i>
                                        </div>
                                        <div class="payment-text">ç°é‡‘</div>
                                        <div class="payment-check" v-if="paymentMethod === 'ç°é‡‘'">
                                            <i class="el-icon-check"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- å¤‡æ³¨ - é å·¦æ’åˆ— -->
                            <div class="summary-row" style="display: flex; align-items: flex-start;">
                                <span style="font-weight: 500; color: #606266; margin-right: 15px; min-width: 70px; padding-top: 8px;">å¤‡æ³¨ï¼š</span>
                                <el-input 
                                    v-model="remark" 
                                    type="textarea" 
                                    placeholder="å¯å¡«å†™å¤‡æ³¨ä¿¡æ¯" 
                                    :rows="3"
                                    maxlength="200"
                                    show-word-limit
                                    style="flex: 1; max-width: 500px; text-align: left;">
                                </el-input>
                            </div>
                            
                            <!-- æ€»è®¡é‡‘é¢ - é å·¦ -->
                            <div class="total-amount" style="text-align: left; margin-top: 20px;">
                                æ€»è®¡é‡‘é¢ï¼š<span style="color: #f56c6c; font-size: 28px;">[[ totalAmount.toFixed(2) ]]</span> å…ƒ
                            </div>
                        </div>
                        
                        <!-- æ“ä½œæŒ‰é’® -->
                        <div class="action-buttons">
                            <el-button type="primary" size="large" @click="generateBill" :disabled="!canGenerate" :loading="generating">
                                <i class="el-icon-printer"></i> æ”¶è´¹å¹¶æ‰“å°
                            </el-button>
                            <el-button type="info" size="large" @click="clearForm">
                                æ¸…ç©ºé‡å¡«
                            </el-button>
                        </div>
                    </div>

                    <!-- ä»Šæ—¥æ”¶è´¹è®°å½•åŒºå— -->
                    <div class="recent-records-section">
                        <div class="section-title">ä»Šæ—¥æ”¶è´¹è®°å½•[[ todayUserOrders.length > 0 ? todayUserOrders.length + 'ç¬”' : '' ]]</div>
                        
                        <!-- ä»Šæ—¥æ”¶è´¹é‡‘é¢åˆè®¡ -->
                        <div class="today-total">
                            ä»Šæ—¥æ”¶è´¹é‡‘é¢åˆè®¡ï¼š<span class="amount">[[ formatPrice(todayTotalAmount) ]]</span> å…ƒ
                        </div>
                        
                        <!-- ä»Šæ—¥æ”¶è´¹è®°å½•è¡¨æ ¼å®¹å™¨ -->
                        <div class="recent-records-table-container">
                            <table class="recent-records-table" v-if="todayUserOrders.length > 0">
                                <thead>
                                    <tr>
                                        <th>æ”¶è´¹æ—¥æœŸ</th>
                                        <th>æ¥¼æ ‹</th>
                                        <th>æˆ¿å·</th>
                                        <th>å§“å</th>
                                        <th>ç”µè¯</th>
                                        <th>æ”¶è´¹é¡¹ç›®</th>
                                        <th>æ”¶è´¹é‡‘é¢</th>
                                        <th>å¤‡æ³¨</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="order in todayUserOrders" :key="order.orderId">
                                        <td>[[ formatDate(order.entryTime) ]]</td>
                                        <td>[[ order.building || '-' ]]</td>
                                        <td>[[ order.room || '-' ]]</td>
                                        <td>[[ order.residentName || '-' ]]</td>
                                        <td>[[ order.residentPhone || '-' ]]</td>
                                        <td class="fee-items-cell">
                                            <div v-for="(item, index) in order.feeItems.split('\n')" :key="index">
                                                [[ item ]]
                                            </div>
                                        </td>
                                        <td style="color: #f56c6c; font-weight: bold;">[[ formatPrice(order.totalAmount) ]]</td>
                                        <td>[[ order.remark ]]</td>
                                        <td>
                                            <div class="action-buttons-cell">
                                                <el-button 
                                                    type="primary" 
                                                    size="small" 
                                                    @click="reprintReceipt(order.orderId)"
                                                    class="reprint-button">
                                                    é‡æ‰“å°ç¥¨
                                                </el-button>
                                                <el-button 
                                                    type="danger" 
                                                    size="small" 
                                                    @click="handleRedReverse(order)"
                                                    class="red-reverse-button"
                                                    :disabled="order.redReverse === 1">
                                                    çº¢å†²
                                                </el-button>
                                                <el-button 
                                                    type="danger" 
                                                    size="small" 
                                                    @click="deleteOrder(order.orderId)"
                                                    class="delete-button"
                                                    v-if="canDeleteOrder">
                                                    åˆ é™¤
                                                </el-button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div v-else class="empty-table">
                            <i class="el-icon-document" style="font-size: 48px; color: #ccc; margin-bottom: 10px;"></i>
                            <p>æš‚æ— æ”¶è´¹è®°å½•</p>
                        </div>
                    </div>
                </div>
                

            </div>
        </div>

        <!-- éšè—çš„æ‰“å°åŒºåŸŸ -->
        <div id="print-receipt" style="display: none;">
            <div class="receipt-content">
                <div class="receipt-header">
                    <h2>ç‰©ä¸šæ”¶è´¹å‡­è¯</h2>
                    <div>[[ receiptData.community || user.community || 'ç‰©ä¸šå…¬å¸' ]]</div>
                </div>
                
                <div class="receipt-info">
                    <div><span class="label">æ”¶è´¹æ—¶é—´ï¼š</span>[[ receiptData.time ]]</div>
                    <div><span class="label">åœ°å€ï¼š</span>[[ receiptData.building ]]-[[ receiptData.room ]]</div>
                    <div><span class="label">å§“åï¼š</span>[[ receiptData.residentName ]]</div>
                    <div><span class="label">æ”¶æ¬¾æ–¹å¼ï¼š</span>[[ receiptData.paymentMethod ]]</div>
                </div>
                
                <div class="receipt-items">
                    <div style="font-weight: bold; margin-bottom: 5px;">æ”¶è´¹é¡¹ç›®ï¼š</div>
                    <div v-html="receiptData.feeItemsHtml"></div>
                </div>
                
                <div class="receipt-total">
                    æ€»è®¡é‡‘é¢ï¼š[[ receiptData.totalAmount ]] å…ƒ
                </div>
                
                <div class="receipt-footer">
                    <div>è´¦å•å·ï¼š[[ receiptData.billNumber ]]</div>
                    <div>æ“ä½œå‘˜ï¼š[[ user.real_name ]]</div>
                    <div>æ‰“å°æ—¶é—´ï¼š[[ receiptData.printTime ]]</div>
                    <div style="margin-top: 10px;">------------------- è°¢è°¢å…‰ä¸´ -------------------</div>
                </div>
            </div>
        </div>
    </div>
<script>
const { createApp, ref, computed, onMounted, watch, nextTick } = Vue;
const { ElSelect, ElOption, ElButton, ElInput, ElInputNumber, ElMessage, ElMessageBox, ElDatePicker, ElLoading } = ElementPlus;

// åˆ›å»ºVueåº”ç”¨å®ä¾‹ï¼Œå¹¶è®¾ç½®è‡ªå®šä¹‰åˆ†éš”ç¬¦
const app = createApp({
    compilerOptions: {
        delimiters: ['[[', ']]']
    },
    setup() {
        // ç”¨æˆ·ä¿¡æ¯
        const user = ref(JSON.parse(sessionStorage.getItem('user')) || {});
        const currentPage = ref('workbench');
        
        // å·¥ä½œå°æ•°æ®
        const buildings = ref([]);  // æ¥¼æ ‹åˆ—è¡¨
        const rooms = ref([]);      // æˆ¿é—´åˆ—è¡¨
        const selectedBuilding = ref('');
        const selectedRoomId = ref('');
        const feeItems = ref([]);
        const paymentMethod = ref('');
        const remark = ref('');
        const generating = ref(false);
        
        // é€€è´¹æ¨¡å¼
        const isRefundMode = ref(false);

        // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´ä¸ºæ—¥æœŸé€‰æ‹©å™¨æ ¼å¼
        const formatDateTimeForPicker = (date) => {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${year}-${month}-${day} ${hours}:${minutes}`;
        };

        // æ–°å¢ï¼šä½æˆ·ä¿¡æ¯
        const residentName = ref('');
        const residentPhone = ref('');
        const phoneError = ref('');
        
        // ç”¨æˆ·å†å²ç¼´è´¹è®°å½•ç›¸å…³
        const historyExpanded = ref(false);
        const historyLoading = ref(false);
        const userHistoryOrders = ref([]);

        // å½“å‰å°åŒºçš„æ”¶è´¹æ ‡å‡†
        const communityPrices = ref({
            electricity: 0.00,
            coldWater: 0.00, 
            hotWater: 0.00,
            network: 0.00,
            parking: 0.00,
            rent: 0.00,
            management: 0.00
        });

        // è´¹ç”¨ç±»å‹é…ç½®
        const feeConfig = {
            electricity: { 
                name: 'ç”µè´¹', 
                unit: 'åº¦', 
                hasCarPlate: false 
            },
            coldWater: { 
                name: 'å†·æ°´è´¹', 
                unit: 'å¨', 
                hasCarPlate: false 
            },
            hotWater: { 
                name: 'çƒ­æ°´è´¹', 
                unit: 'å¨', 
                hasCarPlate: false 
            },
            network: { 
                name: 'ç½‘è´¹', 
                unit: 'æœˆ', 
                hasCarPlate: false 
            },
            parking: { 
                name: 'åœè½¦è´¹', 
                unit: 'æœˆ', 
                hasCarPlate: true 
            },
            rent: { 
                name: 'æˆ¿ç§Ÿ', 
                unit: 'æœˆ', 
                hasCarPlate: false 
            },
            management: { 
                name: 'ç®¡ç†è´¹', 
                unit: 'æœˆ', 
                hasCarPlate: false 
            }
        };
        
        // å·²æ·»åŠ çš„è´¹ç”¨ç±»å‹é›†åˆ
        const addedFeeTypes = ref(new Set());
        
        // ä»Šæ—¥æ”¶è´¹è®°å½•
        const recentOrders = ref([]);
        // è®¡ç®—å½“å‰æ“ä½œå‘˜çš„ä»Šæ—¥æ”¶è´¹åˆè®¡é‡‘é¢
        const todayTotalAmount = computed(() => {
            // ä½¿ç”¨å·²ç­›é€‰çš„ä»Šæ—¥ç”¨æˆ·è®¢å•
            const todayOrders = todayUserOrders.value;
            if (!todayOrders || !todayOrders.length) return 0;
            
            let totalAmount = 0;
            
            todayOrders.forEach(order => {
                // ç´¯åŠ æ”¶æ¬¾é‡‘é¢
                totalAmount += parseFloat(order.totalAmount) || 0;
            });
            
            return totalAmount;
        });
        
        // æ‰“å°å‡­æ®æ•°æ®
        const receiptData = ref({
            time: '',
            building: '',
            room: '',
            residentName: '',
            residentPhone: '',
            paymentMethod: '',
            feeItems: '',
            totalAmount: '',
            billNumber: '',
            printTime: '',
            community: ''
        });
        
        // æ£€æŸ¥è´¹ç”¨ç±»å‹æ˜¯å¦å·²æ·»åŠ 
        const isFeeTypeAdded = (type) => {
            return addedFeeTypes.value.has(type);
        };
        
        // è·å–è´¹ç”¨ç±»å‹åç§°
        const getFeeTypeName = (type) => {
            return feeConfig[type]?.name || type;
        };
        
        // è·å–è´¹ç”¨å•ä½
        const getFeeUnit = (type) => {
            return feeConfig[type]?.unit || '';
        };
        
        // è®¡ç®—æ€»é‡‘é¢
        const totalAmount = computed(() => {
            return feeItems.value.reduce((sum, item) => {
                return sum + (parseFloat(item.amount) || 0);
            }, 0);
        });
        
        // æ˜¯å¦å¯ä»¥ç”Ÿæˆè´¦å•
        const canGenerate = computed(() => {
            // é€€è´¹æ¨¡å¼ä¸‹ï¼šé‡‘é¢å¿…é¡»ä¸ºè´Ÿæ•°æ‰å…è®¸æäº¤
            if (isRefundMode.value) {
                return selectedRoomId.value && 
                       feeItems.value.length > 0 && 
                       paymentMethod.value && 
                       totalAmount.value < 0 &&  // é€€è´¹æ¨¡å¼è¦æ±‚é‡‘é¢ä¸ºè´Ÿæ•°
                       !phoneError.value;
            }
            // æ­£å¸¸æ”¶è´¹æ¨¡å¼ä¸‹ï¼šé‡‘é¢å¿…é¡»ä¸ºæ­£æ•°æ‰å…è®¸æäº¤
            return selectedRoomId.value && 
                   feeItems.value.length > 0 && 
                   paymentMethod.value && 
                   totalAmount.value > 0 &&
                   !phoneError.value;
        });
        
        // æŒ‰é’®ç¦ç”¨çŠ¶æ€
        const buttonDisabled = computed(() => {
            return {
                electricity: isFeeTypeAdded('electricity'),
                coldWater: isFeeTypeAdded('coldWater'),
                hotWater: isFeeTypeAdded('hotWater'),
                network: isFeeTypeAdded('network'),
                parking: isFeeTypeAdded('parking'),
                rent: isFeeTypeAdded('rent'),
                management: isFeeTypeAdded('management')
            };
        });
        
        // åˆ é™¤æƒé™åˆ¤æ–­ï¼šç³»ç»Ÿç®¡ç†å‘˜æˆ–å°åŒºç»ç†å¯ä»¥åˆ é™¤
        const canDeleteOrder = computed(() => {
            const userRole = user.value.role || '';
            return userRole === 'ç³»ç»Ÿç®¡ç†å‘˜' || userRole === 'å°åŒºç»ç†';
        });
        
        // ç­›é€‰å½“å‰æ“ä½œå‘˜çš„ä»Šæ—¥è®¢å•
        const todayUserOrders = computed(() => {
            if (!recentOrders.value || !recentOrders.value.length) return [];
            
            // ä½¿ç”¨æœ¬åœ°æ—¶é—´è·å–ä»Šæ—¥æ—¥æœŸ YYYY-MM-DD
            const now = new Date();
            const today = now.toLocaleDateString('zh-CN', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit' 
            }).replace(/\//g, '-');
            
            // APIå·²æŒ‰å°åŒºIDç­›é€‰ï¼Œå‰ç«¯åªéœ€æŒ‰æ—¥æœŸç­›é€‰
            
            return recentOrders.value.filter(order => {
                // æ£€æŸ¥æ˜¯å¦æ˜¯ä»Šæ—¥çš„è®¢å•ï¼ˆå·²ç”±APIæŒ‰å°åŒºIDç­›é€‰ï¼‰
                const orderDateObj = new Date(order.entryTime);
                const orderDate = orderDateObj.toLocaleDateString('zh-CN', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit' 
                }).replace(/\//g, '-');
                
                return orderDate === today; // åªæŒ‰æ—¥æœŸç­›é€‰ï¼Œä¸ç­›é€‰æ“ä½œå‘˜ID
            });
        });
        
        // éªŒè¯æ‰‹æœºå·
        const validatePhone = () => {
            const phone = residentPhone.value;
            if (phone && !/^1[3-9]\d{9}$/.test(phone)) {
                phoneError.value = 'æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®ï¼ˆ11ä½æ•°å­—ï¼Œ1å¼€å¤´ï¼‰';
            } else {
                phoneError.value = '';
            }
        };
        
        // æ¥¼æ ‹æ”¹å˜äº‹ä»¶
        const onBuildingChange = async (building) => {
            selectedBuilding.value = building;
            selectedRoomId.value = '';
            rooms.value = [];
            residentName.value = '';
            residentPhone.value = '';
            phoneError.value = '';
            
            if (building) {
                await loadRooms(building);
            }
        };
        
        // åŠ è½½æˆ¿é—´åˆ—è¡¨
        const loadRooms = async (building) => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch(`/api/addresses?step=rooms&building=${encodeURIComponent(building)}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    rooms.value = result.data;
                } else {
                    ElMessage.error('åŠ è½½æˆ¿é—´åˆ—è¡¨å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½æˆ¿é—´åˆ—è¡¨å¤±è´¥:', error);
                ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
            }
        };
        
        // æˆ¿é—´æ”¹å˜äº‹ä»¶
        const onRoomChange = async (roomId) => {
            selectedRoomId.value = roomId;
            
            // æŸ¥æ‰¾é€‰ä¸­çš„æˆ¿é—´ä¿¡æ¯
            const room = rooms.value.find(r => r.id === roomId);
            if (room) {
                // è‡ªåŠ¨å¡«å……ä½æˆ·ä¿¡æ¯
                residentName.value = room.name || '';
                residentPhone.value = room.phone || '';
                validatePhone();
                
                // è‡ªåŠ¨å±•å¼€å†å²ç¼´è´¹è®°å½•
                historyExpanded.value = true;
                await loadUserPaymentHistory();
            }
        };

        // æ ¼å¼åŒ–ä»·æ ¼æ˜¾ç¤º
        const formatPrice = (price) => {
            const num = parseFloat(price);
            if (isNaN(num)) return '0.00';
            return num.toFixed(2);
        };

        // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º
        const formatDate = (dateString) => {
            if (!dateString) return '';
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${year}/${month}/${day} ${hours}:${minutes}`;
        };
        
        // åˆ‡æ¢å†å²è®°å½•å±•å¼€/æŠ˜å çŠ¶æ€
        const toggleHistory = async () => {
            historyExpanded.value = !historyExpanded.value;
            
            // å¦‚æœæ˜¯å±•å¼€çŠ¶æ€ä¸”è¿˜æ²¡æœ‰åŠ è½½è¿‡å†å²è®°å½•ï¼Œåˆ™åŠ è½½å†å²è®°å½•
            if (historyExpanded.value && userHistoryOrders.value.length === 0 && selectedRoomId.value) {
                await loadUserPaymentHistory();
            }
        };
        
        // åŠ è½½ç”¨æˆ·å†å²ç¼´è´¹è®°å½•
        const loadUserPaymentHistory = async () => {
            if (!selectedRoomId.value) {
                return;
            }
            
            // æ ¹æ®é€‰ä¸­çš„æˆ¿é—´è·å–åœ°å€ID
            const room = rooms.value.find(r => r.id === selectedRoomId.value);
            if (!room || !room.id) {
                return;
            }
            
            historyLoading.value = true;
            
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch(`/api/user-payment-history?address_id=${room.id}&limit=10`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    userHistoryOrders.value = result.data.orders;
                } else {
                    ElMessage.error('åŠ è½½å†å²è®°å½•å¤±è´¥');
                    userHistoryOrders.value = [];
                }
            } catch (error) {
                console.error('åŠ è½½å†å²è®°å½•å¤±è´¥:', error);
                ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
                userHistoryOrders.value = [];
            } finally {
                historyLoading.value = false;
            }
        };
        
        // ç›‘å¬æˆ¿é—´é€‰æ‹©å˜åŒ–ï¼Œå½“æˆ¿é—´å˜åŒ–æ—¶é‡ç½®æ›´æ–°å†å²è®°å½•çŠ¶æ€
        watch(selectedRoomId, (newRoomId) => {
            if (newRoomId) {
                // æˆ¿é—´é€‰æ‹©å˜åŒ–æ—¶ï¼Œé‡ç½®å†å²è®°å½•çŠ¶æ€
                userHistoryOrders.value = [];
                // æ³¨æ„ï¼šè¿™é‡Œä¸å†è‡ªåŠ¨è®¾ç½® historyExpanded.value = false;
                // å› ä¸º onRoomChange å‡½æ•°ä¼šè‡ªåŠ¨å±•å¼€å†å²è®°å½•
            }
        });

        // è·å–å½“å‰å°åŒºçš„æ”¶è´¹æ ‡å‡†
        const loadFeePrices = async () => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/fee_prices', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                console.log('è·å–æ”¶è´¹æ ‡å‡†ç»“æœ:', result); // è°ƒè¯•ç”¨
                
                if (result.status === 'success') {
                    // æ›´æ–°ç¤¾åŒºå•ä»·
                    communityPrices.value = result.data;
                    
                    console.log('æ›´æ–°åçš„è´¹ç”¨é…ç½®:', feeConfig);
                    ElMessage.success('æ”¶è´¹æ ‡å‡†å·²åŠ è½½');
                } else {
                    console.warn('è·å–æ”¶è´¹æ ‡å‡†å¤±è´¥:', result.message);
                    ElMessage.warning('ä½¿ç”¨é»˜è®¤æ”¶è´¹æ ‡å‡†');
                }
            } catch (error) {
                console.error('è·å–æ”¶è´¹æ ‡å‡†å¤±è´¥:', error);
                ElMessage.error('è·å–æ”¶è´¹æ ‡å‡†å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
            }
        };

        // è®¡ç®—ç»“æŸæ—¥æœŸ - ç²¾ç¡®è®¡ç®—ï¼šå¼€å§‹æ—¥æœŸ-1å¤© + æœˆæ•°
        const calculateEndDate = (startDate, months) => {
            if (!startDate || !months) return '';
            
            // æ”¯æŒyyyy/MM/ddå’Œyyyy-MM-ddæ ¼å¼ï¼Œç»Ÿä¸€è½¬æ¢ä¸ºyyyy/MM/dd
            const normalizedStartDate = startDate.replace(/-/g, '/');
            const start = new Date(normalizedStartDate);
            
            // æ£€æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ
            if (isNaN(start.getTime())) {
                console.error('æ— æ•ˆçš„å¼€å§‹æ—¥æœŸ:', startDate);
                return '';
            }
            
            const monthCount = parseInt(months) || 1;
            
            // ç¬¬ä¸€æ­¥ï¼šå¼€å§‹æ—¥æœŸå‡å»1å¤©
            const endDate = new Date(start);
            endDate.setDate(endDate.getDate() - 1);
            
            // ç¬¬äºŒæ­¥ï¼šåŠ ä¸Šæœˆæ•°ï¼Œå¤„ç†æœˆä»½è¾¹ç•Œ
            const targetMonth = endDate.getMonth() + monthCount;
            const targetYear = endDate.getFullYear() + Math.floor(targetMonth / 12);
            const finalMonth = targetMonth % 12;
            
            endDate.setFullYear(targetYear);
            endDate.setMonth(finalMonth);
            
            // å¤„ç†æ—¥æœŸè¾¹ç•Œï¼šå¦‚æœç›®æ ‡æ—¥æœŸä¸å­˜åœ¨ï¼ˆå¦‚2æœˆ30æ—¥ï¼‰ï¼Œåˆ™è°ƒæ•´ä¸ºè¯¥æœˆæœ€åä¸€å¤©
            const daysInMonth = new Date(targetYear, finalMonth + 1, 0).getDate();
            if (endDate.getDate() > daysInMonth) {
                endDate.setDate(daysInMonth);
            }
            
            // æ ¼å¼åŒ–ä¸º yyyy/MM/dd
            const year = endDate.getFullYear();
            const month = String(endDate.getMonth() + 1).padStart(2, '0');
            const day = String(endDate.getDate()).padStart(2, '0');
            
            return `${year}/${month}/${day}`;
        };

        // è·å–åœè½¦è´¹é¡¹ç›®
        const getParkingItem = () => {
            return feeItems.value.find(item => item.type === 'parking') || null;
        };

        // å¤„ç†è½¦ç‰Œå·è¾“å…¥
        const handleCarPlateInput = (value) => {
            console.log('è½¦ç‰Œå·è¾“å…¥äº‹ä»¶è§¦å‘:', value);
            const parkingItem = getParkingItem();
            console.log('åœè½¦è´¹é¡¹ç›®:', parkingItem);
            if (parkingItem) {
                parkingItem.carPlate = value;
                console.log('æ›´æ–°åçš„è½¦ç‰Œå·:', parkingItem.carPlate);
            } else {
                console.log('æœªæ‰¾åˆ°åœè½¦è´¹é¡¹ç›®');
            }
        };

        // ä¿å­˜åœè½¦è´¹è¯¦æƒ…
        const saveParkingDetails = () => {
            // è‡ªåŠ¨ä¿å­˜åˆ° feeItems ä¸­
            const parkingItem = getParkingItem();
            if (parkingItem) {
                // æ›´æ–°ç»“æŸæ—¥æœŸ
                if (parkingItem.startDate && parkingItem.quantity) {
                    parkingItem.endDate = calculateEndDate(parkingItem.startDate, parkingItem.quantity);
                }
            }
        };

        // å¤„ç†åœè½¦è´¹å¼€å§‹æ—¥æœŸå˜åŒ–
        const handleParkingStartDateChange = (startDate) => {
            const parkingItem = getParkingItem();
            if (parkingItem) {
                // ç¡®ä¿å­˜å‚¨çš„æ—¥æœŸæ ¼å¼ä¸º yyyy/MM/dd
                parkingItem.startDate = startDate.replace(/-/g, '/');
                // å¦‚æœæœ‰æ•°é‡ï¼Œè‡ªåŠ¨è®¡ç®—ç»“æŸæ—¥æœŸ
                if (parkingItem.quantity) {
                    parkingItem.endDate = calculateEndDate(startDate, parkingItem.quantity);
                }
            }
        };

        // æ›´æ–°åœè½¦è´¹ç»“æŸæ—¥æœŸ
        const updateParkingEndDate = () => {
            const parkingItem = getParkingItem();
            if (parkingItem && parkingItem.startDate && parkingItem.quantity) {
                parkingItem.endDate = calculateEndDate(parkingItem.startDate, parkingItem.quantity);
            }
        };
        
        // æ·»åŠ è´¹ç”¨é¡¹ç›®
        const addFeeItem = (type) => {
            // æ£€æŸ¥æ˜¯å¦å·²æ·»åŠ 
            if (addedFeeTypes.value.has(type)) {
                ElMessage.warning(`${getFeeTypeName(type)}å·²æ·»åŠ ï¼Œä¸èƒ½é‡å¤æ·»åŠ `);
                return;
            }
            
            const config = feeConfig[type];
            if (!config) return;
            
            // è·å–å½“å‰å•ä»·
            const unitPrice = communityPrices.value[type] || 0.00;
            
            // é€€è´¹æ¨¡å¼ï¼šé‡‘é¢å§‹ç»ˆä¸ºè´Ÿæ•°
            const baseAmount = unitPrice * 1;  // é»˜è®¤æ•°é‡ä¸º1
            const finalAmount = isRefundMode.value ? -Math.abs(baseAmount) : Math.abs(baseAmount);
            
            // è·å–ä»Šæ—¥æ—¥æœŸ - æ ¼å¼åŒ–ä¸º yyyy/MM/dd
            const today = new Date().toLocaleDateString('zh-CN', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit' 
            }).replace(/\//g, '/');
            
            // åˆ›å»ºè´¹ç”¨é¡¹
            const newItem = {
                type: type,
                quantity: 1,
                unitPrice: unitPrice,
                amount: finalAmount,  // é€€è´¹æ¨¡å¼ä¸‹ä¸ºè´Ÿæ•°
                carPlate: '',
                startDate: type === 'parking' ? today : '',  // åœè½¦è´¹é»˜è®¤å¼€å§‹æ—¥æœŸä¸ºä»Šæ—¥
                endDate: type === 'parking' ? calculateEndDate(today, 1) : ''  // åœè½¦è´¹é»˜è®¤ç»“æŸæ—¥æœŸ
            };
            
            feeItems.value.push(newItem);
            addedFeeTypes.value.add(type); // è®°å½•å·²æ·»åŠ çš„ç±»å‹
            
            console.log(`æ·»åŠ ${getFeeTypeName(type)}:`, { 
                type, 
                unitPrice, 
                amount: finalAmount,
                isRefund: isRefundMode.value,
                source: 'API',
                apiPrice: communityPrices.value[type],
                startDate: newItem.startDate,
                endDate: newItem.endDate
            });
            
            const modeText = isRefundMode.value ? 'é€€è´¹' : 'æ”¶è´¹';
            ElMessage.success(`å·²æ·»åŠ ${getFeeTypeName(type)}${modeText}ï¼Œå•ä»·ï¼š${unitPrice}å…ƒ`);
        };
        
        // æ›´æ–°é¡¹ç›®é‡‘é¢ï¼ˆé€šè¿‡æ•°é‡è®¡ç®—é‡‘é¢ï¼‰
        const updateItemAmount = (index) => {
            const item = feeItems.value[index];
            if (!item) return;
            
            const quantity = parseFloat(item.quantity) || 0;
            const unitPrice = parseFloat(item.unitPrice) || 0;
            const baseAmount = (quantity * unitPrice).toFixed(2);
            
            // é€€è´¹æ¨¡å¼ï¼šé‡‘é¢å§‹ç»ˆä¸ºè´Ÿæ•°
            const finalAmount = isRefundMode.value ? -Math.abs(baseAmount) : Math.abs(baseAmount);
            
            // ä½¿ç”¨Object.assignç¡®ä¿å“åº”å¼æ›´æ–°
            Object.assign(item, {
                amount: finalAmount
            });
            
            // å¦‚æœæ˜¯åœè½¦è´¹ï¼Œæ›´æ–°ç»“æŸæ—¥æœŸ
            if (item.type === 'parking') {
                if (item.startDate && item.quantity) {
                    const newEndDate = calculateEndDate(item.startDate, item.quantity);
                    Object.assign(item, {
                        endDate: newEndDate
                    });
                }
            }
            
            console.log('é‡‘é¢æ›´æ–°:', index, item.type, 'æ•°é‡:', quantity, 'å•ä»·:', unitPrice, 'é‡‘é¢:', finalAmount, 'é€€è´¹æ¨¡å¼:', isRefundMode.value);
        };
        
        // é€€è´¹æ¨¡å¼åˆ‡æ¢å¤„ç†
        const onRefundModeChange = () => {
            // å½“é€€è´¹æ¨¡å¼åˆ‡æ¢æ—¶ï¼Œé‡æ–°è®¡ç®—æ‰€æœ‰è´¹ç”¨é¡¹çš„é‡‘é¢
            feeItems.value.forEach((item, index) => {
                const quantity = parseFloat(item.quantity) || 0;
                const unitPrice = parseFloat(item.unitPrice) || 0;
                const baseAmount = (quantity * unitPrice).toFixed(2);
                
                // é€€è´¹æ¨¡å¼ï¼šé‡‘é¢å§‹ç»ˆä¸ºè´Ÿæ•°
                const finalAmount = isRefundMode.value ? -Math.abs(baseAmount) : Math.abs(baseAmount);
                
                Object.assign(item, {
                    amount: finalAmount
                });
            });
            
            const modeText = isRefundMode.value ? 'é€€è´¹' : 'æ”¶è´¹';
            ElMessage.info(`å·²åˆ‡æ¢åˆ°${modeText}æ¨¡å¼`);
        };
        
        // ä¸“é—¨å¤„ç†åœè½¦è´¹æ•°é‡å˜åŒ–
        const handleParkingQuantityChange = (index) => {
            const item = feeItems.value[index];
            if (!item || item.type !== 'parking') return;
            
            console.log('åœè½¦è´¹æ•°é‡å˜åŒ–:', index, 'æ•°é‡:', item.quantity);
            
            // æ›´æ–°é‡‘é¢
            updateItemAmount(index);
            
            // å¼ºåˆ¶é‡æ–°è®¡ç®—ç»“æŸæ—¥æœŸï¼ˆupdateItemAmountä¸­å·²ç»å¤„ç†ï¼Œè¿™é‡Œç¡®ä¿åŒé‡ä¿é™©ï¼‰
            if (item.startDate && item.quantity) {
                const newEndDate = calculateEndDate(item.startDate, item.quantity);
                Object.assign(item, {
                    endDate: newEndDate
                });
                console.log('åœè½¦è´¹ç»“æŸæ—¥æœŸæ›´æ–°:', index, 'å¼€å§‹æ—¥æœŸ:', item.startDate, 'æœˆæ•°:', item.quantity, 'ç»“æŸæ—¥æœŸ:', newEndDate);
            }
        };
        
        // å¤„ç†æ‰€æœ‰ç±»å‹é¡¹ç›®çš„æ•°é‡å˜åŒ–
        const handleQuantityChange = (index, value) => {
            const item = feeItems.value[index];
            if (!item) return;
            
            console.log('æ•°é‡å˜åŒ–å¤„ç†:', item.type, index, 'æ–°å€¼:', value, 'å½“å‰æ•°é‡:', item.quantity);
            
            // ç¡®ä¿æ•°é‡å€¼æ­£ç¡®æ›´æ–°
            if (value !== undefined) {
                item.quantity = value;
            }
            
            if (item.type === 'parking') {
                handleParkingQuantityChange(index);
            } else {
                updateItemAmount(index);
            }
        };
        
        // æµ‹è¯•åœè½¦è´¹æ—¥æœŸè®¡ç®—é€»è¾‘
        const testParkingDateCalculation = () => {
            console.log('=== åœè½¦è´¹æ—¥æœŸè®¡ç®—æµ‹è¯• ===');
            
            // æµ‹è¯•ç”¨ä¾‹1ï¼šæ­£å¸¸æƒ…å†µ - 2025/12/19 + 2ä¸ªæœˆ = 2026/2/18
            const test1 = calculateEndDate('2025/12/19', 2);
            console.log('æµ‹è¯•1 - 2025/12/19 + 2ä¸ªæœˆ:', test1, 'é¢„æœŸ: 2026/02/18', test1 === '2026/02/18' ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥');
            
            // æµ‹è¯•ç”¨ä¾‹2ï¼šæœˆæœ«è¾¹ç•Œ - 2025/1/31 + 1ä¸ªæœˆ = 2025/2/28
            const test2 = calculateEndDate('2025/1/31', 1);
            console.log('æµ‹è¯•2 - 2025/1/31 + 1ä¸ªæœˆ:', test2, 'é¢„æœŸ: 2025/02/28', test2 === '2025/02/28' ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥');
            
            // æµ‹è¯•ç”¨ä¾‹3ï¼šé—°å¹´å¤„ç† - 2024/2/29 + 12ä¸ªæœˆ = 2025/2/28
            const test3 = calculateEndDate('2024/2/29', 12);
            console.log('æµ‹è¯•3 - 2024/2/29 + 12ä¸ªæœˆ:', test3, 'é¢„æœŸ: 2025/02/28', test3 === '2025/02/28' ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥');
            
            // æµ‹è¯•ç”¨ä¾‹4ï¼šéé—°å¹´ - 2025/2/28 + 1ä¸ªæœˆ = 2025/3/27
            const test4 = calculateEndDate('2025/2/28', 1);
            console.log('æµ‹è¯•4 - 2025/2/28 + 1ä¸ªæœˆ:', test4, 'é¢„æœŸ: 2025/03/27', test4 === '2025/03/27' ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥');
            
            // æµ‹è¯•ç”¨ä¾‹5ï¼šå¹´æœ«è¾¹ç•Œ - 2025/12/31 + 1ä¸ªæœˆ = 2026/1/30
            const test5 = calculateEndDate('2025/12/31', 1);
            console.log('æµ‹è¯•5 - 2025/12/31 + 1ä¸ªæœˆ:', test5, 'é¢„æœŸ: 2026/01/30', test5 === '2026/01/30' ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥');
            
            console.log('=== æµ‹è¯•å®Œæˆ ===');
        };
        
        // é€šè¿‡é‡‘é¢åæ¨æ•°é‡
        const updateItemQuantityFromAmount = (index) => {
            const item = feeItems.value[index];
            let amount = parseFloat(item.amount) || 0;
            const unitPrice = parseFloat(item.unitPrice) || 0;
            
            // é€€è´¹æ¨¡å¼ä¸‹ï¼šç¡®ä¿é‡‘é¢å§‹ç»ˆä¸ºè´Ÿæ•°
            if (isRefundMode.value && amount > 0) {
                amount = -amount;
                // æ›´æ–°é‡‘é¢ä¸ºè´Ÿæ•°
                Object.assign(item, {
                    amount: amount
                });
            }
            
            if (unitPrice > 0) {
                // è®¡ç®—æ•°é‡ = é‡‘é¢ / å•ä»·
                let quantity = amount / unitPrice;
                
                // æ ¹æ®è´¹ç”¨ç±»å‹å¤„ç†å°æ•°ä½æ•°
                if (item.type === 'network' || item.type === 'parking') {
                    // ç½‘è´¹å’Œåœè½¦è´¹æŒ‰æ•´æœˆè®¡ç®—ï¼Œå››èˆäº”å…¥åˆ°æ•´æ•°
                    quantity = Math.round(quantity);
                } else {
                    // ç”µè´¹å’Œæ°´è´¹ä¿ç•™1ä½å°æ•°
                    quantity = Math.round(quantity * 10) / 10;
                }
                
                // ç¡®ä¿æ•°é‡ä¸ä¸ºè´Ÿæ•°
                if (quantity < 0) quantity = 0;
                
                item.quantity = quantity;
                
                // å¦‚æœæ˜¯åœè½¦è´¹ï¼Œæ›´æ–°ç»“æŸæ—¥æœŸ
                if (item.type === 'parking') {
                    if (item.startDate && item.quantity) {
                        item.endDate = calculateEndDate(item.startDate, item.quantity);
                    }
                }
            }
        };
        
        // ç§»é™¤è´¹ç”¨é¡¹ç›®
        const removeFeeItem = (index) => {
            const removedType = feeItems.value[index].type;
            feeItems.value.splice(index, 1);
            addedFeeTypes.value.delete(removedType); // é‡Šæ”¾è´¹ç”¨ç±»å‹
            ElMessage.success(`${getFeeTypeName(removedType)}å·²åˆ é™¤`);
        };
        
        // é€‰æ‹©æ”¶æ¬¾æ–¹å¼
        const selectPaymentMethod = (method) => {
            if (paymentMethod.value === method) {
                // å¦‚æœå·²ç»é€‰ä¸­ï¼Œå†æ¬¡ç‚¹å‡»åˆ™å–æ¶ˆé€‰æ‹©
                paymentMethod.value = '';
            } else {
                paymentMethod.value = method;
            }
        };
        
        // å‡†å¤‡æ‰“å°å‡­æ®æ•°æ® - ä¿®æ”¹åçš„ç‰ˆæœ¬ï¼Œä½¿ç”¨æ–°çš„æ ¼å¼
        const prepareReceiptData = (result, selectedRoom) => {
            // è·å–å½“å‰æ—¶é—´
            const now = new Date();
            const timeStr = now.toLocaleString('zh-CN');
            
            // æ„å»ºè´¹ç”¨é¡¹ç›®HTMLï¼ˆæ–°æ ¼å¼ï¼‰
            const feeItemsArr = [];
            
            feeItems.value.forEach(item => {
                const name = getFeeTypeName(item.type);
                const quantity = parseFloat(item.quantity) || 0;
                const amount = parseFloat(item.amount) || 0;
                const unit = getFeeUnit(item.type);
                
                let feeText = '';
                
                if (item.type === 'parking') {
                    // åœè½¦è´¹æ ¼å¼ï¼šåœè½¦è´¹ | 1ä¸ªæœˆ | Â¥130.00 | 2025/12/1-2025/12/31| çš–CMV152
                    const startDate = item.startDate ? formatDate(item.startDate).split(' ')[0] : '';
                    const endDate = item.endDate ? formatDate(item.endDate).split(' ')[0] : '';
                    const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                    const carPlate = item.carPlate || '';
                    
                    feeText = `${name} | ${quantity}${unit} | Â¥${formatPrice(amount)} | ${dateRange} | ${carPlate}`;
                } else {
                    // å…¶ä»–é¡¹ç›®æ ¼å¼ï¼šç”µè´¹ | 200.0åº¦ | Â¥170.00
                    feeText = `${name} | ${quantity}${unit} | Â¥${formatPrice(amount)}`;
                }

                
                feeItemsArr.push(feeText);
            });
            
            // å°†æ•°ç»„è½¬æ¢ä¸ºHTMLï¼Œæ¯é¡¹å ä¸€è¡Œ
            const feeItemsHtml = feeItemsArr.join('<br>');
            
            // å¡«å……æ‰“å°æ•°æ®
            receiptData.value = {
                time: timeStr,
                building: selectedBuilding.value || '',
                room: selectedRoom ? selectedRoom.room : '',
                residentName: residentName.value || '',
                residentPhone: residentPhone.value || '',
                paymentMethod: paymentMethod.value,
                feeItems: feeItemsArr.join('ï¼Œ'), // ä¿ç•™åŸæ ¼å¼ï¼Œä»¥é˜²å…¶ä»–åœ°æ–¹éœ€è¦
                feeItemsHtml: feeItemsHtml, // æ–°å¢HTMLæ ¼å¼
                totalAmount: formatPrice(totalAmount.value),
                billNumber: result.data.billNumber,
                printTime: timeStr,
                community: user.value.community || ''
            };
        };
        
        // æ‰“å°å‡­æ®
        const printReceipt = () => {
            // æ˜¾ç¤ºæ‰“å°åŒºåŸŸ
            const printDiv = document.getElementById('print-receipt');
            printDiv.style.display = 'block';
            
            // æ·»åŠ æ‰“å°åå¤„ç†äº‹ä»¶
            const afterPrint = () => {
                printDiv.style.display = 'none';
                window.removeEventListener('afterprint', afterPrint);
            };
            
            // ç›‘å¬æ‰“å°åäº‹ä»¶
            window.addEventListener('afterprint', afterPrint);
            
            // è°ƒç”¨æ‰“å°
            window.print();
            
            // å¤‡ç”¨æ–¹æ¡ˆï¼šå¦‚æœafterprintäº‹ä»¶æœªè§¦å‘ï¼Œä½¿ç”¨setTimeout
            setTimeout(() => {
                if (printDiv.style.display === 'block') {
                    printDiv.style.display = 'none';
                }
            }, 1000);
        };
        
        // ç”Ÿæˆè´¦å•
        const generateBill = async () => {
            if (!canGenerate.value) return;
            
            try {
                generating.value = true;
                
                // å‡†å¤‡æ•°æ®
                // ä½¿ç”¨å½“å‰æ—¥æœŸæ—¶é—´ä½œä¸ºæ”¶è´¹æ—¥æœŸ
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                const entryTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
                
                const orderData = {
                    addressId: selectedRoomId.value,
                    paymentMethod: paymentMethod.value,
                    totalAmount: totalAmount.value,
                    // é€€è´¹æ¨¡å¼ä¸‹åœ¨å¤‡æ³¨ä¸­æ·»åŠ ã€é€€è´¹ã€‘æ ‡è¯†ï¼ˆæ”¾åœ¨å‰é¢ï¼‰
                    remark: isRefundMode.value ? 
                            (remark.value ? `ã€é€€è´¹ã€‘${remark.value}` : 'ã€é€€è´¹ã€‘') : 
                            remark.value,
                    residentName: residentName.value,
                    residentPhone: residentPhone.value,
                    entryTime: entryTime,  // æ·»åŠ æ”¶è´¹æ—¥æœŸæ—¶é—´
                    items: feeItems.value.map(item => {
                        const itemData = {
                            type: item.type,
                            quantity: parseFloat(item.quantity) || 0,
                            unitPrice: parseFloat(item.unitPrice) || 0,
                            amount: parseFloat(item.amount) || 0
                        };
                        
                        // å¦‚æœæ˜¯åœè½¦è´¹ï¼Œæ·»åŠ è½¦ç‰Œå·ã€å¼€å§‹æ—¥æœŸã€ç»“æŸæ—¥æœŸ
                        if (item.type === 'parking') {
                            itemData.carPlate = item.carPlate || '';
                            // ç¡®ä¿æ—¥æœŸæ ¼å¼ä¸º yyyy-MM-ddï¼ˆåç«¯æœŸæœ›æ ¼å¼ï¼‰
                            itemData.startDate = item.startDate ? item.startDate.replace(/\//g, '-') : '';
                            itemData.endDate = item.endDate ? item.endDate.replace(/\//g, '-') : '';
                        }
                        
                        return itemData;
                    }),
                    // æ·»åŠ æˆ¿ç§Ÿå’Œç®¡ç†è´¹æ•°æ®æ˜ å°„
                    rentMonths: feeItems.value.find(item => item.type === 'rent') ? 
                              parseFloat(feeItems.value.find(item => item.type === 'rent').quantity) || 0 : 0,
                    rentAmount: feeItems.value.find(item => item.type === 'rent') ? 
                              parseFloat(feeItems.value.find(item => item.type === 'rent').amount) || 0 : 0,
                    managementMonths: feeItems.value.find(item => item.type === 'management') ? 
                                    parseFloat(feeItems.value.find(item => item.type === 'management').quantity) || 0 : 0,
                    managementAmount: feeItems.value.find(item => item.type === 'management') ? 
                                    parseFloat(feeItems.value.find(item => item.type === 'management').amount) || 0 : 0
                };
                
                // è°ƒç”¨åç«¯API
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(orderData)
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    // æ˜¾ç¤ºæˆåŠŸå¯¹è¯æ¡†ï¼Œè¯¢é—®æ˜¯å¦æ‰“å°
                    ElMessageBox.confirm(
                        `æ”¶è´¹æˆåŠŸï¼\nè´¦å•å·ï¼š${result.data.billNumber}\né‡‘é¢ï¼š${formatPrice(totalAmount.value)}å…ƒ`,
                        'æ“ä½œæˆåŠŸ',
                        {
                            confirmButtonText: 'ç«‹å³æ‰“å°',
                            cancelButtonText: 'ç»§ç»­å¼€å•',
                            type: 'success',
                            center: true,
                            showClose: false
                        }
                    ).then(() => {
                        // ç”¨æˆ·ç‚¹å‡»äº†"ç«‹å³æ‰“å°"
                        // è·å–å½“å‰é€‰ä¸­çš„æˆ¿é—´ä¿¡æ¯
                        const selectedRoom = rooms.value.find(r => r.id === selectedRoomId.value);
                        
                        // å‡†å¤‡æ‰“å°æ•°æ®
                        prepareReceiptData(result, selectedRoom);
                        
                        // æ‰“å°å‡­æ®
                        setTimeout(() => {
                            printReceipt();
                        }, 100);
                        
                        // å»¶è¿Ÿ1ç§’åæ¸…ç©ºè¡¨å•ï¼Œä»¥ä¾¿ç»§ç»­å¼€å•
                        setTimeout(() => {
                            // æ¸…ç©ºè´¹ç”¨é¡¹ç›®
                            feeItems.value = [];
                            addedFeeTypes.value.clear();
                            
                            // é‡ç½®æ”¯ä»˜æ–¹å¼å’Œå¤‡æ³¨
                            paymentMethod.value = '';
                            remark.value = '';
                            
                            // æ¸…ç©ºä½æˆ·ä¿¡æ¯
                            residentName.value = '';
                            residentPhone.value = '';
                            phoneError.value = '';
                            
                            // æ¸…ç©ºåœ°å€é€‰æ‹©
                            selectedBuilding.value = '';
                            selectedRoomId.value = '';
                            rooms.value = [];
                            
                            // æ¸…ç©ºç”¨æˆ·å†å²ç¼´è´¹è®°å½•å¹¶ç½®ä¸ºæŠ˜å çŠ¶æ€
                            userHistoryOrders.value = [];
                            historyExpanded.value = false;
                            
                            // é‡ç½®é€€è´¹æ¨¡å¼ä¸ºæœªå‹¾é€‰çŠ¶æ€
                            isRefundMode.value = false;
                            
                            // é‡æ–°åŠ è½½æœ€è¿‘è®°å½•
                            loadRecentOrders();
                            
                            ElMessage.success('æ‰“å°å®Œæˆï¼Œå¯ä»¥ç»§ç»­å¼€å•');
                        }, 1000);
                    }).catch((dialogError) => {
                        if (dialogError === 'cancel') {
                            // ç”¨æˆ·ç‚¹å‡»äº†"ç»§ç»­å¼€å•"
                            // æ¸…ç©ºè´¹ç”¨é¡¹ç›®
                            feeItems.value = [];
                            addedFeeTypes.value.clear();
                            
                            // é‡ç½®æ”¯ä»˜æ–¹å¼å’Œå¤‡æ³¨
                            paymentMethod.value = '';
                            remark.value = '';
                            
                            // æ¸…ç©ºä½æˆ·ä¿¡æ¯
                            residentName.value = '';
                            residentPhone.value = '';
                            phoneError.value = '';
                            
                            // æ¸…ç©ºåœ°å€é€‰æ‹©
                            selectedBuilding.value = '';
                            selectedRoomId.value = '';
                            rooms.value = [];
                            
                            // æ¸…ç©ºç”¨æˆ·å†å²ç¼´è´¹è®°å½•å¹¶ç½®ä¸ºæŠ˜å çŠ¶æ€
                            userHistoryOrders.value = [];
                            historyExpanded.value = false;
                            
                            // é‡ç½®é€€è´¹æ¨¡å¼ä¸ºæœªå‹¾é€‰çŠ¶æ€
                            isRefundMode.value = false;
                            
                            // é‡æ–°åŠ è½½æœ€è¿‘è®°å½•
                            loadRecentOrders();
                            
                            ElMessage.success('è®¢å•å·²ä¿å­˜ï¼Œè¯·ç»§ç»­å¼€å•');
                        } else {
                            // å…¶ä»–é”™è¯¯
                            console.error('å¯¹è¯æ¡†é”™è¯¯:', dialogError);
                            ElMessage.success('è®¢å•å·²ä¿å­˜');
                        }
                    });
                    
                } else {
                    ElMessage.error(result.message || 'è´¦å•ç”Ÿæˆå¤±è´¥');
                }
            } catch (error) {
                console.error('ç”Ÿæˆè´¦å•å¤±è´¥:', error);
                ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
            } finally {
                generating.value = false;
            }
        };
        
        // æ¸…ç©ºè¡¨å•
        const clearForm = () => {
            ElMessageBox.confirm('ç¡®å®šè¦æ¸…ç©ºå½“å‰è¡¨å•å—ï¼Ÿ', 'æç¤º', {
                confirmButtonText: 'ç¡®å®š',
                cancelButtonText: 'å–æ¶ˆ',
                type: 'warning'
            }).then(() => {
                // æ¸…ç©ºè´¹ç”¨é¡¹ç›®
                feeItems.value = [];
                addedFeeTypes.value.clear();
                
                // é‡ç½®æ”¯ä»˜æ–¹å¼å’Œå¤‡æ³¨
                paymentMethod.value = '';
                remark.value = '';
                
                // æ¸…ç©ºä½æˆ·ä¿¡æ¯
                residentName.value = '';
                residentPhone.value = '';
                phoneError.value = '';
                
                // æ¸…ç©ºåœ°å€é€‰æ‹©
                selectedBuilding.value = '';
                selectedRoomId.value = '';
                rooms.value = [];
                
                // æ¸…ç©ºç”¨æˆ·å†å²ç¼´è´¹è®°å½•å¹¶ç½®ä¸ºæŠ˜å çŠ¶æ€
                userHistoryOrders.value = [];
                historyExpanded.value = false;
                
                // é‡ç½®é€€è´¹æ¨¡å¼ä¸ºæœªå‹¾é€‰çŠ¶æ€
                isRefundMode.value = false;
                
                // æ³¨æ„ï¼šæ”¶è´¹æ—¥æœŸæ—¶é—´ä¸æ¸…ç©ºï¼Œä¿ç•™å½“å‰æ—¶é—´
                
                ElMessage.success('è¡¨å•å·²æ¸…ç©º');
            }).catch(() => {
                // ç”¨æˆ·å–æ¶ˆ
            });
        };
        
        // æ”¶è´¹æ ‡å‡†ç®¡ç†é¡µé¢è·³è½¬
        const goToFeePricesAdmin = async () => {
            const token = sessionStorage.getItem('token');
            if (!token) {
                ElMessage.error('è¯·å…ˆç™»å½•');
                window.location.href = '/login';
                return;
            }
            
            try {
                // ä½¿ç”¨fetch APIï¼Œæ‰‹åŠ¨åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦Tokenå»è·å–ç®¡ç†é¡µé¢çš„HTML
                const response = await fetch('/admin/fee-prices', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    // è·å–åˆ°HTMLå†…å®¹
                    const htmlContent = await response.text();
                    // åœ¨æ–°çª—å£/æ ‡ç­¾é¡µä¸­æ‰“å¼€ï¼ˆæ¨èï¼Œä½“éªŒæ›´å¥½ï¼‰
                    const newWindow = window.open('', '_blank');
                    if (newWindow) {
                        newWindow.document.write(htmlContent);
                        newWindow.document.close();
                    } else {
                        ElMessage.warning('è¯·å…è®¸æµè§ˆå™¨å¼¹å‡ºçª—å£ï¼Œæˆ–åœ¨æ–°æ ‡ç­¾é¡µæ‰‹åŠ¨è®¿é—®');
                    }
                } else if (response.status === 401) {
                    ElMessage.error('ä»¤ç‰Œæ— æ•ˆæˆ–å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•');
                    sessionStorage.removeItem('token');
                    sessionStorage.removeItem('user');
                    window.location.href = '/login';
                } else if (response.status === 403) {
                    ElMessage.error('æƒé™ä¸è¶³ï¼Œéœ€è¦ç®¡ç†å‘˜èº«ä»½');
                } else {
                    ElMessage.error('è®¿é—®ç®¡ç†é¡µé¢å¤±è´¥');
                }
            } catch (error) {
                console.error('è·³è½¬å¤±è´¥:', error);
                ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
            }
        };
        
        // é€€å‡ºç™»å½•
        const logout = () => {
            ElMessageBox.confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ', 'æç¤º', {
                confirmButtonText: 'ç¡®å®š',
                cancelButtonText: 'å–æ¶ˆ',
                type: 'warning'
            }).then(() => {
                sessionStorage.removeItem('token');
                sessionStorage.removeItem('user');
                window.location.href = '/login';
            }).catch(() => {
                // ç”¨æˆ·å–æ¶ˆ
            });
        };
        
        // åŠ è½½æ¥¼æ ‹åˆ—è¡¨
        const loadBuildings = async () => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/addresses?step=buildings', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    buildings.value = result.data;
                } else {
                    ElMessage.error('åŠ è½½æ¥¼æ ‹åˆ—è¡¨å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½æ¥¼æ ‹åˆ—è¡¨å¤±è´¥:', error);
                ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
            }
        };
        
        // åŠ è½½ä»Šæ—¥æ”¶è´¹è®°å½•
        const loadRecentOrders = async () => {
            console.log('å¼€å§‹åŠ è½½ä»Šæ—¥æ”¶è´¹è®°å½•...');
            try {
                const token = sessionStorage.getItem('token');
                console.log('å‘é€è¯·æ±‚åˆ° /api/recent-orders');
                const response = await fetch('/api/recent-orders', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                console.log('æ”¶åˆ°ä»Šæ—¥æ”¶è´¹è®°å½•å“åº”:', result);
                if (result.status === 'success') {
                    recentOrders.value = result.data.orders || [];
                    console.log('è®¾ç½® recentOrders:', recentOrders.value.length, 'æ¡è®°å½•');
                    console.log('ä»Šæ—¥æ”¶è´¹è®°å½•å°†è‡ªåŠ¨è®¡ç®—');
                } else {
                    console.warn('åŠ è½½ä»Šæ—¥æ”¶è´¹è®°å½•å¤±è´¥:', result.message);
                }
            } catch (error) {
                console.error('åŠ è½½ä»Šæ—¥æ”¶è´¹è®°å½•å¤±è´¥:', error);
            }
        };
        
        // åˆ é™¤è®¢å•å‡½æ•° - åŒ…å«äºŒæ¬¡ç¡®è®¤
        const deleteOrder = async (orderId) => {
            try {
                // ç¬¬ä¸€æ¬¡ç¡®è®¤
                await ElMessageBox.confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡æ”¶è´¹è®°å½•å—ï¼Ÿ', 'åˆ é™¤ç¡®è®¤', {
                    confirmButtonText: 'ç¡®å®š',
                    cancelButtonText: 'å–æ¶ˆ',
                    type: 'warning'
                });
                
                // ç¬¬äºŒæ¬¡ç¡®è®¤
                await ElMessageBox.confirm('åˆ é™¤åæ— æ³•æ¢å¤ï¼Œè¯·å†æ¬¡ç¡®è®¤æ˜¯å¦åˆ é™¤ï¼Ÿ', 'äºŒæ¬¡ç¡®è®¤', {
                    confirmButtonText: 'ç¡®å®šåˆ é™¤',
                    cancelButtonText: 'å–æ¶ˆ',
                    type: 'error'
                });
                
                const token = sessionStorage.getItem('token');
                if (!token) {
                    ElMessage.error('è¯·å…ˆç™»å½•');
                    return;
                }
                
                // æ˜¾ç¤ºåŠ è½½ä¸­çŠ¶æ€
                const loading = ElLoading.service({
                    lock: true,
                    text: 'æ­£åœ¨åˆ é™¤è®¢å•...',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                
                try {
                    const response = await fetch(`/api/orders/${orderId}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'åˆ é™¤è®¢å•å¤±è´¥');
                    }
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        ElMessage.success('è®¢å•åˆ é™¤æˆåŠŸ');
                        // é‡æ–°åŠ è½½æœ€è¿‘è®°å½•
                        await loadRecentOrders();
                    } else {
                        throw new Error(result.message || 'åˆ é™¤è®¢å•å¤±è´¥');
                    }
                } finally {
                    loading.close();
                }
            } catch (error) {
                // å¦‚æœæ˜¯ç”¨æˆ·å–æ¶ˆï¼Œä¸æ˜¾ç¤ºé”™è¯¯
                if (error === 'cancel' || error.message === 'cancel') {
                    return;
                }
                console.error('åˆ é™¤è®¢å•å¤±è´¥:', error);
                ElMessage.error(`åˆ é™¤è®¢å•å¤±è´¥: ${error.message || error}`);
            }
        };
        
        // çº¢å†²å‡½æ•° - åˆ›å»ºè´Ÿé‡‘é¢çš„å†²é”€è®°å½•
        const handleRedReverse = async (order) => {
            try {
                let reason = '';
                let validReason = false;
                
                // å¾ªç¯å¼¹å‡ºè¾“å…¥æ¡†ç›´åˆ°ç”¨æˆ·è¾“å…¥æœ‰æ•ˆå†…å®¹
                while (!validReason) {
                    const { value: inputReason } = await ElMessageBox.prompt('è¯·è¾“å…¥çº¢å†²åŸå› ï¼š', 'çº¢å†²ç¡®è®¤', {
                        confirmButtonText: 'ç¡®å®š',
                        cancelButtonText: 'å–æ¶ˆ',
                        inputType: 'textarea',
                        inputPlaceholder: 'è¯·è¾“å…¥çº¢å†²åŸå› ...',
                        type: 'warning'
                    });
                    
                    // å¦‚æœç”¨æˆ·ç‚¹å‡»äº†å–æ¶ˆæŒ‰é’®ï¼Œåˆ™é€€å‡º
                    if (inputReason === null || inputReason === undefined) {
                        return;
                    }
                    
                    // æ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸ºç©º
                    if (inputReason.trim() === '') {
                        ElMessage.warning('çº¢å†²åŸå› ä¸èƒ½ä¸ºç©ºï¼Œè¯·é‡æ–°è¾“å…¥');
                        continue; // ç»§ç»­å¾ªç¯ï¼Œå†æ¬¡å¼¹å‡ºè¾“å…¥æ¡†
                    }
                    
                    reason = inputReason.trim();
                    validReason = true; // è¾“å…¥æœ‰æ•ˆï¼Œé€€å‡ºå¾ªç¯
                }
                
                // äºŒæ¬¡ç¡®è®¤
                await ElMessageBox.confirm(`ç¡®å®šè¦å¯¹ã€${order.building || ''}-${order.room || ''} Â¥${formatPrice(order.totalAmount)}ã€‘ è¿›è¡Œçº¢å†²å—ï¼Ÿ\nåŸå› ï¼š${reason}`, 'äºŒæ¬¡ç¡®è®¤', {
                    confirmButtonText: 'ç¡®å®šçº¢å†²',
                    cancelButtonText: 'å–æ¶ˆ',
                    type: 'error'
                });
                
                const token = sessionStorage.getItem('token');
                if (!token) {
                    ElMessage.error('è¯·å…ˆç™»å½•');
                    return;
                }
                
                // æ˜¾ç¤ºåŠ è½½ä¸­çŠ¶æ€
                const loading = ElLoading.service({
                    lock: true,
                    text: 'æ­£åœ¨åˆ›å»ºçº¢å†²è®°å½•...',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                
                try {
                    // è·å–åŸè®¢å•çš„è¯¦ç»†ä¿¡æ¯
                    const orderDetailResponse = await fetch(`/api/orders/${order.orderId}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!orderDetailResponse.ok) {
                        const errorData = await orderDetailResponse.json();
                        throw new Error(errorData.message || 'è·å–è®¢å•è¯¦æƒ…å¤±è´¥');
                    }
                    
                    const orderDetailResult = await orderDetailResponse.json();
                    if (orderDetailResult.status !== 'success') {
                        throw new Error(orderDetailResult.message || 'è·å–è®¢å•è¯¦æƒ…å¤±è´¥');
                    }
                    
                    const originalOrder = orderDetailResult.data;
                    
                    // æ„å»ºçº¢å†²è®°å½•æ•°æ®
                    const currentTime = new Date();
                    // ä½¿ç”¨æœ¬åœ°æ—¶é—´è€Œä¸æ˜¯UTCæ—¶é—´
                    const year = currentTime.getFullYear();
                    const month = String(currentTime.getMonth() + 1).padStart(2, '0');
                    const day = String(currentTime.getDate()).padStart(2, '0');
                    const hours = String(currentTime.getHours()).padStart(2, '0');
                    const minutes = String(currentTime.getMinutes()).padStart(2, '0');
                    const seconds = String(currentTime.getSeconds()).padStart(2, '0');
                    const formattedTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
                    console.log('çº¢å†²è®°å½•æ—¶é—´:', formattedTime);
                    
                    const redReverseData = {
                        addressId: originalOrder.addressId || order.addressId,
                        paymentMethod: originalOrder.paymentMethod || order.paymentMethod,
                        totalAmount: -(originalOrder.totalAmount || order.totalAmount), // é‡‘é¢æ”¹ä¸ºè´Ÿæ•°
                        remark: `ã€çº¢å†²ã€‘\nåŸè®¢å•å·ï¼š${originalOrder.billNumber || order.orderId}\nåŸå› ï¼š${reason}`,
                        residentName: originalOrder.residentName || order.residentName,
                        residentPhone: originalOrder.residentPhone || order.residentPhone,
                        entryTime: formattedTime, // ä½¿ç”¨å½“å‰æ—¶é—´
                        originalOrderId: originalOrder.orderId, // æ·»åŠ åŸè®¢å•IDï¼Œç”¨äºåç«¯è¯†åˆ«çº¢å†²æ“ä½œ
                        items: originalOrder.feeDetails ? originalOrder.feeDetails.map(item => ({
                            type: item.name.toLowerCase().includes('ç”µ') ? 'electricity' : 
                                  item.name.toLowerCase().includes('çƒ­') ? 'hotWater' :
                                  item.name.toLowerCase().includes('å†·') ? 'coldWater' :
                                  item.name.toLowerCase().includes('ç½‘') ? 'network' :
                                  item.name.toLowerCase().includes('åœ') ? 'parking' : 'other',
                            quantity: parseFloat(item.quantity) || 0,
                            unitPrice: parseFloat(item.price) || 0,
                            amount: -(parseFloat(item.amount) || 0) // é‡‘é¢æ”¹ä¸ºè´Ÿæ•°
                        })) : []
                    };
                    
                    console.log('å‘é€çš„çº¢å†²æ•°æ®:', redReverseData);
                    
                    // è°ƒç”¨åç«¯APIåˆ›å»ºçº¢å†²è®°å½•
                    const response = await fetch('/api/orders', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify(redReverseData)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'åˆ›å»ºçº¢å†²è®°å½•å¤±è´¥');
                    }
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        ElMessage.success('çº¢å†²è®°å½•åˆ›å»ºæˆåŠŸ');
                        // é‡æ–°åŠ è½½ä»Šæ—¥æ”¶è´¹è®°å½•
                        await loadRecentOrders();
                    } else {
                        throw new Error(result.message || 'åˆ›å»ºçº¢å†²è®°å½•å¤±è´¥');
                    }
                } finally {
                    loading.close();
                }
            } catch (error) {
                // å¦‚æœæ˜¯ç”¨æˆ·å–æ¶ˆï¼Œä¸æ˜¾ç¤ºé”™è¯¯
                if (error === 'cancel' || error.message === 'cancel') {
                    return;
                }
                console.error('çº¢å†²å¤±è´¥:', error);
                ElMessage.error(`çº¢å†²å¤±è´¥: ${error.message || error}`);
            }
        };
        
        // é‡æ‰“å°ç¥¨å‡½æ•° - å¢å¼ºç‰ˆ
        const reprintReceipt = async (orderId) => {
            try {
                // æ·»åŠ ç¡®è®¤å¯¹è¯æ¡†
                await ElMessageBox.confirm('ç¡®å®šè¦é‡æ‰“è¿™å¼ å°ç¥¨å—ï¼Ÿ', 'æç¤º', {
                    confirmButtonText: 'ç¡®å®š',
                    cancelButtonText: 'å–æ¶ˆ',
                    type: 'warning'
                });
                
                const token = sessionStorage.getItem('token');
                if (!token) {
                    ElMessage.error('è¯·å…ˆç™»å½•');
                    return;
                }
                
                // æ˜¾ç¤ºåŠ è½½ä¸­çŠ¶æ€
                const loading = ElLoading.service({
                    lock: true,
                    text: 'æ­£åœ¨è·å–è®¢å•ä¿¡æ¯...',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                
                try {
                    const response = await fetch(`/api/orders/${orderId}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || 'è·å–è®¢å•ä¿¡æ¯å¤±è´¥');
                    }
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        // å‡†å¤‡æ‰“å°æ•°æ®
                        const order = result.data;
                        
                        // æ„å»ºè´¹ç”¨é¡¹ç›®å­—ç¬¦ä¸²ï¼ˆæ–°æ ¼å¼ï¼‰
                        const feeItemsArr = [];
                        
                        // æ£€æŸ¥æ–°çš„æ•°æ®ç»“æ„
                        if (order.feeDetails && order.feeDetails.length > 0) {
                            // ä½¿ç”¨æ–°çš„æ•°æ®ç»“æ„
                            order.feeDetails.forEach(fee => {
                                let feeText = '';
                                
                                if (fee.name === 'åœè½¦è´¹') {
                                    // åœè½¦è´¹æ ¼å¼ï¼šåœè½¦è´¹ | 1ä¸ªæœˆ | Â¥130.00 | 2025/12/1-2025/12/31| çš–CMV152
                                    const startDate = fee.startDate ? formatDate(fee.startDate).split(' ')[0] : '';
                                    const endDate = fee.endDate ? formatDate(fee.endDate).split(' ')[0] : '';
                                    const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                                    const carPlate = fee.carPlate || '';
                                    
                                    feeText = `${fee.name} | ${fee.quantity}${fee.unit} | Â¥${formatPrice(fee.amount)} | ${dateRange} | ${carPlate}`;
                                } else {
                                    // å…¶ä»–é¡¹ç›®æ ¼å¼ï¼šç”µè´¹ | 200.0åº¦ | Â¥170.00
                                    feeText = `${fee.name} | ${fee.quantity}${fee.unit} | Â¥${formatPrice(fee.amount)}`;
                                }
                                
                                feeItemsArr.push(feeText);
                            });
                        } else {
                            // æ—§çš„å…¼å®¹æ–¹å¼
                            if (order.electricity && parseFloat(order.electricity.amount) > 0) {
                                feeItemsArr.push(`ç”µè´¹ | ${order.electricity.degree}åº¦ | Â¥${formatPrice(order.electricity.amount)}`);
                            }
                            if (order.coldWater && parseFloat(order.coldWater.amount) > 0) {
                                feeItemsArr.push(`å†·æ°´è´¹ | ${order.coldWater.ton}å¨ | Â¥${formatPrice(order.coldWater.amount)}`);
                            }
                            if (order.hotWater && parseFloat(order.hotWater.amount) > 0) {
                                feeItemsArr.push(`çƒ­æ°´è´¹ | ${order.hotWater.ton}å¨ | Â¥${formatPrice(order.hotWater.amount)}`);
                            }
                            if (order.network && parseFloat(order.network.amount) > 0) {
                                feeItemsArr.push(`ç½‘è´¹ | ${order.network.month}æœˆ | Â¥${formatPrice(order.network.amount)}`);
                            }
                            if (order.parking && parseFloat(order.parking.amount) > 0) {
                                const startDate = order.parking.startDate ? formatDate(order.parking.startDate).split(' ')[0] : '';
                                const endDate = order.parking.endDate ? formatDate(order.parking.endDate).split(' ')[0] : '';
                                const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                                const carPlate = order.parking.carPlate || '';
                                
                                feeItemsArr.push(`åœè½¦è´¹ | ${order.parking.month}æœˆ | Â¥${formatPrice(order.parking.amount)} | ${dateRange} | ${carPlate}`);
                            }
                        }
                        
                        // å°†æ•°ç»„è½¬æ¢ä¸ºHTMLï¼Œæ¯é¡¹å ä¸€è¡Œ
                        const feeItemsHtml = feeItemsArr.join('<br>');
                        const feeItemsStr = feeItemsArr.join('ï¼Œ'); // ä¿ç•™åŸæ ¼å¼ï¼Œä»¥é˜²å…¶ä»–åœ°æ–¹éœ€è¦
                        
                        // å‡†å¤‡æ‰“å°æ•°æ®
                        receiptData.value = {
                            time: order.entryTime,
                            building: order.address?.building || '',
                            room: order.address?.room || '',
                            residentName: order.residentName || order.address?.residentName || '',
                            residentPhone: order.residentPhone || order.address?.residentPhone || '',
                            paymentMethod: order.paymentMethod,
                            feeItems: feeItemsStr,
                            feeItemsHtml: feeItemsHtml, // æ–°å¢HTMLæ ¼å¼
                            totalAmount: formatPrice(order.totalAmount),
                            billNumber: order.billNumber,
                            printTime: new Date().toLocaleString('zh-CN'),
                            community: user.value.community || ''
                        };
                        
                        // æ‰“å°å‡­æ®
                        setTimeout(() => {
                            printReceipt();
                        }, 100);
                        
                        ElMessage.success('å°ç¥¨é‡æ‰“æˆåŠŸ');
                    } else {
                        throw new Error(result.message || 'è·å–è®¢å•ä¿¡æ¯å¤±è´¥');
                    }
                } finally {
                    loading.close();
                }
            } catch (error) {
                // å¦‚æœæ˜¯ç”¨æˆ·å–æ¶ˆï¼Œä¸æ˜¾ç¤ºé”™è¯¯
                if (error === 'cancel' || error.message === 'cancel') {
                    return;
                }
                console.error('é‡æ‰“å°ç¥¨å¤±è´¥:', error);
                ElMessage.error(`é‡æ‰“å°ç¥¨å¤±è´¥: ${error.message || error}`);
            }
        };
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        onMounted(() => {
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            const token = sessionStorage.getItem('token');
            if (!token) {
                window.location.href = '/login';
                return;
            }
            
            // æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ
            try {
                const payload = JSON.parse(atob(token.split('.')[1]));
                const exp = payload.exp * 1000; // è½¬æ¢ä¸ºæ¯«ç§’
                
                // æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ
                if (Date.now() >= exp) {
                    sessionStorage.removeItem('token');
                    sessionStorage.removeItem('user');
                    window.location.href = '/login';
                    return;
                }
                
                // æ£€æŸ¥æ˜¯å¦è·¨æ—¥æœŸï¼ˆæ¯”è¾ƒå½“å‰æ—¥æœŸå’Œtokenåˆ›å»ºæ—¥æœŸï¼‰
                const tokenDate = new Date(exp).toDateString();
                const currentDate = new Date().toDateString();
                if (tokenDate !== currentDate) {
                    sessionStorage.removeItem('token');
                    sessionStorage.removeItem('user');
                    window.location.href = '/login';
                    return;
                }
                
                // è®¾ç½®å®šæ—¶å™¨ï¼Œæ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡tokençŠ¶æ€
                setInterval(() => {
                    const currentToken = sessionStorage.getItem('token');
                    if (!currentToken) return;
                    
                    try {
                        const currentPayload = JSON.parse(atob(currentToken.split('.')[1]));
                        const currentExp = currentPayload.exp * 1000;
                        
                        // æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ
                        if (Date.now() >= currentExp) {
                            sessionStorage.removeItem('token');
                            sessionStorage.removeItem('user');
                            window.location.href = '/login';
                            return;
                        }
                        
                        // æ£€æŸ¥æ˜¯å¦è·¨æ—¥æœŸ
                        const currentTokenDate = new Date(currentExp).toDateString();
                        const nowDate = new Date().toDateString();
                        if (currentTokenDate !== nowDate) {
                            sessionStorage.removeItem('token');
                            sessionStorage.removeItem('user');
                            window.location.href = '/login';
                        }
                    } catch (e) {
                        console.error('Tokenæ£€æŸ¥å¤±è´¥:', e);
                    }
                }, 5 * 60 * 1000); // 5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
                
            } catch (e) {
                console.error('Tokenè§£æå¤±è´¥:', e);
                sessionStorage.removeItem('token');
                sessionStorage.removeItem('user');
                window.location.href = '/login';
                return;
            }
            
            // åˆå§‹åŒ–æ—¥å†æ§ä»¶
            layui.use('laydate', function(){
                const laydate = layui.laydate;
                
                // æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨å·²ç§»é™¤ï¼Œä¸å†éœ€è¦åˆå§‹åŒ–
                
                // åˆå§‹åŒ–è®¢å•æŸ¥è¯¢é¡µé¢çš„æ—¥æœŸé€‰æ‹©å™¨
                // å¼€å§‹æ—¶é—´é€‰æ‹©å™¨
                laydate.render({
                    elem: '#startTime',
                    type: 'datetime',
                    format: 'yyyy-MM-dd HH:mm',
                    max: 0, // æœ€å¤§å¯é€‰æ—¶é—´ä¸ºå½“å‰æ—¶é—´
                    done: function(value, date){
                        // éªŒè¯æ—¥æœŸèŒƒå›´
                        validateDateRange();
                    }
                });
                
                // ç»“æŸæ—¶é—´é€‰æ‹©å™¨
                laydate.render({
                    elem: '#endTime',
                    type: 'datetime',
                    format: 'yyyy-MM-dd HH:mm',
                    max: 0, // æœ€å¤§å¯é€‰æ—¶é—´ä¸ºå½“å‰æ—¶é—´
                    done: function(value, date){
                        // éªŒè¯æ—¥æœŸèŒƒå›´
                        validateDateRange();
                    }
                });
            });
            
            // è‡ªå®šä¹‰æœˆä»½å¹´ä»½æ§åˆ¶å™¨çš„å‡½æ•°
            function customizeMonthYearControls(instance) {
                // è·å–æœˆä»½å¹´ä»½å®¹å™¨
                const monthContainer = instance.calendarContainer.querySelector('.flatpickr-current-month');
                if (!monthContainer) return;
                
                // è·å–å½“å‰æ˜¾ç¤ºçš„å¹´æœˆ
                const currentMonth = instance.currentMonth;
                const currentYear = instance.currentYear;
                
                // åˆ›å»ºè‡ªå®šä¹‰æ§åˆ¶å™¨
                const customControls = document.createElement('div');
                customControls.className = 'custom-month-year-controls';
                customControls.style.cssText = `
                    display: flex;
                    align-items: center;
                    justify-content: flex-start;
                    width: 100%;
                    padding: 0 5px;
                    margin-top: 2px;
                    gap: 10px;
                `;
                
                // æœˆä»½æ§åˆ¶åŒºåŸŸ
                const monthControls = document.createElement('div');
                monthControls.className = 'month-controls';
                monthControls.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 3px;
                `;
                
                // æœˆä»½å‡æŒ‰é’®
                const monthPrevBtn = document.createElement('button');
                monthPrevBtn.innerHTML = '<';
                monthPrevBtn.className = 'month-nav-btn prev-month';
                monthPrevBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                monthPrevBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeMonth(-1);
                    // å¼ºåˆ¶æ›´æ–°æ—¥å†è§†å›¾
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // æœˆä»½æ˜¾ç¤º
                const monthDisplay = document.createElement('span');
                monthDisplay.className = 'month-display';
                monthDisplay.style.cssText = `
                    font-weight: bold;
                    min-width: 40px;
                    text-align: center;
                    color: #303133;
                    font-size: 14px;
                `;
                
                // æœˆä»½åŠ æŒ‰é’®
                const monthNextBtn = document.createElement('button');
                monthNextBtn.innerHTML = '>';
                monthNextBtn.className = 'month-nav-btn next-month';
                monthNextBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                monthNextBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeMonth(1);
                    // å¼ºåˆ¶æ›´æ–°æ—¥å†è§†å›¾
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // å¹´ä»½æ§åˆ¶åŒºåŸŸ
                const yearControls = document.createElement('div');
                yearControls.className = 'year-controls';
                yearControls.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 3px;
                `;
                
                // å¹´ä»½å‡æŒ‰é’®
                const yearPrevBtn = document.createElement('button');
                yearPrevBtn.innerHTML = '<';
                yearPrevBtn.className = 'year-nav-btn prev-year';
                yearPrevBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                yearPrevBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeYear(-1);
                    // å¼ºåˆ¶æ›´æ–°æ—¥å†è§†å›¾
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // å¹´ä»½æ˜¾ç¤º
                const yearDisplay = document.createElement('span');
                yearDisplay.className = 'year-display';
                yearDisplay.style.cssText = `
                    font-weight: bold;
                    min-width: 50px;
                    text-align: center;
                    color: #303133;
                    font-size: 14px;
                `;
                
                // å¹´ä»½åŠ æŒ‰é’®
                const yearNextBtn = document.createElement('button');
                yearNextBtn.innerHTML = '>';
                yearNextBtn.className = 'year-nav-btn next-year';
                yearNextBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                yearNextBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeYear(1);
                    // å¼ºåˆ¶æ›´æ–°æ—¥å†è§†å›¾
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // æ›´æ–°æ˜¾ç¤ºå‡½æ•°
                function updateMonthYearDisplay() {
                    const monthNames = ["1æœˆ", "2æœˆ", "3æœˆ", "4æœˆ", "5æœˆ", "6æœˆ", 
                                       "7æœˆ", "8æœˆ", "9æœˆ", "10æœˆ", "11æœˆ", "12æœˆ"];
                    monthDisplay.textContent = monthNames[instance.currentMonth];
                    yearDisplay.textContent = instance.currentYear + 'å¹´';
                }
                
                // åˆå§‹åŒ–æ˜¾ç¤º
                updateMonthYearDisplay();
                
                // ç»„è£…æ§ä»¶
                monthControls.appendChild(monthPrevBtn);
                monthControls.appendChild(monthDisplay);
                monthControls.appendChild(monthNextBtn);
                
                yearControls.appendChild(yearPrevBtn);
                yearControls.appendChild(yearDisplay);
                yearControls.appendChild(yearNextBtn);
                
                customControls.appendChild(monthControls);
                
                // æ·»åŠ åˆ†éš”ç¬¦
                const separator = document.createElement('div');
                separator.style.cssText = `
                    width: 1px;
                    height: 24px;
                    background: #dcdfe6;
                    margin: 0 8px;
                `;
                customControls.appendChild(separator);
                
                customControls.appendChild(yearControls);
                
                // æ›¿æ¢åŸæœ‰çš„æœˆä»½å¹´ä»½æ˜¾ç¤º
                monthContainer.innerHTML = '';
                monthContainer.appendChild(customControls);
                
                // ç›‘å¬æœˆä»½å¹´ä»½å˜åŒ–
                instance.calendarContainer.addEventListener('monthChange', updateMonthYearDisplay);
                instance.calendarContainer.addEventListener('yearChange', updateMonthYearDisplay);
            }
            
            // æ·»åŠ ç¡®å®šå’Œå–æ¶ˆæŒ‰é’®çš„å‡½æ•°
            function addCalendarButtons(instance) {
                // æ£€æŸ¥æ˜¯å¦å·²ç»æ·»åŠ è¿‡æŒ‰é’®
                if (instance.calendarContainer.querySelector('.flatpickr-custom-buttons')) {
                    return;
                }
                
                // åˆ›å»ºæŒ‰é’®å®¹å™¨
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'flatpickr-custom-buttons';
                buttonContainer.style.cssText = `
                    display: flex;
                    justify-content: flex-end;
                    gap: 10px;
                    padding: 10px 15px;
                    border-top: 1px solid rgba(64, 158, 255, 0.1);
                    background: rgba(64, 158, 255, 0.05);
                    border-radius: 0 0 20px 20px;
                `;
                
                // åˆ›å»ºå–æ¶ˆæŒ‰é’®
                const cancelButton = document.createElement('button');
                cancelButton.textContent = 'å–æ¶ˆ';
                cancelButton.className = 'flatpickr-button flatpickr-cancel';
                cancelButton.style.cssText = `
                    padding: 6px 16px;
                    border: 1px solid #dcdfe6;
                    border-radius: 4px;
                    background: #ffffff;
                    color: #606266;
                    font-size: 14px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;
                cancelButton.addEventListener('click', function() {
                    instance.close();
                });
                
                // åˆ›å»ºç¡®å®šæŒ‰é’®
                const confirmButton = document.createElement('button');
                confirmButton.textContent = 'ç¡®å®š';
                confirmButton.className = 'flatpickr-button flatpickr-confirm';
                confirmButton.style.cssText = `
                    padding: 6px 16px;
                    border: 1px solid #409eff;
                    border-radius: 4px;
                    background: #409eff;
                    color: #ffffff;
                    font-size: 14px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;
                confirmButton.addEventListener('click', function() {
                    if (instance.selectedDates.length > 0) {
                        // æ ¼å¼åŒ–é€‰ä¸­çš„æ—¥æœŸæ—¶é—´
                        const selectedDate = instance.selectedDates[0];
                        const year = selectedDate.getFullYear();
                        const month = String(selectedDate.getMonth() + 1).padStart(2, '0');
                        const day = String(selectedDate.getDate()).padStart(2, '0');
                        const hours = String(selectedDate.getHours()).padStart(2, '0');
                        const minutes = String(selectedDate.getMinutes()).padStart(2, '0');
                        const formattedDate = `${year}-${month}-${day} ${hours}:${minutes}`;
                        
                        // æ›´æ–°Vueå®ä¾‹ä¸­çš„å€¼
                        chargeDateTime.value = formattedDate;
                        // æ›´æ–°è¾“å…¥æ¡†æ˜¾ç¤º
                        instance.input.value = formattedDate;
                    }
                    instance.close();
                });
                
                // æ·»åŠ æŒ‰é’®åˆ°å®¹å™¨
                buttonContainer.appendChild(cancelButton);
                buttonContainer.appendChild(confirmButton);
                
                // å°†æŒ‰é’®å®¹å™¨æ·»åŠ åˆ°æ—¥å†é¢æ¿
                instance.calendarContainer.appendChild(buttonContainer);
            }
            
            // è‡ªå®šä¹‰æ—¶é—´é€‰æ‹©å™¨ï¼ŒåŠ å®½æ˜¾ç¤ºæ¡†ï¼Œå»æ‰è°ƒèŠ‚æŒ‰é’®
            function customizeTimeControls(instance) {
                // æŸ¥æ‰¾æ—¶é—´é€‰æ‹©å™¨å®¹å™¨
                const timeContainer = instance.calendarContainer.querySelector('.flatpickr-time');
                if (!timeContainer) return;
                
                // è°ƒæ•´æ—¶é—´å®¹å™¨å®½åº¦ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´
                timeContainer.style.width = '200px';
                timeContainer.style.padding = '10px 5px';
                
                // æŸ¥æ‰¾åˆ†é’Ÿè¾“å…¥æ¡†
                const minuteInput = timeContainer.querySelector('.flatpickr-minute');
                if (!minuteInput) return;
                
                // è°ƒæ•´åˆ†é’Ÿè¾“å…¥æ¡†çš„å®½åº¦ï¼Œå»æ‰è°ƒèŠ‚æŒ‰é’®
                minuteInput.style.width = '60px';
                minuteInput.style.paddingRight = '5px';
                
                // æŸ¥æ‰¾å°æ—¶è¾“å…¥æ¡†å¹¶è°ƒæ•´å®½åº¦
                const hourInput = timeContainer.querySelector('.flatpickr-hour');
                if (hourInput) {
                    hourInput.style.width = '60px';
                }
                
                // æŸ¥æ‰¾å¹¶ç§»é™¤å¯èƒ½å­˜åœ¨çš„è‡ªå®šä¹‰åˆ†é’Ÿæ§åˆ¶å™¨
                const existingControls = timeContainer.querySelector('.custom-minute-controls');
                if (existingControls) {
                    existingControls.remove();
                }
            }
            
            // ä½¿ç”¨ Promise æ–¹å¼ï¼Œé¿å… await è¯­æ³•é—®é¢˜
            Promise.all([
                loadBuildings(),
                loadFeePrices(),
                loadRecentOrders(),
                loadQueryBuildings()
            ]).then(() => {
                console.log('é¡µé¢åˆå§‹åŒ–å®Œæˆ');
            }).catch((error) => {
                console.error('é¡µé¢åˆå§‹åŒ–å¤±è´¥:', error);
                ElMessage.error('é¡µé¢åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•æˆ–è”ç³»ç®¡ç†å‘˜');
            });
        });

const debugPrices = () => {
    console.log('è·å–å•ä»·:', communityPrices.value);
    
    // ä½ æŒ‡å®šçš„HTMLç»“æ„ï¼ˆå®Œå…¨ä¸å˜ï¼‰
    const info = `<div style="line-height: 1.8; font-size: 14px;"> <strong style="font-size: 15px; color: #1989fa;">å½“å‰æ”¶è´¹æ ‡å‡†</strong> <hr style="border: none; border-top: 1px solid #eee; margin: 10px 0;"> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">ç”µè´¹ï¼š</span><strong>0.85</strong> å…ƒ/åº¦</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">å†·æ°´è´¹ï¼š</span><strong>6</strong> å…ƒ/å¨</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">çƒ­æ°´è´¹ï¼š</span><strong>43.5</strong> å…ƒ/å¨</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">ç½‘è´¹ï¼š</span><strong>50</strong> å…ƒ/æœˆ</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">åœè½¦è´¹ï¼š</span><strong>130</strong> å…ƒ/æœˆ</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">æˆ¿ç§Ÿï¼š</span><strong>800</strong> å…ƒ/æœˆ</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">ç®¡ç†è´¹ï¼š</span><strong>100</strong> å…ƒ/æœˆ</div> </div>`;

    // å…³é”®ï¼šæ·»åŠ  dangerouslyUseHTMLString: true è§£æHTML
    ElMessageBox.alert(info, 'æ”¶è´¹æ ‡å‡†ä¿¡æ¯', {
        confirmButtonText: 'ç¡®å®š',
        width: '400px',
        dangerouslyUseHTMLString: true // æ ¸å¿ƒé…ç½®ï¼šå…è®¸è§£æHTMLå†…å®¹
    });
};
        
        // åˆå§‹åŒ–åœè½¦è´¹æ—¥æœŸé€‰æ‹©å™¨
        const initParkingDatePickers = () => {
            // ç­‰å¾…DOMæ›´æ–°ååˆå§‹åŒ–
            nextTick(() => {
                console.log('å¼€å§‹åˆå§‹åŒ–åœè½¦è´¹æ—¥æœŸé€‰æ‹©å™¨...');
                
                // ç¡®ä¿flatpickrå·²åŠ è½½
                if (typeof flatpickr === 'undefined') {
                    console.error('flatpickræœªåŠ è½½');
                    return;
                }
                
                console.log('flatpickrå·²åŠ è½½:', typeof flatpickr);
                
                // æ£€æŸ¥DOMå…ƒç´ æ˜¯å¦å­˜åœ¨
                const startInput = document.getElementById('parkingStartDatePicker');
                const endInput = document.getElementById('parkingEndDatePicker');
                
                console.log('å¼€å§‹æ—¥æœŸè¾“å…¥æ¡†:', startInput);
                console.log('ç»“æŸæ—¥æœŸè¾“å…¥æ¡†:', endInput);
                
                if (!startInput || !endInput) {
                    console.error('åœè½¦è´¹æ—¥æœŸè¾“å…¥æ¡†æœªæ‰¾åˆ°');
                    return;
                }
                
                // æ£€æŸ¥æ˜¯å¦å·²ç»åˆå§‹åŒ–è¿‡
                if (startInput._flatpickr || endInput._flatpickr) {
                    console.log('åœè½¦è´¹æ—¥æœŸé€‰æ‹©å™¨å·²åˆå§‹åŒ–ï¼Œè·³è¿‡é‡æ–°åˆå§‹åŒ–');
                    console.log('å¼€å§‹æ—¥æœŸflatpickrå®ä¾‹:', startInput._flatpickr);
                    console.log('ç»“æŸæ—¥æœŸflatpickrå®ä¾‹:', endInput._flatpickr);
                    
                    // æµ‹è¯•æ‰‹åŠ¨ç‚¹å‡»äº‹ä»¶
                    startInput.addEventListener('click', function() {
                        console.log('å¼€å§‹æ—¥æœŸè¾“å…¥æ¡†è¢«ç‚¹å‡»');
                        if (startInput._flatpickr) {
                            console.log('å°è¯•æ‰“å¼€flatpickræ—¥å†');
                            startInput._flatpickr.open();
                        }
                    });
                    
                    endInput.addEventListener('click', function() {
                        console.log('ç»“æŸæ—¥æœŸè¾“å…¥æ¡†è¢«ç‚¹å‡»');
                        if (endInput._flatpickr) {
                            console.log('å°è¯•æ‰“å¼€flatpickræ—¥å†');
                            endInput._flatpickr.open();
                        }
                    });
                    
                    return;
                }
                
                console.log('å¼€å§‹åˆå§‹åŒ–flatpickrå®ä¾‹...');
                
                // æ·»åŠ æ‰‹åŠ¨ç‚¹å‡»äº‹ä»¶æµ‹è¯•
                startInput.addEventListener('click', function() {
                    console.log('å¼€å§‹æ—¥æœŸè¾“å…¥æ¡†è¢«ç‚¹å‡»ï¼ˆåˆå§‹åŒ–å‰ï¼‰');
                });
                
                endInput.addEventListener('click', function() {
                    console.log('ç»“æŸæ—¥æœŸè¾“å…¥æ¡†è¢«ç‚¹å‡»ï¼ˆåˆå§‹åŒ–å‰ï¼‰');
                });
                
                // åˆå§‹åŒ–å¼€å§‹æ—¥æœŸé€‰æ‹©å™¨ - ä½¿ç”¨ç›¸å¯¹ä½ç½®è·Ÿéšè¾“å…¥æ¡†
                const startPicker = flatpickr('#parkingStartDatePicker', {
                    dateFormat: 'Y/m/d',
                    locale: 'zh',
                    position: 'below', // æ˜¾ç¤ºåœ¨è¾“å…¥æ¡†ä¸‹æ–¹
                    appendTo: startInput.parentNode, // é™„åŠ åˆ°è¾“å…¥æ¡†çš„çˆ¶å…ƒç´ 
                    onChange: function(selectedDates, dateStr, instance) {
                        // ä½¿ç”¨ä¸“é—¨çš„å¤„ç†å‡½æ•°
                        handleParkingStartDateChange(dateStr);
                    }
                });
                
                console.log('å¼€å§‹æ—¥æœŸé€‰æ‹©å™¨åˆå§‹åŒ–å®Œæˆ:', startPicker);
                
                // åˆå§‹åŒ–ç»“æŸæ—¥æœŸé€‰æ‹©å™¨ - ä½¿ç”¨ç›¸å¯¹ä½ç½®è·Ÿéšè¾“å…¥æ¡†
                const endPicker = flatpickr('#parkingEndDatePicker', {
                    dateFormat: 'Y/m/d',
                    locale: 'zh',
                    position: 'below', // æ˜¾ç¤ºåœ¨è¾“å…¥æ¡†ä¸‹æ–¹
                    appendTo: endInput.parentNode, // é™„åŠ åˆ°è¾“å…¥æ¡†çš„çˆ¶å…ƒç´ 
                    onChange: function(selectedDates, dateStr, instance) {
                        // ä½¿ç”¨ä¸“é—¨çš„å¤„ç†å‡½æ•°
                        handleParkingEndDateChange(dateStr);
                    }
                });
                
                console.log('ç»“æŸæ—¥æœŸé€‰æ‹©å™¨åˆå§‹åŒ–å®Œæˆ:', endPicker);
            });
        };
        
        // ç›‘å¬åœè½¦è´¹é¡¹ç›®çš„æ·»åŠ ï¼Œåˆå§‹åŒ–æ—¥æœŸé€‰æ‹©å™¨
        watch(() => feeItems.value.some(item => item.type === 'parking'), (hasParking) => {
            if (hasParking) {
                nextTick(() => {
                    initParkingDatePickers();
                });
            }
        });
        
        // ç›‘å¬åœè½¦è´¹é¡¹ç›®çš„æ•°æ®å˜åŒ–ï¼Œæ›´æ–°æ—¥æœŸé€‰æ‹©å™¨å€¼
        watch(() => getParkingItem(), (parkingItem) => {
            if (parkingItem) {
                nextTick(() => {
                    // æ›´æ–°è¾“å…¥æ¡†çš„å€¼
                    const startInput = document.getElementById('parkingStartDatePicker');
                    const endInput = document.getElementById('parkingEndDatePicker');
                    if (startInput) {
                        // ç¡®ä¿æ˜¾ç¤ºæ ¼å¼ä¸º yyyy/MM/dd
                        startInput.value = parkingItem.startDate ? parkingItem.startDate.replace(/-/g, '/') : '';
                    }
                    if (endInput) {
                        // ç¡®ä¿æ˜¾ç¤ºæ ¼å¼ä¸º yyyy/MM/dd
                        endInput.value = parkingItem.endDate ? parkingItem.endDate.replace(/-/g, '/') : '';
                    }
                });
            }
        }, { deep: true });

        // è®¢å•æŸ¥è¯¢åŠŸèƒ½ç›¸å…³å˜é‡
        const queryBuilding = ref('');
        const queryRoomId = ref('');
        const queryBuildings = ref([]);
        const queryRooms = ref([]);
        const queryData = ref([]);
        const queryLoading = ref(false);
        const queryPagination = ref({
            page: 1,
            per_page: 10,
            total: 0,
            pages: 0
        });
        const sortColumn = ref('');
        const sortOrder = ref('desc');
        const hasQueried = ref(false);
        const currentPageTotal = ref(0);
        const dateError = ref('');

        // åˆå§‹åŒ–è®¢å•æŸ¥è¯¢çš„æ¥¼æ ‹åˆ—è¡¨
        const loadQueryBuildings = async () => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/addresses?step=buildings', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    queryBuildings.value = result.data;
                } else {
                    ElMessage.error('åŠ è½½æ¥¼æ ‹åˆ—è¡¨å¤±è´¥');
                }
            } catch (error) {
                console.error('åŠ è½½æ¥¼æ ‹åˆ—è¡¨å¤±è´¥:', error);
                ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
            }
        };

        // è®¢å•æŸ¥è¯¢çš„æ¥¼æ ‹æ”¹å˜äº‹ä»¶
        const onQueryBuildingChange = async (building) => {
            queryBuilding.value = building;
            queryRoomId.value = '';
            queryRooms.value = [];
            
            if (building) {
                try {
                    const token = sessionStorage.getItem('token');
                    const response = await fetch(`/api/addresses?step=rooms&building=${encodeURIComponent(building)}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    const result = await response.json();
                    if (result.status === 'success') {
                        queryRooms.value = result.data;
                    } else {
                        ElMessage.error('åŠ è½½æˆ¿é—´åˆ—è¡¨å¤±è´¥');
                    }
                } catch (error) {
                    console.error('åŠ è½½æˆ¿é—´åˆ—è¡¨å¤±è´¥:', error);
                    ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
                }
            }
        };

        // è®¢å•æŸ¥è¯¢çš„æˆ¿é—´æ”¹å˜äº‹ä»¶
        const onQueryRoomChange = (roomId) => {
            queryRoomId.value = roomId;
        };

        // éªŒè¯æ—¥æœŸèŒƒå›´
        const validateDateRange = () => {
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            
            if (startTime && endTime) {
                const start = new Date(startTime);
                const end = new Date(endTime);
                
                if (start > end) {
                    dateError.value = 'å¼€å§‹æ—¶é—´ä¸èƒ½æ™šäºç»“æŸæ—¶é—´';
                    return false;
                }
            }
            
            dateError.value = '';
            return true;
        };

        // æŸ¥è¯¢è®¢å•
        const queryOrders = async () => {
            if (!validateDateRange()) {
                return;
            }
            
            queryLoading.value = true;
            hasQueried.value = true;
            
            try {
                const token = sessionStorage.getItem('token');
                const params = new URLSearchParams();
                
                // æ·»åŠ æŸ¥è¯¢å‚æ•° - ä¿®æ­£å‚æ•°åç§°ä»¥åŒ¹é…åç«¯API
                const startTime = document.getElementById('startTime').value;
                const endTime = document.getElementById('endTime').value;
                
                if (startTime) params.append('startDate', startTime);
                if (endTime) params.append('endDate', endTime);
                if (queryRoomId.value) params.append('addressId', queryRoomId.value);
                params.append('page', queryPagination.value.page);
                params.append('per_page', queryPagination.value.per_page);
                
                // æ·»åŠ æ’åºå‚æ•°
                if (sortColumn.value) {
                    params.append('sort', sortColumn.value);
                    params.append('order', sortOrder.value);
                }
                
                // ä¿®æ­£APIç«¯ç‚¹è·¯å¾„
                const response = await fetch(`/api/orders?${params.toString()}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    // å¤„ç†è¿”å›çš„æ•°æ®ä»¥åŒ¹é…å‰ç«¯è¡¨æ ¼æ˜¾ç¤ºæ ¼å¼
                    const processedData = result.data.map(order => {
                        // æ„å»ºè´¹ç”¨é¡¹ç›®å­—ç¬¦ä¸²
                        const feeItems = [];
                        
                        if (order.ç”µè´¹é‡‘é¢ && parseFloat(order.ç”µè´¹é‡‘é¢) > 0) {
                            const degree = parseFloat(order.ç”µè´¹åº¦æ•°) || 0;
                            const amount = parseFloat(order.ç”µè´¹é‡‘é¢) || 0;
                            feeItems.push(`ç”µè´¹ | ${degree}åº¦ | Â¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.å†·æ°´é‡‘é¢ && parseFloat(order.å†·æ°´é‡‘é¢) > 0) {
                            const ton = parseFloat(order.å†·æ°´å¨æ•°) || 0;
                            const amount = parseFloat(order.å†·æ°´é‡‘é¢) || 0;
                            feeItems.push(`å†·æ°´è´¹ | ${ton}å¨ | Â¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.çƒ­æ°´é‡‘é¢ && parseFloat(order.çƒ­æ°´é‡‘é¢) > 0) {
                            const ton = parseFloat(order.çƒ­æ°´å¨æ•°) || 0;
                            const amount = parseFloat(order.çƒ­æ°´é‡‘é¢) || 0;
                            feeItems.push(`çƒ­æ°´è´¹ | ${ton}å¨ | Â¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.ç½‘è´¹é‡‘é¢ && parseFloat(order.ç½‘è´¹é‡‘é¢) > 0) {
                            const month = parseInt(order.ç½‘è´¹æœˆæ•°) || 0;
                            const amount = parseFloat(order.ç½‘è´¹é‡‘é¢) || 0;
                            feeItems.push(`ç½‘è´¹ | ${month}æœˆ | Â¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.åœè½¦è´¹é‡‘é¢ && parseFloat(order.åœè½¦è´¹é‡‘é¢) > 0) {
                            const month = parseInt(order.åœè½¦è´¹æœˆæ•°) || 0;
                            const amount = parseFloat(order.åœè½¦è´¹é‡‘é¢) || 0;
                            const carPlate = order.è½¦ç‰Œå· || '';
                            const startDate = order.åœè½¦å¼€å§‹æ—¥æœŸ ? new Date(order.åœè½¦å¼€å§‹æ—¥æœŸ).toLocaleDateString('zh-CN') : '';
                            const endDate = order.åœè½¦ç»“æŸæ—¥æœŸ ? new Date(order.åœè½¦ç»“æŸæ—¥æœŸ).toLocaleDateString('zh-CN') : '';
                            const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                            
                            feeItems.push(`åœè½¦è´¹ | ${month}æœˆ | Â¥${amount.toFixed(2)} | ${dateRange} | ${carPlate}`);
                        }
                        // æˆ¿ç§Ÿï¼ˆæ–°å¢ï¼‰
                        if (order.rent && parseFloat(order.rent.amount) > 0) {
                            const month = parseInt(order.rent.month) || 0;
                            const amount = parseFloat(order.rent.amount) || 0;
                            feeItems.push(`æˆ¿ç§Ÿ | ${month}æœˆ | Â¥${amount.toFixed(2)}`);
                        }
                        
                        // ç®¡ç†è´¹ï¼ˆæ–°å¢ï¼‰
                        if (order.management && parseFloat(order.management.amount) > 0) {
                            const month = parseInt(order.management.month) || 0;
                            const amount = parseFloat(order.management.amount) || 0;
                            feeItems.push(`ç®¡ç†è´¹ | ${month}æœˆ | Â¥${amount.toFixed(2)}`);
                        }





                        
                        return {
                            orderId: order.è®¢å•ID,
                            billNumber: order.è´¦å•å·,
                            residentName: order.åœ°å€?.å§“å || '',
                            residentPhone: order.åœ°å€?.æ‰‹æœºå· || '',
                            building: order.åœ°å€?.æ¥¼æ ‹å· || '',
                            room: order.åœ°å€?.æˆ¿é—´å· || '',
                            feeItems: feeItems.join('\n'),
                            totalAmount: parseFloat(order.æ”¶æ¬¾é‡‘é¢) || 0,
                            paymentMethod: order.æ”¶æ¬¾æ–¹å¼ || '',
                            entryTime: order.å½•å…¥æ—¶é—´,
                            remark: order.å¤‡æ³¨ || ''
                        };
                    });
                    
                    queryData.value = processedData;
                    queryPagination.value = result.pagination;
                    
                    // è®¡ç®—å½“å‰é¡µåˆè®¡é‡‘é¢
                    currentPageTotal.value = processedData.reduce((sum, order) => sum + order.totalAmount, 0);
                } else {
                    ElMessage.error(result.message || 'æŸ¥è¯¢è®¢å•å¤±è´¥');
                    queryData.value = [];
                    queryPagination.value.total = 0;
                    currentPageTotal.value = 0;
                }
            } catch (error) {
                console.error('æŸ¥è¯¢è®¢å•å¤±è´¥:', error);
                ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥');
                queryData.value = [];
                queryPagination.value.total = 0;
                currentPageTotal.value = 0;
            } finally {
                queryLoading.value = false;
            }
        };

        // é‡ç½®æŸ¥è¯¢æ¡ä»¶
        const resetQuery = () => {
            queryBuilding.value = '';
            queryRoomId.value = '';
            queryRooms.value = [];
            queryData.value = [];
            queryPagination.value = {
                page: 1,
                per_page: 10,
                total: 0,
                pages: 0
            };
            sortColumn.value = '';
            sortOrder.value = 'desc';
            hasQueried.value = false;
            currentPageTotal.value = 0;
            dateError.value = '';
            
            // æ¸…ç©ºæ—¥æœŸè¾“å…¥æ¡†
            document.getElementById('startTime').value = '';
            document.getElementById('endTime').value = '';
        };

        // è¡¨æ ¼æ’åº
        const sortByColumn = (column) => {
            if (sortColumn.value === column) {
                sortOrder.value = sortOrder.value === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn.value = column;
                sortOrder.value = 'asc';
            }
            
            // é‡æ–°æŸ¥è¯¢
            if (hasQueried.value) {
                queryOrders();
            }
        };

        // åˆ†é¡µå¤§å°æ”¹å˜
        const handleSizeChange = (size) => {
            queryPagination.value.per_page = size;
            queryPagination.value.page = 1;
            if (hasQueried.value) {
                queryOrders();
            }
        };

        // å½“å‰é¡µæ”¹å˜
        const handleCurrentChange = (page) => {
            queryPagination.value.page = page;
            if (hasQueried.value) {
                queryOrders();
            }
        };

        // æ˜¾ç¤ºè®¢å•è¯¦æƒ…
        const showOrderDetail = (order) => {
            let detailInfo = `è®¢å•å·ï¼š${order.orderId}\n`;
            detailInfo += `å®¢æˆ·ä¿¡æ¯ï¼š${order.residentName || '-'} ${order.residentPhone || '-'}\n`;
            detailInfo += `åœ°å€ï¼š${order.building || '-'}-${order.room || '-'}\n`;
            detailInfo += `æ”¶è´¹é‡‘é¢ï¼šÂ¥${formatPrice(order.totalAmount)}\n`;
            detailInfo += `æ”¶è´¹æ—¥æœŸï¼š${formatDate(order.entryTime)}\n`;
            detailInfo += `æ”¶è´¹é¡¹ç›®ï¼š\n${formatFeeItems(order.feeItems)}`;
            
            if (order.remark) {
                detailInfo += `\nå¤‡æ³¨ï¼š${order.remark}`;
            }
            
            ElMessageBox.alert(detailInfo, 'è®¢å•è¯¦æƒ…', {
                confirmButtonText: 'ç¡®å®š',
                type: 'info'
            });
        };

        // å¤åˆ¶è®¢å•å·
        const copyOrderId = async (orderId) => {
            try {
                await navigator.clipboard.writeText(orderId);
                // æ˜¾ç¤ºè‡ªå®šä¹‰æˆåŠŸæç¤º
                showCopySuccess('è®¢å•å·å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            } catch (error) {
                // é™çº§æ–¹æ¡ˆ
                const textArea = document.createElement('textarea');
                textArea.value = orderId;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                // æ˜¾ç¤ºè‡ªå®šä¹‰æˆåŠŸæç¤º
                showCopySuccess('è®¢å•å·å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            }
        };

        // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
        const showCopySuccess = (message) => {
            // ç§»é™¤å·²å­˜åœ¨çš„æç¤º
            const existingTooltip = document.querySelector('.copy-success-tooltip');
            if (existingTooltip) {
                existingTooltip.remove();
            }
            
            // åˆ›å»ºæ–°çš„æç¤ºå…ƒç´ 
            const tooltip = document.createElement('div');
            tooltip.className = 'copy-success-tooltip';
            tooltip.textContent = message;
            document.body.appendChild(tooltip);
            
            // 2ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (tooltip.parentNode) {
                    tooltip.parentNode.removeChild(tooltip);
                }
            }, 2000);
        };

        // æ ¼å¼åŒ–è´¹ç”¨é¡¹ç›®æ˜¾ç¤º
        const formatFeeItems = (feeItems) => {
            if (!feeItems) return '-';
            
            // å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼ŒæŒ‰æ¢è¡Œç¬¦åˆ†å‰²
            if (typeof feeItems === 'string') {
                return feeItems.split('\n').join('<br>');
            }
            
            // å¦‚æœæ˜¯æ•°ç»„ï¼Œæ‹¼æ¥æ˜¾ç¤º
            if (Array.isArray(feeItems)) {
                return feeItems.map(item => {
                    if (typeof item === 'object') {
                        return `${item.name || ''} | ${item.quantity || ''}${item.unit || ''} | Â¥${formatPrice(item.amount || 0)}`;
                    }
                    return String(item);
                }).join('<br>');
            }
            
            return String(feeItems);
        };

        // è¿”å›æ‰€æœ‰éœ€è¦çš„å˜é‡å’Œå‡½æ•°
        return {
            user,
            currentPage,
            buildings,
            rooms,
            selectedBuilding,
            selectedRoomId,
            feeItems,
            paymentMethod,
            remark,
            generating,
            residentName,
            residentPhone,
            phoneError,
            totalAmount,
            canGenerate,
            buttonDisabled,
            canDeleteOrder,
            todayUserOrders,
            recentOrders,
            todayTotalAmount,
            receiptData,
            // é€€è´¹æ¨¡å¼ç›¸å…³
            isRefundMode,
            onRefundModeChange,
            validatePhone,
            onBuildingChange,
            onRoomChange,
            addFeeItem,
            updateItemAmount,
            updateItemQuantityFromAmount,
            removeFeeItem,
            handleQuantityChange,
            handleParkingQuantityChange,
            selectPaymentMethod,
            generateBill,
            clearForm,
            logout,
            debugPrices,
            loadFeePrices,
            formatPrice,
            formatDate,
            getParkingItem,
            saveParkingDetails,
            updateParkingEndDate,
            handleParkingStartDateChange,
            getFeeTypeName,
            getFeeUnit,
            goToFeePricesAdmin,
            communityPrices,
            reprintReceipt,
            deleteOrder,
            handleRedReverse,
            historyExpanded,
            historyLoading,
            userHistoryOrders,
            toggleHistory,
            loadUserPaymentHistory,
            // è®¢å•æŸ¥è¯¢ç›¸å…³
            queryBuilding,
            queryRoomId,
            queryBuildings,
            queryRooms,
            queryData,
            queryLoading,
            queryPagination,
            sortColumn,
            sortOrder,
            hasQueried,
            currentPageTotal,
            dateError,
            loadQueryBuildings,
            onQueryBuildingChange,
            onQueryRoomChange,
            validateDateRange,
            queryOrders,
            resetQuery,
            sortByColumn,
            handleSizeChange,
            handleCurrentChange,
            showOrderDetail,
            copyOrderId,
            formatFeeItems
        };
    }
});

// ä½¿ç”¨ElementPluså¹¶æŒ‚è½½åº”ç”¨
app.use(ElementPlus).mount('#app');
</script>

</body>
</html>