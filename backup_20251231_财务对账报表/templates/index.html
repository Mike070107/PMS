<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公寓物业收费系统 - 工作台</title>
    
    <!-- 资源预加载 -->
    <link rel="preload" href="/static/lib/vue.global.js" as="script">
    <link rel="preload" href="/static/lib/element-plus.full.js" as="script">
    <link rel="preload" href="/static/lib/element-plus.css" as="style">
    <link rel="preload" href="/static/lib/font-awesome.min.css?v=5" as="style">
    
    <!-- 引入 Element Plus 样式 -->
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/static/lib/element-plus.css">
    <link rel="stylesheet" href="/static/lib/font-awesome.min.css?v=5">
    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="/static/lib/flatpickr/flatpickr.min.css">
    <link rel="stylesheet" href="/static/lib/flatpickr/airbnb.css">
    <!-- Laydate CSS -->
    <link rel="stylesheet" href="/static/lib/layui/layui.min.css">
    <!-- 引入 Vue 3 和 Element Plus -->
    <script src="/static/lib/vue.global.js"></script>
    <script src="/static/lib/element-plus.full.js"></script>
    <script src="/static/lib/element-plus-icons.umd.js"></script>
    <!-- 设备指纹和API拦截器 -->
    <script src="/static/device_fingerprint.js"></script>
    <script src="/static/api_interceptor.js"></script>
    <!-- Flatpickr JS -->
    <script src="/static/lib/flatpickr/flatpickr.min.js"></script>
    <script src="/static/lib/flatpickr/zh.js"></script>
    <!-- Laydate JS -->
    <script src="/static/lib/layui/layui.min.js?v=7"></script>
    <!-- 内联日历控件样式 -->
    <style>
        .datetime-picker-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .datetime-picker-input {
            width: 100%;
            height: 40px;
            padding: 0 10px;
            border: 1px solid #e6e6e6;
            border-radius: 4px;
            background-color: #fff;
            cursor: pointer;
            box-sizing: border-box;
        }
        
        .datetime-picker-input:focus {
            border-color: #409eff;
            outline: none;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .datetime-picker-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #c0c4cc;
            pointer-events: none;
        }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f0f2f5;
        }
        
        /* 全局输入框边框修复 */
        .el-input .el-input__wrapper,
        .el-input-number .el-input-number__wrapper,
        .el-date-editor .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        .app-container {
            display: flex;
            min-height: 100vh;
            overflow: hidden;
        }
        
        .sidebar {
            width: 240px;
            background-color: #001529;
            color: white;
            padding: 0;
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);
            position: relative;
            z-index: 100;
        }
        
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .sidebar-title {
            font-size: 18px;
            font-weight: bold;
            color: white;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }
        
        .sidebar-title i {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .user-info {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
        }
        
        .nav-menu {
            list-style: none;
            padding: 10px 0;
            flex: 1;
            overflow-y: auto;
        }
        
        .nav-item {
            padding: 14px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            position: relative;
            margin: 2px 12px;
            border-radius: 6px;
        }
        
        .nav-item:hover {
            background-color: rgba(24, 144, 255, 0.8);
            transform: translateX(3px);
        }
  /*      
        .nav-item.active {
            background-color: #1890ff;
            box-shadow: 0 2px 8px rgba(24, 144, 255, 0.3);
        }
 */       
        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            /*top: 0;*/
            bottom: 0;
            width: 4px;
            background-color: #fff;
            border-radius: 0 2px 2px 0;
        }
        
        .nav-item i {
            margin-right: 12px;
            font-size: 16px;
            width: 16px;
            text-align: center;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: #f0f2f5;
            overflow: hidden;
        }
        
        .content-wrapper {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .header {
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }
        
        .workbench-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: visible;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            min-width: 120px;
            white-space: nowrap;
            overflow: visible;
            display: block;
            width: 100%;
        }
        
        .address-selector {
            margin-bottom: 30px;
            overflow: visible;
            display: block;
            width: 100%;
        }
        
        .fee-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        /* 修复按钮背景色 */
        .fee-buttons .el-button--primary {
            background-color: #409eff;
            border-color: #409eff;
        }
        
        .fee-buttons .el-button--primary:hover {
            background-color: #66b1ff;
            border-color: #66b1ff;
        }
        
        .fee-buttons .el-button--primary.is-disabled {
            background-color: #a0cfff;
            border-color: #a0cfff;
            opacity: 0.6;
        }
        
        .fee-table {
            width: 100%;
            margin-bottom: 30px;
            border-collapse: collapse;
        }
        
        .fee-table th,
        .fee-table td {
            border: 1px solid #e8e8e8;
            padding: 10px;
            text-align: center;
        }
        
        .fee-table th {
            background-color: #fafafa;
            font-weight: bold;
        }
        
        /* 调整表格列宽 - 自适应 */
        .fee-table th:nth-child(1), .fee-table td:nth-child(1) { /* 项目名称 */
            width: auto;
            min-width: 120px;
        }
        
        .fee-table th:nth-child(2), .fee-table td:nth-child(2) { /* 单位 */
            width: auto;
            min-width: 60px;
        }
        
        .fee-table th:nth-child(3), .fee-table td:nth-child(3) { /* 数量 */
            width: auto;
            min-width: 120px;
        }
        
        .fee-table th:nth-child(4), .fee-table td:nth-child(4) { /* 单价 */
            width: auto;
            min-width: 100px;
        }
        
        .fee-table th:nth-child(5), .fee-table td:nth-child(5) { /* 金额 */
            width: auto;
            min-width: 120px;
        }
        
        .fee-table th:nth-child(6), .fee-table td:nth-child(6) { /* 操作 */
            width: auto;
            min-width: 80px;
        }
        
        /* 调整字体大小 - 数量、金额与单价一致 */
        .fee-table td .el-input,
        .fee-table td .el-input-number,
        .fee-table td .el-input__inner {
            font-size: 14px !important;
            text-align: center;
        }
        
        .fee-table td .el-input-number .el-input__inner {
            font-size: 14px !important;
        }
        
        .fee-table .el-input {
            width: 100% !important;
            max-width: 120px;
        }
        
        .fee-table .el-input-number {
            width: 100% !important;
            max-width: 120px;
        }
        
        .summary-section {
            background: #fafafa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .empty-table {
            text-align: center;
            color: #999;
            padding: 40px;
        }
        
        .fee-item-actions {
            display: flex;
            gap: 5px;
            justify-content: center;
        }
        
        /* 地址选择器样式 - 移除多余边框 */
        .address-selector .el-input .el-input__wrapper,
        .address-selector .el-select .el-select__wrapper {
            border: none !important;
            box-shadow: none !important;
            background-color: transparent !important;
        }
        
        /* 地址选择器中的form-control样式 */
        .address-selector .form-control {
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            background-color: #ffffff;
            padding: 0;
        }
        
        /* 确保地址选择器中的输入框和下拉框不显示内部边框 */
        .address-selector .el-input .el-input__inner,
        .address-selector .el-select .el-select__inner {
            border: none !important;
            box-shadow: none !important;
        }
        
        /* 地址选择器样式 - 横向排列 */
        .address-row {
            display: flex;
            flex-wrap: nowrap;  /* 禁止换行 */
            gap: 20px;
            align-items: flex-start;
            justify-content: flex-start;
            overflow-x: auto;   /* 允许横向滚动 */
            width: 100%;
            min-height: auto;
            height: auto;
        }
        
        .address-row > .address-field:first-child {
            margin-left: 10px;
        }
        
        .address-field {
            display: flex;
            flex-direction: column;
            gap: 5px;
            min-width: 150px;
            flex-shrink: 0;
        }

        .field-label {
            font-size: 14px;
            color: #606266;
            font-weight: 500;
            margin-bottom: 4px;
        }

        /* 错误提示样式 */
        .phone-error {
            color: #f56c6c;
            font-size: 12px;
            margin-top: 5px;
        }

        /* 用户历史缴费记录样式 */
        .user-history-section {
            margin-top: 20px;
            border: 1px solid #e4e7ed;
            border-radius: 6px;
            overflow: hidden;
        }

        .history-header {
            background: #f5f7fa;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #e4e7ed;
            transition: background-color 0.3s ease;
        }

        .history-header:hover {
            background: #ecf5ff;
        }

        .history-title {
            font-size: 14px;
            font-weight: 500;
            color: #303133;
            display: flex;
            align-items: center;
        }

        .collapse-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            margin-right: 8px;
            font-size: 22px;
            color: #909399;
            transition: transform 0.3s ease;
        }

        .history-content {
            padding: 15px;
            background: white;
        }

        .history-loading {
            text-align: center;
            padding: 20px;
            color: #909399;
        }

        .history-empty {
            text-align: center;
            padding: 20px;
            color: #909399;
        }

        .user-history-table-container {
            overflow-x: auto;
        }

        .user-history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        .user-history-table th,
        .user-history-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #ebeef5;
        }
        
        .user-history-table td:last-child {
            text-align: left;
        }

        .user-history-table th {
            background: #fafafa;
            font-weight: 500;
            color: #606266;
        }

        .user-history-table tr:hover {
            background: #f5f7fa;
        }

        .fee-items-cell {
            font-size: 12px;
            line-height: 1.4;
        }

        /* 按钮禁用状态样式 */
        .el-button.is-disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* 停车费详情区域样式 */
        .parking-detail-row {
            background-color: #f9f9f9;
        }
        
        .parking-detail-cell {
            text-align: left !important;
            padding-left: 20px !important;
            font-size: 14px;
        }
        
        .parking-fields {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .parking-field {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .parking-label {
            font-size: 14px;
            color: #666;
            white-space: nowrap;
        }
        
        .parking-input {
            width: 180px;
        }
        
        .parking-input .el-input__inner,
        .parking-input .el-input-number__inner {
            font-size: 14px;
            padding: 10px;
        }
        
        /* 停车费日期选择器样式 */
        .parking-date-input {
            width: 150px;
            height: 32px;
            padding: 0 10px;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            font-size: 14px;
            color: #606266;
            background-color: #ffffff;
            cursor: pointer;
            box-sizing: border-box;
            transition: none;
        }
        
        /* 添加圆角样式 - 收费项目表格中的输入框 */
        .fee-table .el-input .el-input__wrapper,
        .fee-table .el-input-number .el-input-number__wrapper {
            border-radius: 4px !important;
        }
        
        /* 添加圆角样式 - 停车费详细信息中的输入框 */
        .parking-detail-cell .el-input .el-input__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-field .el-input .el-input__wrapper,
        .parking-field .el-input-number .el-input-number__wrapper {
            border-radius: 4px !important;
        }
        
        .parking-date-input:hover {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
        }
        
        .parking-date-input:focus {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            outline: none;
        }
        
        .parking-date-input::placeholder {
            color: #c0c4cc;
        }
        
        /* 移除输入框鼠标悬浮效果 - 更具体的样式 */
        .fee-table .el-input:hover .el-input__inner,
        .fee-table .el-input-number:hover .el-input__inner,
        .fee-table .el-input:hover .el-input__wrapper,
        .fee-table .el-input-number:hover .el-input__wrapper,
        .parking-input .el-input:hover .el-input__inner,
        .parking-input .el-input-number:hover .el-input__inner,
        .parking-input .el-input:hover .el-input__wrapper,
        .parking-input .el-input-number:hover .el-input__wrapper,
        .parking-field .el-input:hover .el-input__inner,
        .parking-field .el-input-number:hover .el-input__inner,
        .parking-field .el-input:hover .el-input__wrapper,
        .parking-field .el-input-number:hover .el-input__wrapper,
        .parking-field .el-date-picker:hover .el-input__inner,
        .parking-field .el-date-picker:hover .el-input__wrapper,
        .fee-table td .el-input:hover,
        .fee-table td .el-input-number:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            transform: none !important;
        }
        
        /* 更强制的移除悬浮效果 - 针对所有相关元素 */
        .fee-table .el-input__wrapper:hover,
        .fee-table .el-input-number__wrapper:hover,
        .parking-field .el-input__wrapper:hover,
        .parking-field .el-input-number__wrapper:hover,
        .parking-field .el-date-editor__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            transform: none !important;
        }
        
        /* 修复输入框边框显示问题 */
        .fee-table .el-input .el-input__wrapper,
        .fee-table .el-input-number .el-input-number__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-field .el-input-number .el-input-number__wrapper,
        .parking-field .el-date-editor .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
        }
        
        /* 确保输入框内部元素也有正确的边框 */
        .fee-table .el-input .el-input__inner,
        .fee-table .el-input-number .el-input__inner,
        .parking-detail-cell .el-input-number .el-input__inner,
        .parking-field .el-input-number .el-input__inner,
        .parking-field .el-date-editor .el-input__inner {
            border: none !important;
            box-shadow: none !important;
            background-color: transparent !important;
        }
        
        /* 车牌号输入框专用样式 - 确保正常交互 */
        .parking-detail-cell .parking-field .el-input .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
            pointer-events: auto !important;
            cursor: text !important;
        }
        
        .parking-detail-cell .parking-field .el-input .el-input__inner {
            background-color: #ffffff !important;
            pointer-events: auto !important;
            cursor: text !important;
        }
        
        /* 强制显示所有输入框的边框 - 最高优先级 */
        .fee-table .el-input__wrapper,
        .fee-table .el-input-number__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-field .el-input__wrapper,
        .parking-field .el-input-number__wrapper,
        .parking-field .el-date-editor__wrapper,
        .el-input__wrapper,
        .el-input-number__wrapper {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        /* 覆盖所有可能的隐藏边框样式 */
        .fee-table .el-input__wrapper,
        .fee-table .el-input-number__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-field .el-input__wrapper,
        .parking-field .el-input-number__wrapper,
        .parking-field .el-date-editor__wrapper {
            border-width: 1px !important;
            border-style: solid !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        /* 特别针对收费工作台中的输入框 */
        .fee-table td .el-input-number,
        .fee-table td .el-input,
        .parking-field .el-input,
        .parking-field .el-input-number,
        .parking-field .el-date-editor {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* 确保所有输入框组件都有边框 */
        .el-input,
        .el-input-number,
        .el-date-editor {
            border: 1px solid #dcdfe6 !important;
        }
        
        .el-input .el-input__wrapper,
        .el-input-number .el-input-number__wrapper,
        .el-date-editor .el-input__wrapper {
            border: 1px solid #dcdfe6 !important;
            background-color: #ffffff !important;
            box-shadow: none !important;
        }
        
        /* 最强制的移除悬浮效果 - 覆盖所有可能的样式 */
        .fee-table *:hover > .el-input__wrapper,
        .fee-table *:hover > .el-input-number__wrapper,
        .parking-detail-cell *:hover > .el-input__wrapper,
        .parking-detail-cell *:hover > .el-input-number__wrapper,
        .parking-detail-cell *:hover > .el-date-editor__wrapper {
            border-color: #dcdfe6 !important;
            box-shadow: none !important;
            transform: none !important;
        }
        
        /* 覆盖全局的输入框悬浮效果 */
        .fee-table .el-input:hover,
        .fee-table .el-input-number:hover,
        .fee-table .el-date-picker:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover,
        .fee-table td .el-input:hover,
        .fee-table td .el-input-number:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
        }
        
        /* 覆盖全局的输入框wrapper悬浮效果 */
        .fee-table .el-input__wrapper:hover,
        .fee-table .el-input-number__wrapper:hover,
        .fee-table .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
        }
        
        /* 彻底移除收费项目和停车费输入框的所有动态效果 */
        .fee-table .el-input,
        .fee-table .el-input-number,
        .fee-table .el-date-picker,
        .fee-table .el-select,
        .parking-detail-cell .el-input,
        .parking-detail-cell .el-input-number,
        .parking-detail-cell .el-select,
        .fee-table td .el-input,
        .fee-table td .el-input-number,
        .fee-table td .el-date-picker,
        .fee-table td .el-select,
        .parking-detail-cell .el-input,
        .parking-detail-cell .el-input-number,
        .parking-detail-cell .el-select {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-input *,
        .fee-table .el-input-number *,
        .fee-table .el-date-picker *,
        .fee-table .el-select *,
        .parking-detail-cell .el-input *,
        .parking-detail-cell .el-input-number *,
        .parking-detail-cell .el-date-picker *,
        .parking-detail-cell .el-select *,
        .fee-table td .el-input *,
        .fee-table td .el-input-number *,
        .fee-table td .el-date-picker *,
        .fee-table td .el-select *,
        .parking-detail-cell .el-input *,
        .parking-detail-cell .el-input-number *,
        .parking-detail-cell .el-date-picker *,
        .parking-detail-cell .el-select * {
            transition: none !important;
            transform: none !important;
        }
        
        /* 移除所有可能的悬浮效果 */
        .fee-table .el-input:hover,
        .fee-table .el-input-number:hover,
        .fee-table .el-date-picker:hover,
        .fee-table .el-select:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover,
        .parking-detail-cell .el-select:hover,
        .fee-table td .el-input:hover,
        .fee-table td .el-input-number:hover,
        .fee-table td .el-date-picker:hover,
        .fee-table td .el-select:hover,
        .parking-detail-cell .el-input:hover,
        .parking-detail-cell .el-input-number:hover,
        .parking-detail-cell .el-date-picker:hover,
        .parking-detail-cell .el-select:hover,
        .fee-table .el-input:hover *,
        .fee-table .el-input-number:hover *,
        .fee-table .el-date-picker:hover *,
        .fee-table .el-select:hover *,
        .parking-detail-cell .el-input:hover *,
        .parking-detail-cell .el-input-number:hover *,
        .parking-detail-cell .el-date-picker:hover *,
        .parking-detail-cell .el-select:hover *,
        .fee-table td .el-input:hover *,
        .fee-table td .el-input-number:hover *,
        .fee-table td .el-date-picker:hover *,
        .fee-table td .el-select:hover *,
        .parking-detail-cell .el-input:hover *,
        .parking-detail-cell .el-input-number:hover *,
        .parking-detail-cell .el-date-picker:hover *,
        .parking-detail-cell .el-select:hover * {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 移除所有可能的焦点效果 */
        .fee-table .el-input.is-focus,
        .fee-table .el-input-number.is-focus,
        .fee-table .el-date-picker.is-focus,
        .fee-table .el-select.is-focus,
        .parking-detail-cell .el-input.is-focus,
        .parking-detail-cell .el-input-number.is-focus,
        .parking-detail-cell .el-date-picker.is-focus,
        .parking-detail-cell .el-select.is-focus,
        .fee-table td .el-input.is-focus,
        .fee-table td .el-input-number.is-focus,
        .fee-table td .el-date-picker.is-focus,
        .fee-table td .el-select.is-focus,
        .parking-detail-cell .el-input.is-focus,
        .parking-detail-cell .el-input-number.is-focus,
        .parking-detail-cell .el-date-picker.is-focus,
        .parking-detail-cell .el-select.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 移除所有可能的wrapper悬浮和焦点效果 */
        .fee-table .el-input__wrapper,
        .fee-table .el-input-number__wrapper,
        .fee-table .el-date-editor__wrapper,
        .fee-table .el-select__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-detail-cell .el-date-editor__wrapper,
        .parking-detail-cell .el-select__wrapper,
        .fee-table td .el-input__wrapper,
        .fee-table td .el-input-number__wrapper,
        .fee-table td .el-date-editor__wrapper,
        .fee-table td .el-select__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .parking-detail-cell .el-date-editor__wrapper,
        .parking-detail-cell .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input__wrapper:hover,
        .fee-table .el-input-number__wrapper:hover,
        .fee-table .el-date-editor__wrapper:hover,
        .fee-table .el-select__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .fee-table td .el-date-editor__wrapper:hover,
        .fee-table td .el-select__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* 移除所有可能的inner悬浮和焦点效果 */
        .fee-table .el-input__inner,
        .fee-table .el-input-number__inner,
        .fee-table .el-date-editor__inner,
        .fee-table .el-select__inner,
        .parking-detail-cell .el-input__inner,
        .parking-detail-cell .el-input-number__inner,
        .parking-detail-cell .el-date-editor__inner,
        .parking-detail-cell .el-select__inner,
        .fee-table td .el-input__inner,
        .fee-table td .el-input-number__inner,
        .fee-table td .el-date-editor__inner,
        .fee-table td .el-select__inner,
        .parking-detail-cell .el-input__inner,
        .parking-detail-cell .el-input-number__inner,
        .parking-detail-cell .el-date-editor__inner,
        .parking-detail-cell .el-select__inner {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input__inner:hover,
        .fee-table .el-input-number__inner:hover,
        .fee-table .el-date-editor__inner:hover,
        .fee-table .el-select__inner:hover,
        .parking-detail-cell .el-input__inner:hover,
        .parking-detail-cell .el-input-number__inner:hover,
        .parking-detail-cell .el-date-editor__inner:hover,
        .parking-detail-cell .el-select__inner:hover,
        .fee-table td .el-input__inner:hover,
        .fee-table td .el-input-number__inner:hover,
        .fee-table td .el-date-editor__inner:hover,
        .fee-table td .el-select__inner:hover,
        .parking-detail-cell .el-input__inner:hover,
        .parking-detail-cell .el-input-number__inner:hover,
        .parking-detail-cell .el-date-editor__inner:hover,
        .parking-detail-cell .el-select__inner:hover {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* 覆盖全局的form-control悬浮效果 */
        .fee-table .form-control,
        .parking-detail-cell .form-control,
        .fee-table td .form-control,
        .parking-detail-cell .form-control {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .form-control:hover,
        .parking-detail-cell .form-control:hover,
        .fee-table td .form-control:hover,
        .parking-detail-cell .form-control:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .form-control:focus-within,
        .parking-detail-cell .form-control:focus-within,
        .fee-table td .form-control:focus-within,
        .parking-detail-cell .form-control:focus-within {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-input悬浮效果 */
        .fee-table .el-input,
        .parking-detail-cell .el-input,
        .fee-table td .el-input,
        .parking-detail-cell .el-input {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-input:hover,
        .parking-detail-cell .el-input:hover,
        .fee-table td .el-input:hover,
        .parking-detail-cell .el-input:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-input.is-focus,
        .parking-detail-cell .el-input.is-focus,
        .fee-table td .el-input.is-focus,
        .parking-detail-cell .el-input.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-input-wrapper悬浮效果 */
        .fee-table .el-input__wrapper,
        .parking-detail-cell .el-input__wrapper,
        .fee-table td .el-input__wrapper,
        .parking-detail-cell .el-input__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover,
        .fee-table td .el-input__wrapper:hover,
        .parking-detail-cell .el-input__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-input-number悬浮效果 */
        .fee-table .el-input-number,
        .parking-detail-cell .el-input-number,
        .fee-table td .el-input-number,
        .parking-detail-cell .el-input-number {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-input-number:hover,
        .parking-detail-cell .el-input-number:hover,
        .fee-table td .el-input-number:hover,
        .parking-detail-cell .el-input-number:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-input-number.is-focus,
        .parking-detail-cell .el-input-number.is-focus,
        .fee-table td .el-input-number.is-focus,
        .parking-detail-cell .el-input-number.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-input-number-wrapper悬浮效果 */
        .fee-table .el-input-number__wrapper,
        .parking-detail-cell .el-input-number__wrapper,
        .fee-table td .el-input-number__wrapper,
        .parking-detail-cell .el-input-number__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover,
        .fee-table td .el-input-number__wrapper:hover,
        .parking-detail-cell .el-input-number__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-date-picker悬浮效果 */
        .fee-table .el-date-picker,
        .parking-detail-cell .el-date-picker,
        .fee-table td .el-date-picker,
        .parking-detail-cell .el-date-picker {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-date-picker:hover,
        .parking-detail-cell .el-date-picker:hover,
        .fee-table td .el-date-picker:hover,
        .parking-detail-cell .el-date-picker:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-date-picker.is-focus,
        .parking-detail-cell .el-date-picker.is-focus,
        .fee-table td .el-date-picker.is-focus,
        .parking-detail-cell .el-date-picker.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-date-editor-wrapper悬浮效果 */
        .fee-table .el-date-editor__wrapper,
        .parking-detail-cell .el-date-editor__wrapper,
        .fee-table td .el-date-editor__wrapper,
        .parking-detail-cell .el-date-editor__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover,
        .fee-table td .el-date-editor__wrapper:hover,
        .parking-detail-cell .el-date-editor__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-select悬浮效果 */
        .fee-table .el-select,
        .parking-detail-cell .el-select,
        .fee-table td .el-select,
        .parking-detail-cell .el-select {
            transition: none !important;
            transform: none !important;
        }
        
        .fee-table .el-select:hover,
        .parking-detail-cell .el-select:hover,
        .fee-table td .el-select:hover,
        .parking-detail-cell .el-select:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-select.is-focus,
        .parking-detail-cell .el-select.is-focus,
        .fee-table td .el-select.is-focus,
        .parking-detail-cell .el-select.is-focus {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖全局的el-select-wrapper悬浮效果 */
        .fee-table .el-select__wrapper,
        .parking-detail-cell .el-select__wrapper,
        .fee-table td .el-select__wrapper,
        .parking-detail-cell .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-select__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover,
        .fee-table td .el-select__wrapper:hover,
        .parking-detail-cell .el-select__wrapper:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖Element Plus全局输入框样式 - 最强优先级 */
        .fee-table .el-input .el-input__wrapper,
        .fee-table .el-input-number .el-input-number__wrapper,
        .fee-table .el-date-picker .el-input__wrapper,
        .fee-table .el-select .el-select__wrapper,
        .parking-detail-cell .el-input .el-input__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-detail-cell .el-select .el-select__wrapper,
        .fee-table td .el-input .el-input__wrapper,
        .fee-table td .el-input-number .el-input-number__wrapper,
        .fee-table td .el-date-picker .el-input__wrapper,
        .fee-table td .el-select .el-select__wrapper,
        .parking-detail-cell .el-input .el-input__wrapper,
        .parking-detail-cell .el-input-number .el-input-number__wrapper,
        .parking-detail-cell .el-select .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input:hover .el-input__wrapper,
        .fee-table .el-input-number:hover .el-input-number__wrapper,
        .fee-table .el-date-picker:hover .el-input__wrapper,
        .fee-table .el-select:hover .el-select__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-select:hover .el-select__wrapper,
        .fee-table td .el-input:hover .el-input__wrapper,
        .fee-table td .el-input-number:hover .el-input-number__wrapper,
        .fee-table td .el-date-picker:hover .el-input__wrapper,
        .fee-table td .el-select:hover .el-select__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-select:hover .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input.is-focus .el-input__wrapper,
        .fee-table .el-input-number.is-focus .el-input-number__wrapper,
        .fee-table .el-date-picker.is-focus .el-input__wrapper,
        .fee-table .el-select.is-focus .el-select__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-select.is-focus .el-select__wrapper,
        .fee-table td .el-input.is-focus .el-input__wrapper,
        .fee-table td .el-input-number.is-focus .el-input-number__wrapper,
        .fee-table td .el-date-picker.is-focus .el-input__wrapper,
        .fee-table td .el-select.is-focus .el-select__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-select.is-focus .el-select__wrapper {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* 覆盖Element Plus全局输入框样式 - 针对inner元素 */
        .fee-table .el-input .el-input__inner,
        .fee-table .el-input-number .el-input__inner,
        .fee-table .el-date-picker .el-input__inner,
        .fee-table .el-select .el-select__inner,
        .parking-detail-cell .el-input .el-input__inner,
        .parking-detail-cell .el-input-number .el-input__inner,
        .parking-detail-cell .el-select .el-select__inner,
        .fee-table td .el-input .el-input__inner,
        .fee-table td .el-input-number .el-input__inner,
        .fee-table td .el-date-picker .el-input__inner,
        .fee-table td .el-select .el-select__inner,
        .parking-detail-cell .el-input .el-input__inner,
        .parking-detail-cell .el-input-number .el-input__inner,
        .parking-detail-cell .el-select .el-select__inner {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        .fee-table .el-input:hover .el-input__inner,
        .fee-table .el-input-number:hover .el-input__inner,
        .fee-table .el-date-picker:hover .el-input__inner,
        .fee-table .el-select:hover .el-select__inner,
        .parking-detail-cell .el-input:hover .el-input__inner,
        .parking-detail-cell .el-input-number:hover .el-input__inner,
        .parking-detail-cell .el-select:hover .el-select__inner,
        .fee-table td .el-input:hover .el-input__inner,
        .fee-table td .el-input-number:hover .el-input__inner,
        .fee-table td .el-date-picker:hover .el-input__inner,
        .fee-table td .el-select:hover .el-select__inner,
        .parking-detail-cell .el-input:hover .el-input__inner,
        .parking-detail-cell .el-input-number:hover .el-input__inner,
        .parking-detail-cell .el-select:hover .el-select__inner {
            transition: none !important;
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
        }
        
        /* 覆盖所有可能的动态效果 - 最终保障 */
        .fee-table *,
        .parking-detail-cell *,
        .fee-table td *,
        .parking-detail-cell * {
            transition: none !important;
        }
        
        .fee-table *:hover,
        .parking-detail-cell *:hover,
        .fee-table td *:hover,
        .parking-detail-cell *:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 特别覆盖全局的 .el-input:hover .el-input__wrapper 样式 */
        .fee-table .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper,
        .fee-table td .el-input:hover .el-input__wrapper,
        .parking-detail-cell .el-input:hover .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 特别覆盖全局的 .form-control:hover 样式 */
        .fee-table .form-control:hover,
        .parking-detail-cell .form-control:hover,
        .fee-table td .form-control:hover,
        .parking-detail-cell .form-control:hover {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 特别覆盖全局的 .el-date-editor .el-input__inner:hover 样式 */
        .fee-table .el-date-editor .el-input__inner:hover,
        .parking-detail-cell .el-date-editor .el-input__inner:hover,
        .fee-table td .el-date-editor .el-input__inner:hover,
        .parking-detail-cell .el-date-editor .el-input__inner:hover {
            border-color: #dcdfe6 !important;
            transform: none !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖 el-select 的 hover 和 focus 效果 */
        .fee-table .el-select:hover .el-input__wrapper,
        .parking-detail-cell .el-select:hover .el-input__wrapper,
        .fee-table td .el-select:hover .el-input__wrapper,
        .parking-detail-cell .el-select:hover .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-select.is-focus .el-input__wrapper,
        .parking-detail-cell .el-select.is-focus .el-input__wrapper,
        .fee-table td .el-select.is-focus .el-input__wrapper,
        .parking-detail-cell .el-select.is-focus .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖 el-input 的 focus 效果 */
        .fee-table .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper,
        .fee-table td .el-input.is-focus .el-input__wrapper,
        .parking-detail-cell .el-input.is-focus .el-input__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖 el-date-editor 的 focus 效果 */
        .fee-table .el-date-editor .el-input__inner:focus,
        .parking-detail-cell .el-date-editor .el-input__inner:focus,
        .fee-table td .el-date-editor .el-input__inner:focus,
        .parking-detail-cell .el-date-editor .el-input__inner:focus {
            border-color: #dcdfe6 !important;
            transform: none !important;
            box-shadow: none !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 覆盖 el-input-number 的 hover 和 focus 效果 */
        .fee-table .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper,
        .fee-table td .el-input-number:hover .el-input-number__wrapper,
        .parking-detail-cell .el-input-number:hover .el-input-number__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        .fee-table .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper,
        .fee-table td .el-input-number.is-focus .el-input-number__wrapper,
        .parking-detail-cell .el-input-number.is-focus .el-input-number__wrapper {
            transform: none !important;
            box-shadow: none !important;
            border-color: #dcdfe6 !important;
            background-color: #ffffff !important;
            transition: none !important;
        }
        
        /* 汇总信息区块样式 */
        .summary-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        /* 操作栏位按钮样式 */
        .action-buttons-cell {
            display: flex;
            gap: 5px;
            justify-content: center;
            align-items: center;
        }
        
        .action-buttons-cell .el-button {
            margin: 0 !important;
            padding: 5px 8px;
            font-size: 12px;
        }

        /* 日期选择器样式美化 - 现代化风格 */
        .el-date-editor.el-input {
            width: 240px !important;
            position: relative;
        }
        
        .el-date-editor .el-input__inner {
            border-radius: 10px;
            border: 2px solid #e4e7ed;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            padding-left: 40px;
            height: 40px;
            font-size: 14px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
        }
        
        .el-date-editor .el-input__inner:hover {
            border-color: #409eff;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
        }
        
        .el-date-editor .el-input__inner:focus {
            border-color: #409eff;
            box-shadow: 0 0 0 3px rgba(64, 158, 255, 0.15);
            transform: translateY(-1px);
        }
        
        .el-date-editor .el-input__prefix {
            color: #409eff;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .el-date-editor .el-input__prefix .el-input__icon {
            font-size: 16px;
        }
        
        /* 日期选择面板美化 */
        .el-picker-panel {
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            border: 1px solid #e4e7ed;
            overflow: hidden;
        }
        
        .el-picker-panel__body-wrapper {
            background: #ffffff;
        }
        
        .el-picker-panel__header {
            background: linear-gradient(135deg, #409eff 0%, #66b1ff 100%);
            color: white;
            padding: 12px;
            border-bottom: none;
        }
        
        .el-picker-panel__header .el-picker-panel__icon-btn {
            color: white;
            font-size: 16px;
        }
        
        .el-picker-panel__header .el-picker-panel__link-btn {
            color: white;
            font-weight: 500;
        }
        
        .el-date-table th {
            background: #f5f7fa;
            color: #606266;
            font-weight: 600;
            padding: 8px;
            border-bottom: 1px solid #ebeef5;
        }
        
        .el-date-table td.today .el-date-table-cell__text {
            background: #ecf5ff;
            color: #409eff;
            font-weight: 600;
            border-radius: 4px;
        }
        
        .el-date-table td.current:not(.disabled) .el-date-table-cell__text {
            background: #409eff;
            color: white;
            font-weight: 600;
            border-radius: 4px;
        }
        
        .el-date-table td.available:hover .el-date-table-cell__text {
            background: #f0f9ff;
            color: #409eff;
            border-radius: 4px;
        }
        
        /* 时间选择面板美化 */
        .el-time-panel {
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }
        
        .el-time-panel__header {
            background: linear-gradient(135deg, #409eff 0%, #66b1ff 100%);
            color: white;
        }
        
        .el-time-spinner__item:hover:not(.disabled):not(.active) {
            background: #f0f9ff;
            color: #409eff;
        }
        
        .el-time-spinner__item.active:not(.disabled) {
            background: #409eff;
            color: white;
            font-weight: 600;
        }

        /* 现代化日期控件样式 - 方框形状，与其他控件保持一致 */
        .modern-date-picker {
            position: relative;
            background: #ffffff;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            box-shadow: 0 0 0 0;
            transition: all 0.3s ease;
            overflow: visible;
            z-index: 1;
            height: 36px;
            width: 180px;
        }

        .modern-date-picker:hover {
            border-color: #c0c4cc;
        }

        .modern-date-picker:focus-within {
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        .modern-date-picker::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.5) 20%, 
                rgba(255, 255, 255, 0.5) 80%, 
                transparent);
            z-index: 1;
        }

        .modern-date-picker:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(64, 158, 255, 0.3);
        }

        .modern-date-picker:focus-within {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1);
            border-color: rgba(64, 158, 255, 0.4);
        }

        /* 统一表单控件悬浮效果 */
        .form-control {
            position: relative;
            background: #ffffff;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            box-shadow: 0 0 0 0;
            transition: all 0.3s ease;
            overflow: visible;
            z-index: 1;
        }

        .form-control::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.5) 20%, 
                rgba(255, 255, 255, 0.5) 80%, 
                transparent);
            z-index: 1;
        }

        .form-control:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15);
            border-color: rgba(64, 158, 255, 0.3);
        }

        .form-control:focus-within {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1);
            border-color: rgba(64, 158, 255, 0.4);
        }

        /* Element Plus 控件样式调整 */
        .el-select .el-input__wrapper {
            border-radius: 4px !important;
            transition: all 0.3s ease !important;
        }

        .el-select:hover .el-input__wrapper {
            transform: translateY(-3px) scale(1.02) !important;
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15) !important;
            border-color: rgba(64, 158, 255, 0.3) !important;
        }

        .el-select.is-focus .el-input__wrapper {
            transform: translateY(-2px) scale(1.01) !important;
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1) !important;
            border-color: rgba(64, 158, 255, 0.4) !important;
        }

        .el-input .el-input__wrapper {
            border-radius: 4px !important;
            transition: all 0.3s ease !important;
        }

        .el-input:hover .el-input__wrapper {
            transform: translateY(-3px) scale(1.02) !important;
            box-shadow: 
                0 12px 40px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.5),
                inset 0 -1px 0 rgba(255, 255, 255, 0.15) !important;
            border-color: rgba(64, 158, 255, 0.3) !important;
        }

        .el-input.is-focus .el-input__wrapper {
            transform: translateY(-2px) scale(1.01) !important;
            box-shadow: 
                0 10px 35px rgba(64, 158, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                inset 0 -1px 0 rgba(255, 255, 255, 0.2),
                0 0 0 3px rgba(64, 158, 255, 0.1) !important;
            border-color: rgba(64, 158, 255, 0.4) !important;
        }

        .modern-date-picker input {
            background: transparent;
            border: none;
            outline: none;
            width: 100%;
            height: 100%;
            padding: 0 15px;
            font-size: 14px;
            color: #303133;
            font-weight: 500;
            position: relative;
            z-index: 2;
        }

        .modern-date-picker input::placeholder {
            color: rgba(48, 49, 51, 0.6);
            font-weight: 400;
        }

        .modern-date-picker .date-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #409eff;
            font-size: 16px;
            z-index: 2;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .modern-date-picker:hover .date-icon {
            color: #66b1ff;
            transform: translateY(-50%) scale(1.1);
        }

        /* 日历控件样式 */
        .datetime-picker-container {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .datetime-picker-input {
            width: 100%;
            height: 40px;
            padding: 0 10px;
            border: 1px solid #e6e6e6;
            border-radius: 4px;
            background-color: #fff;
            cursor: pointer;
            box-sizing: border-box;
        }
        
        .datetime-picker-input:focus {
            border-color: #409eff;
            outline: none;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }
        
        .datetime-picker-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #c0c4cc;
            pointer-events: none;
        }

        /* Flatpickr 现代化主题覆盖 */
        .flatpickr-calendar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 
                0 20px 60px rgba(31, 38, 135, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: visible;
            animation: slideUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 999999 !important;
            position: absolute !important;
            margin-top: 5px !important;
            width: 300px !important;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .flatpickr-calendar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(64, 158, 255, 0.6) 20%, 
                rgba(64, 158, 255, 0.6) 80%, 
                transparent);
            z-index: 1;
        }

        .flatpickr-month {
            background: linear-gradient(135deg, rgba(64, 158, 255, 0.1) 0%, rgba(102, 177, 255, 0.1) 100%);
            color: #303133;
            font-weight: 600;
            padding: 12px 10px;
            border-radius: 20px 20px 0 0;
            border-bottom: 1px solid rgba(64, 158, 255, 0.1);
            position: relative;
            z-index: 100;
            overflow: visible;
            min-height: 45px;
            height: auto;
        }

        .flatpickr-month .flatpickr-prev-month,
        .flatpickr-month .flatpickr-next-month {
            color: #409eff;
            fill: #409eff;
            transition: all 0.3s ease;
            position: relative;
            z-index: 101;
        }

        .flatpickr-month .flatpickr-prev-month:hover,
        .flatpickr-month .flatpickr-next-month:hover {
            color: #66b1ff;
            fill: #66b1ff;
            transform: scale(1.2);
        }

        .flatpickr-current-month {
            font-weight: 700;
            color: #303133;
            position: relative;
            z-index: 100;
        }

        .flatpickr-weekdays {
            background: rgba(64, 158, 255, 0.05);
            border-bottom: 1px solid rgba(64, 158, 255, 0.1);
        }

        .flatpickr-weekday {
            color: #606266;
            font-weight: 600;
            font-size: 12px;
        }

        .flatpickr-day {
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: 500;
        }

        .flatpickr-day:hover {
            background: rgba(64, 158, 255, 0.1);
            color: #409eff;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.2);
        }

        .flatpickr-day.today {
            border-color: #409eff;
            background: rgba(64, 158, 255, 0.15);
            color: #409eff;
            font-weight: 700;
        }

        .flatpickr-day.selected {
            background: linear-gradient(135deg, #409eff 0%, #66b1ff 100%);
            color: white;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(64, 158, 255, 0.4);
            transform: scale(1.05);
        }

        .flatpickr-time {
            border-top: 1px solid rgba(64, 158, 255, 0.1);
            background: rgba(64, 158, 255, 0.05);
            border-radius: 0 0 20px 20px;
        }

        .flatpickr-time .numInputWrapper {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            border: 1px solid rgba(64, 158, 255, 0.2);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .flatpickr-time .numInputWrapper:hover {
            border-color: rgba(64, 158, 255, 0.4);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.15);
        }

        .flatpickr-time .numInputWrapper:focus {
            border-color: #409eff;
            box-shadow: 0 0 0 3px rgba(64, 158, 255, 0.1);
        }

        /* 收款方式行样式 - 恢复原来大小 */
        .payment-method-row {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .payment-label-container {
            min-width: 80px;
        }

        .payment-label {
            font-weight: 500;
            color: #606266;
            font-size: 14px;
        }

        .payment-options-container {
            flex: 1;
        }

        .payment-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .payment-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 120px;
            height: 100px;
            border: 2px solid #e4e7ed;
            border-radius: 8px;
            padding: 15px 10px;
            background-color: #fff;
            transition: all 0.3s ease;
            position: relative;
        }

        .payment-option:hover {
            border-color: #409eff;
            box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .payment-option.selected {
            border-color: #409eff;
            background-color: #ecf5ff;
            box-shadow: 0 2px 12px 0 rgba(64, 158, 255, 0.2);
        }

        .payment-icon {
            font-size: 45px;
            margin-bottom: 8px;
        }

        .wechat-icon {
            color: #07c160; /* 微信绿色 */
        }

        .alipay-icon {
            color: #1677ff; /* 支付宝蓝色 */
        }

        .cash-icon {
            color: #f56c6c; /* 现金红色 */
        }

        .payment-text {
            font-size: 14px;
            font-weight: 500;
            color: #606266;
        }

        .payment-check {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background-color: #409eff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        /* 备注文本框左对齐 */
        .summary-row .el-textarea__inner {
            text-align: left;
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
            min-height: 80px;
        }

        /* 总计金额样式 */
        .total-amount {
            font-size: 20px;
            font-weight: bold;
            color: #303133;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid #e8e8e8;
        }

        /* 今日收费记录表格样式 */
        .recent-records-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .today-total {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            font-family: 'Microsoft YaHei', 'Arial', sans-serif;
        }

        .today-total .amount {
            font-size: 24px;
            margin-left: 10px;
            color: #ffd700;
            font-weight: bold;
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        /* 表格容器样式 - 添加横向滚动 */
        .recent-records-table-container {
            overflow-x: auto;
            margin-top: 15px;
            border-radius: 4px;
            border: 1px solid #e4e7ed;
        }

        .recent-records-table {
            width: auto;
            border-collapse: collapse;
            table-layout: auto;
            font-size: 13px;
            min-width: 100%;
        }

        .recent-records-table th {
            background-color: #f5f7fa;
            color: #606266;
            font-weight: 500;
            text-align: center;
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            white-space: nowrap;
        }

        .recent-records-table td {
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
        }

        /* 备注栏位允许换行 */
        .recent-records-table th:nth-child(8),
        .recent-records-table td:nth-child(8) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 150px;
            max-width: 200px;
            text-align: left;  /* 添加左对齐 */
        }

        /* 收费项目栏位允许换行 */
        .recent-records-table th:nth-child(6),
        .recent-records-table td:nth-child(6) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 300px;
            max-width: 500px;
            text-align: left;
        }

        .recent-records-table .fee-items-cell {
            text-align: left;
            padding: 5px 15px;
            line-height: 1.5;
        }

        .recent-records-table .fee-items-cell div {
            margin-bottom: 3px;
        }

        .recent-records-table tr:hover {
            background-color: #f5f7fa;
        }

        .recent-records-table .action-buttons-cell {
            display: flex;
            gap: 5px;
            justify-content: center;
            white-space: nowrap;
        }
        
        /* 重打小票按钮 */
        .reprint-button {
            margin-left: 5px;
        }

        /* 打印样式 */
        @media print {
            /* 隐藏所有内容 */
            body * {
                visibility: hidden;
            }
            /* 只显示打印区域 */
            #print-receipt, #print-receipt * {
                visibility: visible;
            }
            /* 打印区域样式 - 自适应纸张尺寸 */
            #print-receipt {
                position: fixed !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                height: 100vh !important;
                max-width: 100% !important;
                max-height: 100vh !important;
                padding: 10mm !important;
                margin: 0 !important;
                font-family: '宋体', 'SimSun', sans-serif !important;
                font-size: 12px !important;
                overflow: hidden !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                z-index: 9999 !important;
                box-sizing: border-box !important;
                display: flex !important;
                align-items: flex-start !important;
                justify-content: center !important;
            }
            
            /* 小票内容容器 - 居中显示且自适应 */
            #print-receipt .receipt-content {
                width: auto !important;
                max-width: 72mm !important;
                min-width: 60mm !important;
                height: auto !important;
                max-height: calc(100vh - 20mm) !important;
                margin: 0 auto !important;
                padding: 3mm !important;
                box-sizing: border-box !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                overflow: hidden !important;
                background: white !important;
                border: 1px solid #ddd !important;
                font-size: 18px !important;
                font-weight: bold !important;
                line-height: 1.6 !important;
            }
            
            /* 强制设置页面尺寸为单页 */
            @page {
                size: auto !important;
                margin: 0mm !important;
                padding: 0 !important;
                marks: none !important;
                bleed: 0 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                /* 强制单页打印 */
                overflow: hidden !important;
                /* 防止浏览器自动缩放 */
                zoom: 1 !important;
                transform-origin: top left !important;
            }
            
            /* 防止任何元素分页 */
            #print-receipt,
            #print-receipt *,
            #print-receipt .receipt-content,
            #print-receipt .receipt-content * {
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                orphans: 1 !important;
                widows: 1 !important;
            }
            
            /* 确保HTML和BODY不会影响打印 */
            html, body {
                margin: 0 !important;
                padding: 0 !important;
                visibility: hidden !important;
                background: transparent !important;
                overflow: hidden !important;
                height: 100vh !important;
                width: 100% !important;
            }
            
            /* 小票内容样式优化 */
            #print-receipt .receipt-header {
                text-align: center !important;
                margin-bottom: 10px !important;
                padding-bottom: 5px !important;
                border-bottom: 1px dashed #000 !important;
            }
            
            #print-receipt .receipt-header h2 {
                font-size: 26px !important;
                margin: 3px 0 !important;
                font-weight: bold !important;
            }
            
            #print-receipt .receipt-info {
                margin-bottom: 8px !important;
                line-height: 1.5 !important;
                font-size: 18px !important;
                font-weight: bold !important;
            }
            
            /* 日期时间不换行 */
            #print-receipt .receipt-info .date-time,
            #print-receipt .receipt-footer .date-time {
                white-space: nowrap !important;
            }
            
            /* 谢谢光临居中不换行 */
            #print-receipt .receipt-footer .thank-you {
                white-space: nowrap !important;
                text-align: center !important;
                font-size: 18px !important;
            }
            
            #print-receipt .receipt-items {
                margin: 10px 0 !important;
                border-top: 1px dashed #000 !important;
                border-bottom: 1px dashed #000 !important;
                padding: 8px 0 !important;
                font-size: 18px !important;
                font-weight: bold !important;
                white-space: normal !important;
                word-wrap: break-word !important;
                word-break: break-all !important;
            }
            
            #print-receipt .receipt-total {
                text-align: right !important;
                font-weight: bold !important;
                font-size: 22px !important;
                margin-top: 8px !important;
                padding-top: 8px !important;
                border-top: 1px solid #000 !important;
            }
            
            #print-receipt .receipt-footer {
                text-align: center !important;
                margin-top: 8px !important;
                padding-top: 5px !important;
                border-top: 1px dashed #000 !important;
                font-size: 16px !important;
                font-weight: bold !important;
                color: #333 !important;
                white-space: normal !important;
                word-wrap: break-word !important;
            }
            
            /* 文本换行但保持可读性 */
            #print-receipt .receipt-content > div {
                white-space: normal !important;
                overflow: visible !important;
                text-overflow: clip !important;
                word-wrap: break-word !important;
            }
            
            /* 允许收费项目换行 */
            #print-receipt .receipt-items div {
                white-space: normal !important;
                word-wrap: break-word !important;
                word-break: break-all !important;
                line-height: 1.4 !important;
            }
        }

        .receipt-content {
            max-width: 72mm;
            font-family: '宋体', 'SimSun', sans-serif;
            font-size: 18px;
            font-weight: bold;
            padding: 3mm;
            margin: 0;
            border: 1px dashed #ddd;
            background-color: white;
            box-sizing: border-box;
            page-break-inside: avoid;
            word-wrap: break-word;
        }
        
        /* 日期时间不换行 */
        .receipt-info .date-time,
        .receipt-footer .date-time {
            white-space: nowrap;
        }
        
        /* 谢谢光临居中不换行 */
        .receipt-footer .thank-you {
            white-space: nowrap;
            text-align: center;
            font-size: 18px;
        }

        .receipt-header {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #000;
        }

        .receipt-header h2 {
            font-size: 26px;
            margin: 5px 0;
            font-weight: bold;
        }

        .receipt-info {
            margin-bottom: 10px;
            line-height: 1.6;
            font-weight: bold;
            word-wrap: break-word;
        }

        .receipt-info .label {
            font-weight: bold;
            margin-right: 5px;
        }

        .receipt-items {
            margin: 15px 0;
            border-top: 1px dashed #000;
            border-bottom: 1px dashed #000;
            padding: 10px 0;
            font-weight: bold;
            word-wrap: break-word;
            word-break: break-all;
        }

        .receipt-total {
            text-align: right;
            font-weight: bold;
            font-size: 22px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 2px solid #000;
        }

        .receipt-footer {
            text-align: center;
            margin-top: 10px;
            padding-top: 5px;
            border-top: 1px dashed #000;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            page-break-after: avoid;
            page-break-inside: avoid;
            word-wrap: break-word;
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .payment-options {
                justify-content: flex-start;
            }
            
            .payment-option {
                width: 100px;
                height: 90px;
            }
            
            .payment-icon {
                font-size: 30px;
            }
            
            .summary-row {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .summary-row .el-textarea {
                width: 100%;
                max-width: 100% !important;
            }
            
            .parking-fields {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .parking-field {
                width: 100%;
            }
            
            .parking-input {
                width: 100%;
            }
            
            .parking-input .el-input__inner,
            .parking-input .el-input-number__inner {
                font-size: 14px;
                padding: 10px;
            }
            
            .recent-records-table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
            
            .fee-buttons {
                justify-content: flex-start;
            }
        }
        
        /* 用户历史缴费记录样式 */
        .user-history-section {
            margin-top: 15px;
            border: 1px solid #e4e7ed;
            border-radius: 8px;
            overflow: hidden;
            clear: both; /* 确保区块另起一行 */
            width: 100%; /* 确保占满宽度 */
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background-color: #f5f7fa;
            cursor: pointer;
            user-select: none;
            transition: background-color 0.3s;
        }
        
        .history-header:hover {
            background-color: #edf2fc;
        }
        
        .history-title {
            font-weight: 500;
            color: #303133;
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        
        .collapse-icon {
            margin-right: 8px;
            color: #409eff;
            transition: transform 0.3s ease;
            font-size: 22px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            text-align: center;
            line-height: 1;
        }
        
        .history-header:hover .collapse-icon {
            transform: scale(1.1);
        }
        
        .history-toggle-icon {
            color: #909399;
            transition: transform 0.3s;
        }
        
        .history-content {
            padding: 0;
            background-color: #fff;
        }
        
        .user-history-table {
            width: auto;
            border-collapse: collapse;
            table-layout: auto;
            font-size: 13px;
            min-width: 100%;
        }
        
        .user-history-table th {
            background-color: #f5f7fa;
            color: #606266;
            font-weight: 500;
            text-align: center;
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            white-space: nowrap;
        }
        
        .user-history-table td {
            padding: 8px 15px;
            border: 1px solid #e4e7ed;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
        }
        
        /* 备注栏位允许换行 */
        .user-history-table th:nth-child(7),
        .user-history-table td:nth-child(7) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 150px;
            max-width: 200px;
        }
        
        /* 收费项目栏位允许换行 */
        .user-history-table th:nth-child(4),
        .user-history-table td:nth-child(4) {
            white-space: normal;
            word-wrap: break-word;
            word-break: break-all;
            min-width: 300px;
            max-width: 500px;
            text-align: left;
        }
        
        .user-history-table .fee-items-cell {
            text-align: left;
            padding: 5px 15px;
            line-height: 1.5;
        }
        
        .user-history-table .fee-items-cell div {
            margin-bottom: 3px;
        }
        
        .user-history-table tr:hover {
            background-color: #f5f7fa;
        }
        
        /* 历史缴费记录表格容器样式 - 添加横向滚动 */
        .user-history-table-container {
            overflow-x: auto;
            border-radius: 4px;
            border: 1px solid #e4e7ed;
        }
        
        .history-loading, .history-empty {
            text-align: center;
            padding: 20px;
            color: #909399;
            font-size: 14px;
        }

        /* 订单查询页面样式 */
        .order-query-container {
            padding: 24px;
            background-color: #fff;
            min-height: calc(100vh - 120px);
        }

        /* 筛选条件区域 */
        .filter-section {
            background-color: #F5F7FA;
            border: 1px solid #E5E6EB;
            border-top: none;
            border-bottom: none;
            padding: 16px 24px;
            margin: 0 -24px 16px -24px;
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: flex-start;
        }

        .filter-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            min-width: 280px;
        }

        .filter-label {
            width: 80px;
            font-size: 14px;
            color: #606266;
            line-height: 32px;
            flex-shrink: 0;
        }

        /* 日期范围选择器 */
        .date-range-picker {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 320px;
        }

        .date-input-group {
            display: flex;
            flex-direction: column;
            gap: 4px;
            flex: 1;
        }

        .date-input-group label {
            font-size: 12px;
            color: #909399;
            line-height: 1;
        }

        .datetime-input {
            width: 100%;
            height: 32px;
            padding: 0 8px;
            border: 1px solid #DCDFE6;
            border-radius: 4px;
            font-size: 14px;
            color: #606266;
            background-color: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }

        .datetime-input:hover {
            border-color: #C0C4CC;
        }

        .datetime-input:focus {
            border-color: #409EFF;
            outline: none;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        .datetime-input.error {
            border-color: #F56C6C;
        }

        .date-separator {
            color: #909399;
            font-size: 14px;
            line-height: 32px;
            margin: 0 4px;
        }

        /* 地址选择器 */
        .address-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            width: auto;
            min-width: 360px;
        }

        /* 筛选操作按钮 */
        .filter-actions {
            display: flex;
            gap: 8px;
        }

        /* 错误提示 */
        .error-message {
            color: #F56C6C;
            font-size: 12px;
            line-height: 1;
            margin-top: 4px;
            flex: 1;
        }

        /* 数据统计区域 */
        .statistics-section {
            background-color: #F8F9FA;
            border: 1px solid #E5E6EB;
            border-radius: 4px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .statistics-info {
            font-size: 14px;
            color: #606266;
            text-align: center;
        }

        .highlight {
            color: #409EFF;
            font-weight: bold;
        }

        /* 结果展示区域 */
        .results-section {
            min-height: 400px;
        }

        /* 加载状态样式 */
        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 400px;
            position: relative;
        }

        .loading-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            z-index: 1;
        }

        .custom-loading {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #409EFF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 14px;
            color: #606266;
            font-weight: 500;
        }

        /* 按钮加载状态 */
        .el-button.is-loading {
            position: relative;
            pointer-events: none;
        }

        .el-button.is-loading::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            margin: -8px 0 0 -8px;
            border: 2px solid #ffffff;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: button-spin 0.8s linear infinite;
        }

        @keyframes button-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 表格行悬停效果 */
        .orders-table tbody tr {
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .orders-table tbody tr:hover {
            background-color: #F0F9FF !important;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        /* 表格排序图标动画 */
        .orders-table th.sortable i {
            transition: all 0.2s ease;
            margin-left: 4px;
            font-size: 12px;
            opacity: 0.6;
        }

        .orders-table th.sortable:hover i {
            opacity: 1;
            transform: scale(1.1);
        }

        /* 筛选条件输入框聚焦效果 */
        .datetime-input:focus,
        .el-select .el-input__inner:focus {
            border-color: #409EFF;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.1);
            transition: all 0.2s ease;
        }

        /* 查询按钮悬停效果 */
        .filter-actions .el-button {
            transition: all 0.2s ease;
        }

        .filter-actions .el-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(64, 158, 255, 0.3);
        }

        /* 数据统计区域动画 */
        .statistics-section {
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 表格容器入场动画 */
        .table-container {
            animation: fadeInUp 0.4s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 表格样式 */
        .table-container {
            background-color: #fff;
            border: 1px solid #E5E6EB;
            border-radius: 4px;
            overflow: hidden;
        }

        .orders-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .orders-table th {
            background-color: #F5F7FA;
            color: #5E6C84;
            font-weight: 500;
            text-align: left;
            padding: 16px;
            border-bottom: 1px solid #E5E6EB;
            white-space: nowrap;
        }

        .orders-table th.sortable {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }

        .orders-table th.sortable:hover {
            background-color: #EBECF0;
        }

        .orders-table td {
            padding: 16px;
            border-bottom: 1px solid #E5E6EB;
            line-height: 1.5;
        }

        .orders-table tr:last-child td {
            border-bottom: none;
        }

        .orders-table .odd-row {
            background-color: #FFFFFF;
        }

        .orders-table .even-row {
            background-color: #F9FAFB;
        }

        /* 表格单元格样式 */
        .order-id {
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .order-id span {
            cursor: pointer;
            color: #409EFF;
            transition: color 0.2s;
        }

        .order-id span:hover {
            color: #096DD9;
            text-decoration: underline;
        }

        .copy-icon {
            margin-left: 4px;
            font-size: 12px;
            opacity: 0.6;
        }

        .customer-info {
            min-width: 120px;
        }

        .customer-name {
            font-weight: 500;
            margin-bottom: 2px;
        }

        .customer-phone {
            font-size: 12px;
            color: #909399;
        }

        .address {
            white-space: nowrap;
        }

        .fee-items {
            max-width: 200px;
            font-size: 13px;
            line-height: 1.4;
        }

        .fee-item {
            margin-bottom: 2px;
        }

        .amount {
            text-align: right;
            font-weight: 500;
            font-family: 'Courier New', monospace;
        }

        .status-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-align: center;
            min-width: 60px;
        }

        .status-tag.success {
            background-color: #F0F9FF;
            color: #1890FF;
            border: 1px solid #B3D8FF;
        }

        .date {
            white-space: nowrap;
            font-size: 13px;
        }

        .actions {
            text-align: center;
        }

        /* 空状态和初始状态优化 */
        .empty-data, .initial-state {
            text-align: center;
            padding: 60px 20px;
            color: #909399;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .empty-data i, .initial-state i {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.8; }
        }

        /* 分页组件样式优化 */
        .pagination-section .el-pagination {
            padding: 16px;
            background: #F8F9FA;
            border-radius: 4px;
            border: 1px solid #E5E6EB;
        }

        .pagination-section .el-pagination .btn-prev,
        .pagination-section .el-pagination .btn-next {
            transition: all 0.2s ease;
        }

        .pagination-section .el-pagination .btn-prev:hover,
        .pagination-section .el-pagination .btn-next:hover {
            transform: scale(1.05);
        }

        /* 复制成功提示 */
        .copy-success-tooltip {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            z-index: 9999;
            animation: tooltipFade 2s ease-out forwards;
        }

        @keyframes tooltipFade {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
        }

        /* 错误状态优化 */
        .error-message {
            color: #F56C6C;
            font-size: 12px;
            line-height: 1;
            margin-top: 4px;
            flex: 1;
            animation: shake 0.3s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        /* 日期输入错误状态 */
        .datetime-input.error {
            border-color: #F56C6C;
            animation: inputError 0.3s ease-in-out;
        }

        @keyframes inputError {
            0%, 100% { box-shadow: none; }
            50% { box-shadow: 0 0 0 2px rgba(245, 108, 108, 0.2); }
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .order-query-container {
                padding: 16px;
            }

            .filter-section {
                flex-direction: column;
                margin: 0 -16px 16px -16px;
                padding: 16px;
            }

            .filter-item {
                width: 100%;
                min-width: auto;
                flex-direction: column;
                align-items: stretch;
            }

            .filter-label {
                width: auto;
                line-height: 1;
                margin-bottom: 8px;
            }

            .date-range-picker {
                width: 100%;
                flex-direction: column;
            }

            .date-separator {
                display: none;
            }

            .address-selector {
                width: 100%;
                flex-direction: column;
            }

            .address-row {
                flex-direction: column;
                gap: 15px;
            }

            .address-field {
                min-width: auto;
                width: 100%;
            }

            .address-selector .el-select {
                width: 100% !important;
            }

            .filter-actions {
                justify-content: center;
            }

            .table-container {
                overflow-x: auto;
            }

            .orders-table {
                min-width: 800px;
            }
        }

        @media (min-width: 769px) and (max-width: 1199px) {
            .date-range-picker {
                width: 280px;
            }

            .address-selector {
                width: 320px;
            }
        }

        /* 打印样式修复 */
        @media print {
            /* 隐藏所有内容 */
            body * {
                visibility: hidden !important;
            }
            /* 只显示打印区域 */
            #print-receipt, #print-receipt * {
                visibility: visible !important;
            }
            /* 打印区域样式 */
            #print-receipt {
                position: absolute !important;
                left: 0 !important;
                top: 0 !important;
                width: 72mm !important;
                min-height: auto !important;
                max-height: 100vh !important;
                padding: 0 !important;
                margin: 0 !important;
                font-family: '宋体', 'SimSun', sans-serif !important;
                font-size: 18px !important;
                font-weight: bold !important;
                overflow: visible !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                z-index: 9999 !important;
                transform-origin: top left !important;
            }
            
            /* 确保小票内容也是72mm宽度 */
            #print-receipt .receipt-content {
                width: 72mm !important;
                min-width: 72mm !important;
                max-width: 72mm !important;
                margin: 0 !important;
                padding: 2mm !important;
                box-sizing: border-box !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                overflow: visible !important;
                font-size: 18px !important;
                font-weight: bold !important;
                word-wrap: break-word !important;
                word-break: break-all !important;
            }
            
            /* 强制设置页面尺寸和边距 */
            @page {
                size: auto !important;
                margin: 0mm !important;
                padding: 0 !important;
                marks: none !important;
                bleed: 0 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                /* 强制内容适应纸张 */
                overflow: hidden !important;
                /* 确保不会根据纸张大小自动缩放 */
                transform-origin: top left !important;
                /* 防止浏览器自动调整内容大小 */
                zoom: 1 !important;
            }
            
            /* 防止任何元素分页 */
            #print-receipt,
            #print-receipt *,
            #print-receipt .receipt-content,
            #print-receipt .receipt-content * {
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                orphans: 1 !important;
                widows: 1 !important;
            }
            
            /* 确保HTML和BODY不会影响打印 */
            html, body {
                margin: 0 !important;
                padding: 0 !important;
                visibility: hidden !important;
                background: transparent !important;
                overflow: visible !important;
            }
            
            /* 防止任何滚动条 */
            html {
                overflow: hidden !important;
            }
            
            /* 确保打印内容不会被裁剪 */
            #print-receipt {
                overflow: visible !important;
                height: auto !important;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="app-container">
            <!-- 侧边栏 -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">物业收费系统</div>
                    <div class="user-info">
                        [[ user.real_name ]] <br> <!-- 使用真实姓名 -->
                        [[ user.community ]] <!-- 所属小区 -->
                        <span v-if="user.role" style="display: block; font-size: 11px; color: #aaa; margin-top: 2px;">
                            [[ user.role ]] <!-- 显示用户角色 -->
                        </span>
                    </div>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item" :class="{active: currentPage === 'workbench'}" @click="currentPage = 'workbench'">
                        <i class="el-icon-s-home"></i> 收费工作台
                    </li>
                    <li class="nav-item" :class="{active: currentPage === 'detailedQuery'}" @click="currentPage = 'detailedQuery'">
                        <i class="el-icon-document"></i> 详细查询
                    </li>
                    <li class="nav-item" :class="{active: currentPage === 'reports'}" @click="currentPage = 'reports'">
                        <i class="el-icon-data-analysis"></i> 数据报表
                    </li>
                    <li class="nav-item" :class="{active: currentPage === 'financialReconciliation'}" @click="currentPage = 'financialReconciliation'">
                        <i class="el-icon-money"></i> 财务对账报表
                    </li>

                    <!-- 操作日志 -->
                    <li class="nav-item" :class="{active: currentPage === 'operationLogs'}" @click="currentPage = 'operationLogs'">
                        <i class="el-icon-document-copy"></i> 操作日志
                    </li>

                    <!-- 在侧边栏的导航菜单中添加 -->
                    <li class="nav-item" :class="{active: currentPage === 'feePrices'}" @click="currentPage = 'feePrices'">
                        <i class="el-icon-info"></i> 收费标准管理
                    </li>

                    <li class="nav-item" @click="logout">
                        <i class="el-icon-switch-button"></i> 退出登录
                    </li>
                </ul>
            </div>
            
            <!-- 主内容区 -->
            <div class="main-content">
                <div class="content-wrapper">
                    <!-- 收费工作台页面 -->
                    <div v-if="currentPage === 'workbench'">
                        <div class="header">
                            <div class="header-title">收费工作台</div>
                        </div>
                    
                    <div class="workbench-container">
                        <!-- 地址选择 -->
                        <div class="address-selector">
                            <div class="section-title">1. 选择地址</div>
                            
                            <div class="address-row">
                                
                                <!-- 楼栋选择 -->
                                <div class="address-field">
                                    <div class="field-label">楼栋</div>
                                    <div class="form-control" style="width: 150px;">
                                        <el-select 
                                            v-model="selectedBuilding" 
                                            placeholder="请选择" 
                                            style="width: 100%;"
                                            @change="onBuildingChange"
                                            popper-append-to-body="true"
                                            clearable>
                                            <el-option
                                                v-for="building in buildings"
                                                :key="building"
                                                :label="building"
                                                :value="building">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </div>
                                
                                <!-- 房间选择 -->
                                <div class="address-field">
                                    <div class="field-label">房间</div>
                                    <div class="form-control" style="width: 150px;">
                                        <el-select 
                                            v-model="selectedRoomId" 
                                            :placeholder="selectedBuilding ? '请选择' : '先选楼栋'" 
                                            style="width: 100%;"
                                            @change="onRoomChange"
                                            :disabled="!selectedBuilding"
                                            popper-append-to-body="true"
                                            clearable>
                                            <el-option
                                                v-for="room in rooms"
                                                :key="room.id"
                                                :label="room.room"
                                                :value="room.id">
                                            </el-option>
                                        </el-select>
                                    </div>
                                </div>
                                
                                <!-- 姓名输入 -->
                                <div class="address-field">
                                    <div class="field-label">姓名</div>
                                    <div class="form-control" style="width: 160px;">
                                        <el-input 
                                            v-model="residentName" 
                                            placeholder="请输入" 
                                            style="width: 100%;"
                                            :maxlength="10"
                                            show-word-limit>
                                        </el-input>
                                    </div>
                                </div>
                                
                                <!-- 手机号输入 -->
                                <div class="address-field">
                                    <div class="field-label">手机号</div>
                                    <div class="form-control" style="width: 190px;">
                                        <el-input 
                                            v-model="residentPhone" 
                                            placeholder="请输入" 
                                            style="width: 100%;"
                                            :maxlength="11"
                                            @input="validatePhone">
                                        </el-input>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 错误提示 -->
                            <div v-if="phoneError" class="phone-error">
                                [[ phoneError ]]
                            </div>
                            
                            <!-- 用户历史缴费记录 - 可折叠区块 -->
                            <div class="user-history-section">
                                <div class="history-header" @click="toggleHistory">
                                    <span class="history-title">
                                        <span class="collapse-icon">[[ historyExpanded ? '↓' : '→' ]]</span>
                                        此用户历史缴费记录
                                    </span>
                                </div>
                                <el-collapse-transition>
                                    <div v-show="historyExpanded" class="history-content">
                                        <!-- 加载状态 -->
                                        <div v-if="historyLoading" class="history-loading">
                                            <i class="el-icon-loading"></i> 正在加载历史记录...
                                        </div>
                                        <!-- 无记录提示 -->
                                        <div v-else-if="userHistoryOrders.length === 0" class="history-empty">
                                            暂无历史缴费记录
                                        </div>
                                        <!-- 历史记录表格 -->
                                        <div v-else class="user-history-table-container">
                                            <table class="user-history-table">
                                                <thead>
                                                    <tr>
                                                        <th>收费日期</th>
                                                        <th>楼栋</th>
                                                        <th>房间</th>
                                                        <th>收费项目</th>
                                                        <th>金额</th>
                                                        <th>支付方式</th>
                                                        <th>备注</th>
                                                        <th>操作</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr v-for="order in userHistoryOrders" :key="order.orderId">
                                                        <td>[[ formatDate(order.entryTime) ]]</td>
                                                        <td>[[ order.building || '-' ]]</td>
                                                        <td>[[ order.room || '-' ]]</td>
                                                        <td class="fee-items-cell">
                                                            <div v-for="(item, index) in order.feeItems.split('\n')" :key="index">
                                                                [[ item ]]
                                                            </div>
                                                        </td>
                                                        <td style="color: #f56c6c; font-weight: bold;">[[ formatPrice(order.totalAmount) ]]</td>
                                                        <td>[[ order.paymentMethod || '-' ]]</td>
                                                        <td>[[ order.remark ]]</td>
                                                        <td>
                                                            <div class="action-buttons-cell">
                                                                <el-button 
                                                                    type="primary" 
                                                                    size="small" 
                                                                    @click="reprintReceipt(order.orderId)"
                                                                    class="reprint-button">
                                                                    重打小票
                                                                </el-button>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </el-collapse-transition>
                            </div>
                        </div>
                        
                        <!-- 费用项目 -->
                        <div class="fee-section">
                            <div class="section-title">
                                2. 添加收费项目
                                <div class="refund-checkbox" style="display: inline-block; margin-left: 20px;">
                                    <el-checkbox v-model="isRefundMode" @change="onRefundModeChange"><strong style="font-weight: bold; font-size: 18px;">退费</strong></el-checkbox>
                                </div>
                            </div>
                            <div class="fee-buttons">
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('electricity')" 
                                    :disabled="!selectedRoomId || buttonDisabled.electricity"
                                    :title="buttonDisabled.electricity ? '电费已添加或未选择地址' : '添加电费'">
                                    <i class="el-icon-lightning"></i> 添加电费
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('coldWater')" 
                                    :disabled="!selectedRoomId || buttonDisabled.coldWater"
                                    :title="buttonDisabled.coldWater ? '冷水费已添加或未选择地址' : '添加冷水费'">
                                    <i class="el-icon-water-drop"></i> 添加冷水费
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('hotWater')" 
                                    :disabled="!selectedRoomId || buttonDisabled.hotWater"
                                    :title="buttonDisabled.hotWater ? '热水费已添加或未选择地址' : '添加热水费'">
                                    <i class="el-icon-hot-water"></i> 添加热水费
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('network')" 
                                    :disabled="!selectedRoomId || buttonDisabled.network"
                                    :title="buttonDisabled.network ? '网费已添加或未选择地址' : '添加网费'">
                                    <i class="el-icon-monitor"></i> 添加网费
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('parking')" 
                                    :disabled="!selectedRoomId || buttonDisabled.parking"
                                    :title="buttonDisabled.parking ? '停车费已添加或未选择地址' : '添加停车费'">
                                    <i class="el-icon-truck"></i> 添加停车费
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('rent')" 
                                    :disabled="!selectedRoomId || buttonDisabled.rent"
                                    :title="buttonDisabled.rent ? '房租已添加或未选择地址' : '添加房租'">
                                    <i class="el-icon-home"></i> 添加房租
                                </el-button>
                                <el-button 
                                    type="primary" 
                                    size="default" 
                                    @click="addFeeItem('management')" 
                                    :disabled="!selectedRoomId || buttonDisabled.management"
                                    :title="buttonDisabled.management ? '管理费已添加或未选择地址' : '添加管理费'">
                                    <i class="el-icon-office-building"></i> 添加管理费
                                </el-button>
                            </div>
                            
                            <!-- 费用表格 -->
                            <table class="fee-table" v-if="feeItems.length > 0">
                                <thead>
                                    <tr>
                                        <th>项目名称</th>
                                        <th>单位</th>
                                        <th>数量</th>
                                        <th>单价（元）</th>
                                        <th>金额（元）</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="(item, index) in feeItems" :key="index" :class="{ 'parking-detail-row': item.type === 'parking' }">
                                        <td>[[ getFeeTypeName(item.type) ]]</td>
                                        <td>[[ getFeeUnit(item.type) ]]</td>
                                        <td>
                                            <el-input-number
                                                v-model="item.quantity"
                                                :min="0"
                                                :step="item.type === 'network' || item.type === 'parking' || item.type === 'rent' || item.type === 'management' ? 1 : 0.1"
                                                @change="(value) => handleQuantityChange(index, value)"
                                                size="small"
                                                style="width: 100%; max-width: 120px;">
                                            </el-input-number>
                                        </td>
                                        <td>
                                            <el-input 
                                                :value="formatPrice(item.unitPrice)" 
                                                readonly 
                                                size="small"
                                                style="width: 100%; max-width: 120px; text-align: center;">
                                                <template #append>元</template>
                                            </el-input>
                                        </td>
                                        <td>
                                            <el-input 
                                                v-model="item.amount" 
                                                @input="updateItemQuantityFromAmount(index)"
                                                size="small" 
                                                style="width: 100%; max-width: 120px;">
                                                <template #append>元</template>
                                            </el-input>
                                        </td>
                                        <td>
                                            <div class="fee-item-actions">
                                                <el-button 
                                                    type="danger" 
                                                    size="small" 
                                                    @click="removeFeeItem(index)" 
                                                    circle
                                                    title="删除此项">
                                                    <i class="el-icon-delete"></i>
                                                </el-button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- 停车费详情行（如果是停车费，显示额外信息） -->
                            <div v-if="feeItems.some(item => item.type === 'parking')" class="parking-detail-cell" style="margin-top: 10px; padding: 15px; background-color: #f9f9f9; border-radius: 6px; border: 1px solid #e8e8e8;">
                                <div style="margin-bottom: 10px; font-size: 14px; font-weight: 500; color: #333;">
                                    <i class="el-icon-truck"></i> 停车费详细信息
                                </div>
                                <div class="parking-fields">
                                    <div class="parking-field">
                                        <span class="parking-label">车牌号：</span>
                                        <input 
                                            type="text" 
                                            :value="getParkingItem() ? getParkingItem().carPlate : ''" 
                                            placeholder="请输入车牌号" 
                                            style="width: 150px; height: 32px; padding: 0 8px; border: 1px solid #dcdfe6; border-radius: 4px; background-color: #ffffff;"
                                            @input="(event) => { 
                                                console.log('车牌号输入:', event.target.value); 
                                                const parkingItem = getParkingItem();
                                                if (parkingItem) {
                                                    parkingItem.carPlate = event.target.value;
                                                    console.log('更新车牌号:', parkingItem.carPlate);
                                                }
                                            }">
                                        </input>
                                    </div>
                                    
                                    <div class="parking-field">
                                        <span class="parking-label">开始日期：</span>
                                        <input 
                                            type="text" 
                                            id="parkingStartDatePicker" 
                                            class="parking-date-input"
                                            :value="getParkingItem() ? getParkingItem().startDate : ''"
                                            placeholder="请选择开始日期"
                                            @input="(event) => { 
                                                console.log('开始日期输入:', event.target.value); 
                                                const parkingItem = getParkingItem();
                                                if (parkingItem) {
                                                    parkingItem.startDate = event.target.value;
                                                    console.log('更新开始日期:', parkingItem.startDate);
                                                }
                                            }">
                                    </div>
                                    
                                    <div class="parking-field">
                                        <span class="parking-label">结束日期：</span>
                                        <input 
                                            type="text" 
                                            id="parkingEndDatePicker" 
                                            class="parking-date-input"
                                            :value="getParkingItem() ? getParkingItem().endDate : ''"
                                            placeholder="请选择结束日期"
                                            @input="(event) => { 
                                                console.log('结束日期输入:', event.target.value); 
                                                const parkingItem = getParkingItem();
                                                if (parkingItem) {
                                                    parkingItem.endDate = event.target.value;
                                                    console.log('更新结束日期:', parkingItem.endDate);
                                                }
                                            }">
                                    </div>
                            </div>

                            <!-- 操作提示 -->
                            <div v-if="feeItems.length > 0" style="margin-top: 10px; color: #999; font-size: 12px;">
                                <i class="el-icon-info"></i> 
                                提示：单价由系统根据小区自动加载，可在金额栏直接输入实缴金额，系统自动计算数量
                            </div>
                            
                            <div v-else class="empty-table">
                                <i class="el-icon-document" style="font-size: 48px; color: #ccc; margin-bottom: 10px;"></i>
                                <p>暂无收费项目，请点击上方按钮添加</p>
                            </div>
                        </div>
                        
                        <!-- 汇总信息 -->
                        <div class="summary-section">
                            <div class="section-title">3. 汇总信息</div>
                            
                            <!-- 收款方式 - 可勾选的图标按钮 -->
                            <div class="summary-row" style="margin-bottom: 20px;">
                                <span style="font-weight: 500; color: #606266; margin-right: 15px; min-width: 70px;">收款方式：</span>
                                <div class="payment-options" style="display: flex; gap: 15px; align-items: center;">
                                    <!-- 微信支付 -->
                                    <div class="payment-option" 
                                         :class="{ 'selected': paymentMethod === '微信' }" 
                                         @click="selectPaymentMethod('微信')"
                                         style="cursor: pointer;">
                                        <div class="payment-icon wechat-icon">
                                            <i class="fab fa-weixin"></i>
                                        </div>
                                        <div class="payment-text">微信</div>
                                        <div class="payment-check" v-if="paymentMethod === '微信'">
                                            <i class="el-icon-check"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- 支付宝 -->
                                    <div class="payment-option" 
                                         :class="{ 'selected': paymentMethod === '支付宝' }" 
                                         @click="selectPaymentMethod('支付宝')"
                                         style="cursor: pointer;">
                                        <div class="payment-icon alipay-icon">
                                            <i class="fab fa-alipay"></i>
                                        </div>
                                        <div class="payment-text">支付宝</div>
                                        <div class="payment-check" v-if="paymentMethod === '支付宝'">
                                            <i class="el-icon-check"></i>
                                        </div>
                                    </div>
                                    
                                    <!-- 现金 -->
                                    <div class="payment-option" 
                                         :class="{ 'selected': paymentMethod === '现金' }" 
                                         @click="selectPaymentMethod('现金')"
                                         style="cursor: pointer;">
                                        <div class="payment-icon cash-icon">
                                            <i class="fas fa-money-bill-wave"></i>
                                        </div>
                                        <div class="payment-text">现金</div>
                                        <div class="payment-check" v-if="paymentMethod === '现金'">
                                            <i class="el-icon-check"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 备注 - 靠左排列 -->
                            <div class="summary-row" style="display: flex; align-items: flex-start;">
                                <span style="font-weight: 500; color: #606266; margin-right: 15px; min-width: 70px; padding-top: 8px;">备注：</span>
                                <el-input 
                                    v-model="remark" 
                                    type="textarea" 
                                    placeholder="可填写备注信息" 
                                    :rows="3"
                                    maxlength="200"
                                    show-word-limit
                                    style="flex: 1; max-width: 500px; text-align: left;">
                                </el-input>
                            </div>
                            
                            <!-- 总计金额 - 靠左 -->
                            <div class="total-amount" style="text-align: left; margin-top: 20px;">
                                总计金额：<span style="color: #f56c6c; font-size: 28px;">[[ totalAmount.toFixed(2) ]]</span> 元
                            </div>
                        </div>
                        
                        <!-- 操作按钮 -->
                        <div class="action-buttons">
                            <el-button type="primary" size="large" @click="generateBill" :disabled="!canGenerate" :loading="generating">
                                <i class="el-icon-printer"></i> 收费并打印
                            </el-button>
                            <el-button type="info" size="large" @click="clearForm">
                                清空重填
                            </el-button>
                        </div>
                    </div>

                    <!-- 今日收费记录区块 -->
                    <div class="recent-records-section">
                        <div class="section-title">今日收费记录[[ todayUserOrders.length > 0 ? todayUserOrders.length + '笔' : '' ]]</div>
                        
                        <!-- 今日收费金额合计 -->
                        <div class="today-total">
                            今日收费金额合计：<span class="amount">[[ formatPrice(todayTotalAmount) ]]</span> 元
                        </div>
                        
                        <!-- 今日收费记录表格容器 -->
                        <div class="recent-records-table-container">
                            <table class="recent-records-table" v-if="todayUserOrders.length > 0">
                                <thead>
                                    <tr>
                                        <th>收费日期</th>
                                        <th>楼栋</th>
                                        <th>房号</th>
                                        <th>姓名</th>
                                        <th>电话</th>
                                        <th>收费项目</th>
                                        <th>收费金额</th>
                                        <th>支付方式</th>
                                        <th>备注</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="order in todayUserOrders" :key="order.orderId">
                                        <td>[[ formatDate(order.entryTime) ]]</td>
                                        <td>[[ order.building || '-' ]]</td>
                                        <td>[[ order.room || '-' ]]</td>
                                        <td>[[ order.residentName || '-' ]]</td>
                                        <td>[[ order.residentPhone || '-' ]]</td>
                                        <td class="fee-items-cell">
                                            <div v-for="(item, index) in order.feeItems.split('\n')" :key="index">
                                                [[ item ]]
                                            </div>
                                        </td>
                                        <td style="color: #f56c6c; font-weight: bold;">[[ formatPrice(order.totalAmount) ]]</td>
                                        <td>[[ order.paymentMethod || '-' ]]</td>
                                        <td style="text-align: left;">[[ order.remark ]]</td>
                                        <td>
                                            <div class="action-buttons-cell">
                                                <el-button 
                                                    type="primary" 
                                                    size="small" 
                                                    @click="reprintReceipt(order.orderId)"
                                                    class="reprint-button">
                                                    重打小票
                                                </el-button>
                                                <el-button 
                                                    type="danger" 
                                                    size="small" 
                                                    @click="handleRedReverse(order)"
                                                    class="red-reverse-button"
                                                    :disabled="order.redReverse === 1">
                                                    红冲
                                                </el-button>
                                                <el-button 
                                                    type="danger" 
                                                    size="small" 
                                                    @click="deleteOrder(order.orderId)"
                                                    class="delete-button"
                                                    v-if="canDeleteOrder">
                                                    删除
                                                </el-button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div v-else class="empty-table">
                            <i class="el-icon-document" style="font-size: 48px; color: #ccc; margin-bottom: 10px;"></i>
                            <p>暂无收费记录</p>
                        </div>
                    </div>
                </div>
                

            </div>
        </div>

        <!-- 隐藏的打印区域 -->
        <div id="print-receipt" style="display: none;">
            <div class="receipt-content">
                <div class="receipt-header">
                    <h2>物业收费凭证</h2>
                    <div>[[ receiptData.community || user.community || '物业公司' ]]</div>
                </div>
                
                <div class="receipt-info">
                    <div><span class="label">收费时间：</span><span class="date-time">[[ receiptData.time ]]</span></div>
                    <div><span class="label">地址：</span>[[ receiptData.building ]]-[[ receiptData.room ]]</div>
                    <div><span class="label">姓名：</span>[[ receiptData.residentName ]]</div>
                    <div><span class="label">收款方式：</span>[[ receiptData.paymentMethod ]]</div>
                </div>
                
                <div class="receipt-items">
                    <div style="font-weight: bold; margin-bottom: 5px;">收费项目：</div>
                    <div v-html="receiptData.feeItemsHtml"></div>
                </div>
                
                <div class="receipt-total">
                    总计金额：[[ receiptData.totalAmount ]] 元
                </div>
                
                <div class="receipt-footer">
                    <div>账单号：[[ receiptData.billNumber ]]</div>
                    <div>操作员：[[ user.real_name ]]</div>
                    <div>打印时间：<span class="date-time">[[ receiptData.printTime ]]</span></div>
                    <div class="thank-you" style="margin-top: 10px;">- 谢谢光临 -</div>
                </div>
            </div>
        </div>
        
        <!-- 详细查询页面 -->
        <div v-if="currentPage === 'detailedQuery'" style="position: fixed; top: 0; left: 240px; right: 0; bottom: 0; z-index: 999;">
            <iframe 
                src="/query_detailed?embed=1" 
                style="width: 100%; height: 100%; border: none; display: block;"
                frameborder="0">
            </iframe>
        </div>
        
        <!-- 数据报表页面 -->
        <div v-if="currentPage === 'reports'" style="position: fixed; top: 0; left: 240px; right: 0; bottom: 0; z-index: 999;">
            <iframe 
                src="/reports" 
                style="width: 100%; height: 100%; border: none; display: block;"
                frameborder="0">
            </iframe>
        </div>
        
        <!-- 财务对账报表页面 -->
        <div v-if="currentPage === 'financialReconciliation'" style="position: fixed; top: 0; left: 240px; right: 0; bottom: 0; z-index: 999;">
            <iframe 
                src="/financial_reconciliation" 
                style="width: 100%; height: 100%; border: none; display: block;"
                frameborder="0">
            </iframe>
        </div>
        
        <!-- 操作日志页面 -->
        <div v-if="currentPage === 'operationLogs'" style="position: fixed; top: 0; left: 240px; right: 0; bottom: 0; z-index: 999;">
            <iframe 
                src="/operation_logs" 
                style="width: 100%; height: 100%; border: none; display: block;"
                frameborder="0">
            </iframe>
        </div>
        
        <!-- 收费标准管理页面 -->
        <div v-if="currentPage === 'feePrices'" style="position: fixed; top: 0; left: 240px; right: 0; bottom: 0; z-index: 999;">
            <iframe 
                src="/fee_prices_manager" 
                style="width: 100%; height: 100%; border: none; display: block;"
                frameborder="0">
            </iframe>
        </div>
    </div>
<script>
const { createApp, ref, computed, onMounted, watch, nextTick } = Vue;
const { ElSelect, ElOption, ElButton, ElInput, ElInputNumber, ElMessage, ElMessageBox, ElDatePicker, ElLoading } = ElementPlus;

// 创建Vue应用实例，并设置自定义分隔符
const app = createApp({
    compilerOptions: {
        delimiters: ['[[', ']]']
    },
    setup() {
        // 用户信息
        const user = ref(JSON.parse(sessionStorage.getItem('user')) || {});
        const currentPage = ref('workbench');
        
        // 工作台数据
        const buildings = ref([]);  // 楼栋列表
        const rooms = ref([]);      // 房间列表
        const selectedBuilding = ref('');
        const selectedRoomId = ref('');
        const feeItems = ref([]);
        const paymentMethod = ref('');
        const remark = ref('');
        const generating = ref(false);
        
        // 退费模式
        const isRefundMode = ref(false);

        // 格式化日期时间为日期选择器格式
        const formatDateTimeForPicker = (date) => {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${year}-${month}-${day} ${hours}:${minutes}`;
        };

        // 新增：住户信息
        const residentName = ref('');
        const residentPhone = ref('');
        const phoneError = ref('');
        
        // 用户历史缴费记录相关
        const historyExpanded = ref(false);
        const historyLoading = ref(false);
        const userHistoryOrders = ref([]);

        // 当前小区的收费标准
        const communityPrices = ref({
            electricity: 0.00,
            coldWater: 0.00, 
            hotWater: 0.00,
            network: 0.00,
            parking: 0.00,
            rent: 0.00,
            management: 0.00
        });

        // 费用类型配置
        const feeConfig = {
            electricity: { 
                name: '电费', 
                unit: '度', 
                hasCarPlate: false 
            },
            coldWater: { 
                name: '冷水费', 
                unit: '吨', 
                hasCarPlate: false 
            },
            hotWater: { 
                name: '热水费', 
                unit: '吨', 
                hasCarPlate: false 
            },
            network: { 
                name: '网费', 
                unit: '月', 
                hasCarPlate: false 
            },
            parking: { 
                name: '停车费', 
                unit: '月', 
                hasCarPlate: true 
            },
            rent: { 
                name: '房租', 
                unit: '月', 
                hasCarPlate: false 
            },
            management: { 
                name: '管理费', 
                unit: '月', 
                hasCarPlate: false 
            }
        };
        
        // 已添加的费用类型集合
        const addedFeeTypes = ref(new Set());
        
        // 今日收费记录
        const recentOrders = ref([]);
        // 计算当前操作员的今日收费合计金额
        const todayTotalAmount = computed(() => {
            // 使用已筛选的今日用户订单
            const todayOrders = todayUserOrders.value;
            if (!todayOrders || !todayOrders.length) return 0;
            
            let totalAmount = 0;
            
            todayOrders.forEach(order => {
                // 累加收款金额
                totalAmount += parseFloat(order.totalAmount) || 0;
            });
            
            return totalAmount;
        });
        
        // 打印凭据数据
        const receiptData = ref({
            time: '',
            building: '',
            room: '',
            residentName: '',
            residentPhone: '',
            paymentMethod: '',
            feeItems: '',
            totalAmount: '',
            billNumber: '',
            printTime: '',
            community: ''
        });
        
        // 检查费用类型是否已添加
        const isFeeTypeAdded = (type) => {
            return addedFeeTypes.value.has(type);
        };
        
        // 获取费用类型名称
        const getFeeTypeName = (type) => {
            return feeConfig[type]?.name || type;
        };
        
        // 获取费用单位
        const getFeeUnit = (type) => {
            return feeConfig[type]?.unit || '';
        };
        
        // 计算总金额
        const totalAmount = computed(() => {
            return feeItems.value.reduce((sum, item) => {
                return sum + (parseFloat(item.amount) || 0);
            }, 0);
        });
        
        // 是否可以生成账单
        const canGenerate = computed(() => {
            // 退费模式下：金额必须为负数才允许提交
            if (isRefundMode.value) {
                return selectedRoomId.value && 
                       feeItems.value.length > 0 && 
                       paymentMethod.value && 
                       totalAmount.value < 0 &&  // 退费模式要求金额为负数
                       !phoneError.value;
            }
            // 正常收费模式下：金额必须为正数才允许提交
            return selectedRoomId.value && 
                   feeItems.value.length > 0 && 
                   paymentMethod.value && 
                   totalAmount.value > 0 &&
                   !phoneError.value;
        });
        
        // 按钮禁用状态
        const buttonDisabled = computed(() => {
            return {
                electricity: isFeeTypeAdded('electricity'),
                coldWater: isFeeTypeAdded('coldWater'),
                hotWater: isFeeTypeAdded('hotWater'),
                network: isFeeTypeAdded('network'),
                parking: isFeeTypeAdded('parking'),
                rent: isFeeTypeAdded('rent'),
                management: isFeeTypeAdded('management')
            };
        });
        
        // 删除权限判断：系统管理员或小区经理可以删除
        const canDeleteOrder = computed(() => {
            const userRole = user.value.role || '';
            return userRole === '系统管理员' || userRole === '小区经理';
        });
        
        // 筛选当前操作员的今日订单
        const todayUserOrders = computed(() => {
            if (!recentOrders.value || !recentOrders.value.length) return [];
            
            // 使用本地时间获取今日日期 YYYY-MM-DD
            const now = new Date();
            const today = now.toLocaleDateString('zh-CN', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit' 
            }).replace(/\//g, '-');
            
            // API已按小区ID筛选，前端只需按日期筛选
            
            return recentOrders.value.filter(order => {
                // 检查是否是今日的订单（已由API按小区ID筛选）
                const orderDateObj = new Date(order.entryTime);
                const orderDate = orderDateObj.toLocaleDateString('zh-CN', { 
                    year: 'numeric', 
                    month: '2-digit', 
                    day: '2-digit' 
                }).replace(/\//g, '-');
                
                return orderDate === today; // 只按日期筛选，不筛选操作员ID
            });
        });
        
        // 验证手机号
        const validatePhone = () => {
            const phone = residentPhone.value;
            if (phone && !/^1[3-9]\d{9}$/.test(phone)) {
                phoneError.value = '手机号格式不正确（11位数字，1开头）';
            } else {
                phoneError.value = '';
            }
        };
        
        // 楼栋改变事件
        const onBuildingChange = async (building) => {
            selectedBuilding.value = building;
            selectedRoomId.value = '';
            rooms.value = [];
            residentName.value = '';
            residentPhone.value = '';
            phoneError.value = '';
            
            if (building) {
                await loadRooms(building);
            }
        };
        
        // 加载房间列表
        const loadRooms = async (building) => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch(`/api/addresses?step=rooms&building=${encodeURIComponent(building)}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    rooms.value = result.data;
                } else {
                    ElMessage.error('加载房间列表失败');
                }
            } catch (error) {
                console.error('加载房间列表失败:', error);
                ElMessage.error('网络请求失败');
            }
        };
        
        // 房间改变事件
        const onRoomChange = async (roomId) => {
            selectedRoomId.value = roomId;
            
            // 查找选中的房间信息
            const room = rooms.value.find(r => r.id === roomId);
            if (room) {
                // 自动填充住户信息
                residentName.value = room.name || '';
                residentPhone.value = room.phone || '';
                validatePhone();
                
                // 自动展开历史缴费记录
                historyExpanded.value = true;
                await loadUserPaymentHistory();
            }
        };

        // 格式化价格显示
        const formatPrice = (price) => {
            const num = parseFloat(price);
            if (isNaN(num)) return '0.00';
            return num.toFixed(2);
        };

        // 格式化日期显示
        const formatDate = (dateString) => {
            if (!dateString) return '';
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${year}/${month}/${day} ${hours}:${minutes}`;
        };
        
        // 切换历史记录展开/折叠状态
        const toggleHistory = async () => {
            historyExpanded.value = !historyExpanded.value;
            
            // 如果是展开状态且还没有加载过历史记录，则加载历史记录
            if (historyExpanded.value && userHistoryOrders.value.length === 0 && selectedRoomId.value) {
                await loadUserPaymentHistory();
            }
        };
        
        // 加载用户历史缴费记录
        const loadUserPaymentHistory = async () => {
            if (!selectedRoomId.value) {
                return;
            }
            
            // 根据选中的房间获取地址ID
            const room = rooms.value.find(r => r.id === selectedRoomId.value);
            if (!room || !room.id) {
                return;
            }
            
            historyLoading.value = true;
            
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch(`/api/user-payment-history?address_id=${room.id}&limit=10`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    userHistoryOrders.value = result.data.orders;
                } else {
                    ElMessage.error('加载历史记录失败');
                    userHistoryOrders.value = [];
                }
            } catch (error) {
                console.error('加载历史记录失败:', error);
                ElMessage.error('网络请求失败');
                userHistoryOrders.value = [];
            } finally {
                historyLoading.value = false;
            }
        };
        
        // 监听房间选择变化，当房间变化时重置更新历史记录状态
        watch(selectedRoomId, (newRoomId) => {
            if (newRoomId) {
                // 房间选择变化时，重置历史记录状态
                userHistoryOrders.value = [];
                // 注意：这里不再自动设置 historyExpanded.value = false;
                // 因为 onRoomChange 函数会自动展开历史记录
            }
        });

        // 获取当前小区的收费标准
        const loadFeePrices = async () => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/fee_prices', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                console.log('获取收费标准结果:', result); // 调试用
                
                if (result.status === 'success') {
                    // 更新社区单价
                    communityPrices.value = result.data;
                    
                    console.log('更新后的费用配置:', feeConfig);
                    ElMessage.success('收费标准已加载');
                } else {
                    console.warn('获取收费标准失败:', result.message);
                    ElMessage.warning('使用默认收费标准');
                }
            } catch (error) {
                console.error('获取收费标准失败:', error);
                ElMessage.error('获取收费标准失败，请检查网络连接');
            }
        };

        // 计算结束日期 - 精确计算：开始日期-1天 + 月数
        const calculateEndDate = (startDate, months) => {
            if (!startDate || !months) return '';
            
            // 支持yyyy/MM/dd和yyyy-MM-dd格式，统一转换为yyyy/MM/dd
            const normalizedStartDate = startDate.replace(/-/g, '/');
            const start = new Date(normalizedStartDate);
            
            // 检查日期是否有效
            if (isNaN(start.getTime())) {
                console.error('无效的开始日期:', startDate);
                return '';
            }
            
            const monthCount = parseInt(months) || 1;
            
            // 第一步：开始日期减去1天
            const endDate = new Date(start);
            endDate.setDate(endDate.getDate() - 1);
            
            // 第二步：加上月数，处理月份边界
            const targetMonth = endDate.getMonth() + monthCount;
            const targetYear = endDate.getFullYear() + Math.floor(targetMonth / 12);
            const finalMonth = targetMonth % 12;
            
            endDate.setFullYear(targetYear);
            endDate.setMonth(finalMonth);
            
            // 处理日期边界：如果目标日期不存在（如2月30日），则调整为该月最后一天
            const daysInMonth = new Date(targetYear, finalMonth + 1, 0).getDate();
            if (endDate.getDate() > daysInMonth) {
                endDate.setDate(daysInMonth);
            }
            
            // 格式化为 yyyy/MM/dd
            const year = endDate.getFullYear();
            const month = String(endDate.getMonth() + 1).padStart(2, '0');
            const day = String(endDate.getDate()).padStart(2, '0');
            
            return `${year}/${month}/${day}`;
        };

        // 获取停车费项目
        const getParkingItem = () => {
            return feeItems.value.find(item => item.type === 'parking') || null;
        };

        // 处理车牌号输入
        const handleCarPlateInput = (value) => {
            console.log('车牌号输入事件触发:', value);
            const parkingItem = getParkingItem();
            console.log('停车费项目:', parkingItem);
            if (parkingItem) {
                parkingItem.carPlate = value;
                console.log('更新后的车牌号:', parkingItem.carPlate);
            } else {
                console.log('未找到停车费项目');
            }
        };

        // 保存停车费详情
        const saveParkingDetails = () => {
            // 自动保存到 feeItems 中
            const parkingItem = getParkingItem();
            if (parkingItem) {
                // 更新结束日期
                if (parkingItem.startDate && parkingItem.quantity) {
                    parkingItem.endDate = calculateEndDate(parkingItem.startDate, parkingItem.quantity);
                }
            }
        };

        // 处理停车费开始日期变化
        const handleParkingStartDateChange = (startDate) => {
            const parkingItem = getParkingItem();
            if (parkingItem) {
                // 确保存储的日期格式为 yyyy/MM/dd
                parkingItem.startDate = startDate.replace(/-/g, '/');
                // 如果有数量，自动计算结束日期
                if (parkingItem.quantity) {
                    parkingItem.endDate = calculateEndDate(startDate, parkingItem.quantity);
                }
            }
        };

        // 更新停车费结束日期
        const updateParkingEndDate = () => {
            const parkingItem = getParkingItem();
            if (parkingItem && parkingItem.startDate && parkingItem.quantity) {
                parkingItem.endDate = calculateEndDate(parkingItem.startDate, parkingItem.quantity);
            }
        };
        
        // 添加费用项目
        const addFeeItem = (type) => {
            // 检查是否已添加
            if (addedFeeTypes.value.has(type)) {
                ElMessage.warning(`${getFeeTypeName(type)}已添加，不能重复添加`);
                return;
            }
            
            const config = feeConfig[type];
            if (!config) return;
            
            // 获取当前单价
            const unitPrice = communityPrices.value[type] || 0.00;
            
            // 退费模式：金额始终为负数
            const baseAmount = unitPrice * 1;  // 默认数量为1
            const finalAmount = isRefundMode.value ? -Math.abs(baseAmount) : Math.abs(baseAmount);
            
            // 获取今日日期 - 格式化为 yyyy/MM/dd
            const today = new Date().toLocaleDateString('zh-CN', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit' 
            }).replace(/\//g, '/');
            
            // 创建费用项
            const newItem = {
                type: type,
                quantity: 1,
                unitPrice: unitPrice,
                amount: finalAmount,  // 退费模式下为负数
                carPlate: '',
                startDate: type === 'parking' ? today : '',  // 停车费默认开始日期为今日
                endDate: type === 'parking' ? calculateEndDate(today, 1) : ''  // 停车费默认结束日期
            };
            
            feeItems.value.push(newItem);
            addedFeeTypes.value.add(type); // 记录已添加的类型
            
            console.log(`添加${getFeeTypeName(type)}:`, { 
                type, 
                unitPrice, 
                amount: finalAmount,
                isRefund: isRefundMode.value,
                source: 'API',
                apiPrice: communityPrices.value[type],
                startDate: newItem.startDate,
                endDate: newItem.endDate
            });
            
            const modeText = isRefundMode.value ? '退费' : '收费';
            ElMessage.success(`已添加${getFeeTypeName(type)}${modeText}，单价：${unitPrice}元`);
        };
        
        // 更新项目金额（通过数量计算金额）
        const updateItemAmount = (index) => {
            const item = feeItems.value[index];
            if (!item) return;
            
            const quantity = parseFloat(item.quantity) || 0;
            const unitPrice = parseFloat(item.unitPrice) || 0;
            const baseAmount = (quantity * unitPrice).toFixed(2);
            
            // 退费模式：金额始终为负数
            const finalAmount = isRefundMode.value ? -Math.abs(baseAmount) : Math.abs(baseAmount);
            
            // 使用Object.assign确保响应式更新
            Object.assign(item, {
                amount: finalAmount
            });
            
            // 如果是停车费，更新结束日期
            if (item.type === 'parking') {
                if (item.startDate && item.quantity) {
                    const newEndDate = calculateEndDate(item.startDate, item.quantity);
                    Object.assign(item, {
                        endDate: newEndDate
                    });
                }
            }
            
            console.log('金额更新:', index, item.type, '数量:', quantity, '单价:', unitPrice, '金额:', finalAmount, '退费模式:', isRefundMode.value);
        };
        
        // 退费模式切换处理
        const onRefundModeChange = () => {
            // 当退费模式切换时，重新计算所有费用项的金额
            feeItems.value.forEach((item, index) => {
                const quantity = parseFloat(item.quantity) || 0;
                const unitPrice = parseFloat(item.unitPrice) || 0;
                const baseAmount = (quantity * unitPrice).toFixed(2);
                
                // 退费模式：金额始终为负数
                const finalAmount = isRefundMode.value ? -Math.abs(baseAmount) : Math.abs(baseAmount);
                
                Object.assign(item, {
                    amount: finalAmount
                });
            });
            
            const modeText = isRefundMode.value ? '退费' : '收费';
            ElMessage.info(`已切换到${modeText}模式`);
        };
        
        // 专门处理停车费数量变化
        const handleParkingQuantityChange = (index) => {
            const item = feeItems.value[index];
            if (!item || item.type !== 'parking') return;
            
            console.log('停车费数量变化:', index, '数量:', item.quantity);
            
            // 更新金额
            updateItemAmount(index);
            
            // 强制重新计算结束日期（updateItemAmount中已经处理，这里确保双重保险）
            if (item.startDate && item.quantity) {
                const newEndDate = calculateEndDate(item.startDate, item.quantity);
                Object.assign(item, {
                    endDate: newEndDate
                });
                console.log('停车费结束日期更新:', index, '开始日期:', item.startDate, '月数:', item.quantity, '结束日期:', newEndDate);
            }
        };
        
        // 处理所有类型项目的数量变化
        const handleQuantityChange = (index, value) => {
            const item = feeItems.value[index];
            if (!item) return;
            
            console.log('数量变化处理:', item.type, index, '新值:', value, '当前数量:', item.quantity);
            
            // 确保数量值正确更新
            if (value !== undefined) {
                item.quantity = value;
            }
            
            if (item.type === 'parking') {
                handleParkingQuantityChange(index);
            } else {
                updateItemAmount(index);
            }
        };
        
        // 测试停车费日期计算逻辑
        const testParkingDateCalculation = () => {
            console.log('=== 停车费日期计算测试 ===');
            
            // 测试用例1：正常情况 - 2025/12/19 + 2个月 = 2026/2/18
            const test1 = calculateEndDate('2025/12/19', 2);
            console.log('测试1 - 2025/12/19 + 2个月:', test1, '预期: 2026/02/18', test1 === '2026/02/18' ? '✓ 通过' : '✗ 失败');
            
            // 测试用例2：月末边界 - 2025/1/31 + 1个月 = 2025/2/28
            const test2 = calculateEndDate('2025/1/31', 1);
            console.log('测试2 - 2025/1/31 + 1个月:', test2, '预期: 2025/02/28', test2 === '2025/02/28' ? '✓ 通过' : '✗ 失败');
            
            // 测试用例3：闰年处理 - 2024/2/29 + 12个月 = 2025/2/28
            const test3 = calculateEndDate('2024/2/29', 12);
            console.log('测试3 - 2024/2/29 + 12个月:', test3, '预期: 2025/02/28', test3 === '2025/02/28' ? '✓ 通过' : '✗ 失败');
            
            // 测试用例4：非闰年 - 2025/2/28 + 1个月 = 2025/3/27
            const test4 = calculateEndDate('2025/2/28', 1);
            console.log('测试4 - 2025/2/28 + 1个月:', test4, '预期: 2025/03/27', test4 === '2025/03/27' ? '✓ 通过' : '✗ 失败');
            
            // 测试用例5：年末边界 - 2025/12/31 + 1个月 = 2026/1/30
            const test5 = calculateEndDate('2025/12/31', 1);
            console.log('测试5 - 2025/12/31 + 1个月:', test5, '预期: 2026/01/30', test5 === '2026/01/30' ? '✓ 通过' : '✗ 失败');
            
            console.log('=== 测试完成 ===');
        };
        
        // 通过金额反推数量
        const updateItemQuantityFromAmount = (index) => {
            const item = feeItems.value[index];
            let amount = parseFloat(item.amount) || 0;
            const unitPrice = parseFloat(item.unitPrice) || 0;
            
            // 退费模式下：确保金额始终为负数
            if (isRefundMode.value && amount > 0) {
                amount = -amount;
                // 更新金额为负数
                Object.assign(item, {
                    amount: amount
                });
            }
            
            if (unitPrice > 0) {
                // 计算数量 = 金额 / 单价
                let quantity = amount / unitPrice;
                
                // 根据费用类型处理小数位数
                if (item.type === 'network' || item.type === 'parking') {
                    // 网费和停车费按整月计算，四舍五入到整数
                    quantity = Math.round(quantity);
                } else {
                    // 电费和水费保留1位小数
                    quantity = Math.round(quantity * 10) / 10;
                }
                
                // 确保数量不为负数
                if (quantity < 0) quantity = 0;
                
                item.quantity = quantity;
                
                // 如果是停车费，更新结束日期
                if (item.type === 'parking') {
                    if (item.startDate && item.quantity) {
                        item.endDate = calculateEndDate(item.startDate, item.quantity);
                    }
                }
            }
        };
        
        // 移除费用项目
        const removeFeeItem = (index) => {
            const removedType = feeItems.value[index].type;
            feeItems.value.splice(index, 1);
            addedFeeTypes.value.delete(removedType); // 释放费用类型
            ElMessage.success(`${getFeeTypeName(removedType)}已删除`);
        };
        
        // 选择收款方式
        const selectPaymentMethod = (method) => {
            if (paymentMethod.value === method) {
                // 如果已经选中，再次点击则取消选择
                paymentMethod.value = '';
            } else {
                paymentMethod.value = method;
            }
        };
        
        // 准备打印凭据数据 - 修改后的版本，使用新的格式
        const prepareReceiptData = (result, selectedRoom) => {
            // 获取当前时间
            const now = new Date();
            const timeStr = now.toLocaleString('zh-CN');
            
            // 构建费用项目HTML（新格式）
            const feeItemsArr = [];
            
            feeItems.value.forEach(item => {
                const name = getFeeTypeName(item.type);
                const quantity = parseFloat(item.quantity) || 0;
                const amount = parseFloat(item.amount) || 0;
                const unit = getFeeUnit(item.type);
                
                let feeText = '';
                
                if (item.type === 'parking') {
                    // 停车费格式：停车费 | 1个月 | ¥130.00 | 2025/12/1-2025/12/31| 皖CMV152
                    const startDate = item.startDate ? formatDate(item.startDate).split(' ')[0] : '';
                    const endDate = item.endDate ? formatDate(item.endDate).split(' ')[0] : '';
                    const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                    const carPlate = item.carPlate || '';
                    
                    feeText = `${name} | ${quantity}${unit} | ¥${formatPrice(amount)} | ${dateRange} | ${carPlate}`;
                } else {
                    // 其他项目格式：电费 | 200.0度 | ¥170.00
                    feeText = `${name} | ${quantity}${unit} | ¥${formatPrice(amount)}`;
                }

                
                feeItemsArr.push(feeText);
            });
            
            // 将数组转换为HTML，每项占一行
            const feeItemsHtml = feeItemsArr.join('<br>');
            
            // 填充打印数据
            receiptData.value = {
                time: timeStr,
                building: selectedBuilding.value || '',
                room: selectedRoom ? selectedRoom.room : '',
                residentName: residentName.value || '',
                residentPhone: residentPhone.value || '',
                paymentMethod: paymentMethod.value,
                feeItems: feeItemsArr.join('，'), // 保留原格式，以防其他地方需要
                feeItemsHtml: feeItemsHtml, // 新增HTML格式
                totalAmount: formatPrice(totalAmount.value),
                billNumber: result.data.billNumber,
                printTime: timeStr,
                community: user.value.community || ''
            };
        };
        
        // 打印凭据
        const printReceipt = () => {
            // 显示打印区域
            const printDiv = document.getElementById('print-receipt');
            printDiv.style.display = 'block';
            
            // 添加打印后处理事件
            const afterPrint = () => {
                printDiv.style.display = 'none';
                window.removeEventListener('afterprint', afterPrint);
            };
            
            // 监听打印后事件
            window.addEventListener('afterprint', afterPrint);
            
            // 调用打印
            window.print();
            
            // 备用方案：如果afterprint事件未触发，使用setTimeout
            setTimeout(() => {
                if (printDiv.style.display === 'block') {
                    printDiv.style.display = 'none';
                }
            }, 1000);
        };
        
        // 生成账单
        const generateBill = async () => {
            if (!canGenerate.value) return;
            
            try {
                generating.value = true;
                
                // 准备数据
                // 使用当前日期时间作为收费日期
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                const entryTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
                
                const orderData = {
                    addressId: selectedRoomId.value,
                    paymentMethod: paymentMethod.value,
                    totalAmount: totalAmount.value,
                    // 退费模式下在备注中添加【退费】标识（放在前面）
                    remark: isRefundMode.value ? 
                            (remark.value ? `【退费】${remark.value}` : '【退费】') : 
                            remark.value,
                    residentName: residentName.value,
                    residentPhone: residentPhone.value,
                    entryTime: entryTime,  // 添加收费日期时间
                    items: feeItems.value.map(item => {
                        const itemData = {
                            type: item.type,
                            quantity: parseFloat(item.quantity) || 0,
                            unitPrice: parseFloat(item.unitPrice) || 0,
                            amount: parseFloat(item.amount) || 0
                        };
                        
                        // 如果是停车费，添加车牌号、开始日期、结束日期
                        if (item.type === 'parking') {
                            itemData.carPlate = item.carPlate || '';
                            // 确保日期格式为 yyyy-MM-dd（后端期望格式）
                            itemData.startDate = item.startDate ? item.startDate.replace(/\//g, '-') : '';
                            itemData.endDate = item.endDate ? item.endDate.replace(/\//g, '-') : '';
                        }
                        
                        return itemData;
                    }),
                    // 添加房租和管理费数据映射
                    rentMonths: feeItems.value.find(item => item.type === 'rent') ? 
                              parseFloat(feeItems.value.find(item => item.type === 'rent').quantity) || 0 : 0,
                    rentAmount: feeItems.value.find(item => item.type === 'rent') ? 
                              parseFloat(feeItems.value.find(item => item.type === 'rent').amount) || 0 : 0,
                    managementMonths: feeItems.value.find(item => item.type === 'management') ? 
                                    parseFloat(feeItems.value.find(item => item.type === 'management').quantity) || 0 : 0,
                    managementAmount: feeItems.value.find(item => item.type === 'management') ? 
                                    parseFloat(feeItems.value.find(item => item.type === 'management').amount) || 0 : 0
                };
                
                // 调用后端API
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(orderData)
                });
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    // 显示成功对话框，询问是否打印
                    ElMessageBox.confirm(
                        `收费成功！\n账单号：${result.data.billNumber}\n金额：${formatPrice(totalAmount.value)}元`,
                        '操作成功',
                        {
                            confirmButtonText: '立即打印',
                            cancelButtonText: '继续开单',
                            type: 'success',
                            center: true,
                            showClose: false
                        }
                    ).then(() => {
                        // 用户点击了"立即打印"
                        // 获取当前选中的房间信息
                        const selectedRoom = rooms.value.find(r => r.id === selectedRoomId.value);
                        
                        // 准备打印数据
                        prepareReceiptData(result, selectedRoom);
                        
                        // 打印凭据
                        setTimeout(() => {
                            printReceipt();
                        }, 100);
                        
                        // 延迟1秒后清空表单，以便继续开单
                        setTimeout(() => {
                            // 清空费用项目
                            feeItems.value = [];
                            addedFeeTypes.value.clear();
                            
                            // 重置支付方式和备注
                            paymentMethod.value = '';
                            remark.value = '';
                            
                            // 清空住户信息
                            residentName.value = '';
                            residentPhone.value = '';
                            phoneError.value = '';
                            
                            // 清空地址选择
                            selectedBuilding.value = '';
                            selectedRoomId.value = '';
                            rooms.value = [];
                            
                            // 清空用户历史缴费记录并置为折叠状态
                            userHistoryOrders.value = [];
                            historyExpanded.value = false;
                            
                            // 重置退费模式为未勾选状态
                            isRefundMode.value = false;
                            
                            // 重新加载最近记录
                            loadRecentOrders();
                            
                            ElMessage.success('打印完成，可以继续开单');
                        }, 1000);
                    }).catch((dialogError) => {
                        if (dialogError === 'cancel') {
                            // 用户点击了"继续开单"
                            // 清空费用项目
                            feeItems.value = [];
                            addedFeeTypes.value.clear();
                            
                            // 重置支付方式和备注
                            paymentMethod.value = '';
                            remark.value = '';
                            
                            // 清空住户信息
                            residentName.value = '';
                            residentPhone.value = '';
                            phoneError.value = '';
                            
                            // 清空地址选择
                            selectedBuilding.value = '';
                            selectedRoomId.value = '';
                            rooms.value = [];
                            
                            // 清空用户历史缴费记录并置为折叠状态
                            userHistoryOrders.value = [];
                            historyExpanded.value = false;
                            
                            // 重置退费模式为未勾选状态
                            isRefundMode.value = false;
                            
                            // 重新加载最近记录
                            loadRecentOrders();
                            
                            ElMessage.success('订单已保存，请继续开单');
                        } else {
                            // 其他错误
                            console.error('对话框错误:', dialogError);
                            ElMessage.success('订单已保存');
                        }
                    });
                    
                } else {
                    ElMessage.error(result.message || '账单生成失败');
                }
            } catch (error) {
                console.error('生成账单失败:', error);
                ElMessage.error('网络请求失败');
            } finally {
                generating.value = false;
            }
        };
        
        // 清空表单
        const clearForm = () => {
            ElMessageBox.confirm('确定要清空当前表单吗？', '提示', {
                confirmButtonText: '确定',
                cancelButtonText: '取消',
                type: 'warning'
            }).then(() => {
                // 清空费用项目
                feeItems.value = [];
                addedFeeTypes.value.clear();
                
                // 重置支付方式和备注
                paymentMethod.value = '';
                remark.value = '';
                
                // 清空住户信息
                residentName.value = '';
                residentPhone.value = '';
                phoneError.value = '';
                
                // 清空地址选择
                selectedBuilding.value = '';
                selectedRoomId.value = '';
                rooms.value = [];
                
                // 清空用户历史缴费记录并置为折叠状态
                userHistoryOrders.value = [];
                historyExpanded.value = false;
                
                // 重置退费模式为未勾选状态
                isRefundMode.value = false;
                
                // 注意：收费日期时间不清空，保留当前时间
                
                ElMessage.success('表单已清空');
            }).catch(() => {
                // 用户取消
            });
        };
        
        // 收费标准管理页面跳转
        const goToFeePricesAdmin = async () => {
            const token = sessionStorage.getItem('token');
            if (!token) {
                ElMessage.error('请先登录');
                window.location.href = '/login';
                return;
            }
            
            try {
                // 使用fetch API，手动在请求头中携带Token去获取管理页面的HTML
                const response = await fetch('/admin/fee-prices', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    // 获取到HTML内容
                    const htmlContent = await response.text();
                    // 在新窗口/标签页中打开（推荐，体验更好）
                    const newWindow = window.open('', '_blank');
                    if (newWindow) {
                        newWindow.document.write(htmlContent);
                        newWindow.document.close();
                    } else {
                        ElMessage.warning('请允许浏览器弹出窗口，或在新标签页手动访问');
                    }
                } else if (response.status === 401) {
                    ElMessage.error('令牌无效或已过期，请重新登录');
                    sessionStorage.removeItem('token');
                    sessionStorage.removeItem('user');
                    window.location.href = '/login';
                } else if (response.status === 403) {
                    ElMessage.error('权限不足，需要管理员身份');
                } else {
                    ElMessage.error('访问管理页面失败');
                }
            } catch (error) {
                console.error('跳转失败:', error);
                ElMessage.error('网络请求失败');
            }
        };
        
        // 页面跳转方法
        const goToQuery = () => {
            window.location.href = '/query';
        };
        
        const goToDetailedQuery = () => {
            window.location.href = '/query_detailed';
        };
        
        // 退出登录
        const logout = () => {
            ElMessageBox.confirm('确定要退出登录吗？', '提示', {
                confirmButtonText: '确定',
                cancelButtonText: '取消',
                type: 'warning'
            }).then(() => {
                sessionStorage.removeItem('token');
                sessionStorage.removeItem('user');
                window.location.href = '/login';
            }).catch(() => {
                // 用户取消
            });
        };
        
        // 加载楼栋列表
        const loadBuildings = async () => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/addresses?step=buildings', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    buildings.value = result.data;
                } else {
                    ElMessage.error('加载楼栋列表失败');
                }
            } catch (error) {
                console.error('加载楼栋列表失败:', error);
                ElMessage.error('网络请求失败');
            }
        };
        
        // 加载今日收费记录
        const loadRecentOrders = async () => {
            console.log('开始加载今日收费记录...');
            try {
                const token = sessionStorage.getItem('token');
                console.log('发送请求到 /api/recent-orders');
                const response = await fetch('/api/recent-orders', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                console.log('收到今日收费记录响应:', result);
                if (result.status === 'success') {
                    recentOrders.value = result.data.orders || [];
                    console.log('设置 recentOrders:', recentOrders.value.length, '条记录');
                    console.log('今日收费记录将自动计算');
                } else {
                    console.warn('加载今日收费记录失败:', result.message);
                }
            } catch (error) {
                console.error('加载今日收费记录失败:', error);
            }
        };
        
        // 删除订单函数 - 包含二次确认
        const deleteOrder = async (orderId) => {
            try {
                // 第一次确认
                await ElMessageBox.confirm('确定要删除这条收费记录吗？', '删除确认', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    type: 'warning'
                });
                
                // 第二次确认
                await ElMessageBox.confirm('删除后无法恢复，请再次确认是否删除？', '二次确认', {
                    confirmButtonText: '确定删除',
                    cancelButtonText: '取消',
                    type: 'error'
                });
                
                const token = sessionStorage.getItem('token');
                if (!token) {
                    ElMessage.error('请先登录');
                    return;
                }
                
                // 显示加载中状态
                const loading = ElLoading.service({
                    lock: true,
                    text: '正在删除订单...',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                
                try {
                    const response = await fetch(`/api/orders/${orderId}`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || '删除订单失败');
                    }
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        ElMessage.success('订单删除成功');
                        // 重新加载最近记录
                        await loadRecentOrders();
                    } else {
                        throw new Error(result.message || '删除订单失败');
                    }
                } finally {
                    loading.close();
                }
            } catch (error) {
                // 如果是用户取消，不显示错误
                if (error === 'cancel' || error.message === 'cancel') {
                    return;
                }
                console.error('删除订单失败:', error);
                ElMessage.error(`删除订单失败: ${error.message || error}`);
            }
        };
        
        // 红冲函数 - 创建负金额的冲销记录
        const handleRedReverse = async (order) => {
            try {
                let reason = '';
                let validReason = false;
                
                // 循环弹出输入框直到用户输入有效内容
                while (!validReason) {
                    const { value: inputReason } = await ElMessageBox.prompt('请输入红冲原因：', '红冲确认', {
                        confirmButtonText: '确定',
                        cancelButtonText: '取消',
                        inputType: 'textarea',
                        inputPlaceholder: '请输入红冲原因...',
                        type: 'warning'
                    });
                    
                    // 如果用户点击了取消按钮，则退出
                    if (inputReason === null || inputReason === undefined) {
                        return;
                    }
                    
                    // 检查输入是否为空
                    if (inputReason.trim() === '') {
                        ElMessage.warning('红冲原因不能为空，请重新输入');
                        continue; // 继续循环，再次弹出输入框
                    }
                    
                    reason = inputReason.trim();
                    validReason = true; // 输入有效，退出循环
                }
                
                // 二次确认
                await ElMessageBox.confirm(`确定要对【${order.building || ''}-${order.room || ''} ¥${formatPrice(order.totalAmount)}】 进行红冲吗？\n原因：${reason}`, '二次确认', {
                    confirmButtonText: '确定红冲',
                    cancelButtonText: '取消',
                    type: 'error'
                });
                
                const token = sessionStorage.getItem('token');
                if (!token) {
                    ElMessage.error('请先登录');
                    return;
                }
                
                // 显示加载中状态
                const loading = ElLoading.service({
                    lock: true,
                    text: '正在创建红冲记录...',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                
                try {
                    // 获取原订单的详细信息
                    const orderDetailResponse = await fetch(`/api/orders/${order.orderId}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!orderDetailResponse.ok) {
                        const errorData = await orderDetailResponse.json();
                        throw new Error(errorData.message || '获取订单详情失败');
                    }
                    
                    const orderDetailResult = await orderDetailResponse.json();
                    if (orderDetailResult.status !== 'success') {
                        throw new Error(orderDetailResult.message || '获取订单详情失败');
                    }
                    
                    const originalOrder = orderDetailResult.data;
                    
                    // 构建红冲记录数据
                    const currentTime = new Date();
                    // 使用本地时间而不是UTC时间
                    const year = currentTime.getFullYear();
                    const month = String(currentTime.getMonth() + 1).padStart(2, '0');
                    const day = String(currentTime.getDate()).padStart(2, '0');
                    const hours = String(currentTime.getHours()).padStart(2, '0');
                    const minutes = String(currentTime.getMinutes()).padStart(2, '0');
                    const seconds = String(currentTime.getSeconds()).padStart(2, '0');
                    const formattedTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
                    console.log('红冲记录时间:', formattedTime);
                    
                    const redReverseData = {
                        addressId: originalOrder.addressId || order.addressId,
                        paymentMethod: originalOrder.paymentMethod || order.paymentMethod,
                        totalAmount: -(originalOrder.totalAmount || order.totalAmount), // 金额改为负数
                        remark: `【红冲】\n原订单号：${originalOrder.billNumber || order.orderId}\n原因：${reason}`,
                        residentName: originalOrder.residentName || order.residentName,
                        residentPhone: originalOrder.residentPhone || order.residentPhone,
                        entryTime: formattedTime, // 使用当前时间
                        originalOrderId: originalOrder.orderId, // 添加原订单ID，用于后端识别红冲操作
                        items: originalOrder.feeDetails ? originalOrder.feeDetails.map(item => ({
                            type: item.name.toLowerCase().includes('电') ? 'electricity' : 
                                  item.name.toLowerCase().includes('热') ? 'hotWater' :
                                  item.name.toLowerCase().includes('冷') ? 'coldWater' :
                                  item.name.toLowerCase().includes('网') ? 'network' :
                                  item.name.toLowerCase().includes('停') ? 'parking' : 'other',
                            quantity: parseFloat(item.quantity) || 0,
                            unitPrice: parseFloat(item.price) || 0,
                            amount: -(parseFloat(item.amount) || 0) // 金额改为负数
                        })) : []
                    };
                    
                    console.log('发送的红冲数据:', redReverseData);
                    
                    // 调用后端API创建红冲记录
                    const response = await fetch('/api/orders', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify(redReverseData)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || '创建红冲记录失败');
                    }
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        ElMessage.success('红冲记录创建成功');
                        // 重新加载今日收费记录
                        await loadRecentOrders();
                    } else {
                        throw new Error(result.message || '创建红冲记录失败');
                    }
                } finally {
                    loading.close();
                }
            } catch (error) {
                // 如果是用户取消，不显示错误
                if (error === 'cancel' || error.message === 'cancel') {
                    return;
                }
                console.error('红冲失败:', error);
                ElMessage.error(`红冲失败: ${error.message || error}`);
            }
        };
        
        // 重打小票函数 - 增强版
        const reprintReceipt = async (orderId) => {
            try {
                // 添加确认对话框
                await ElMessageBox.confirm('确定要重打这张小票吗？', '提示', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    type: 'warning'
                });
                
                const token = sessionStorage.getItem('token');
                if (!token) {
                    ElMessage.error('请先登录');
                    return;
                }
                
                // 显示加载中状态
                const loading = ElLoading.service({
                    lock: true,
                    text: '正在获取订单信息...',
                    background: 'rgba(0, 0, 0, 0.7)'
                });
                
                try {
                    const response = await fetch(`/api/orders/${orderId}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || '获取订单信息失败');
                    }
                    
                    const result = await response.json();
                    
                    if (result.status === 'success') {
                        // 准备打印数据
                        const order = result.data;
                        
                        // 构建费用项目字符串（新格式）
                        const feeItemsArr = [];
                        
                        // 检查新的数据结构
                        if (order.feeDetails && order.feeDetails.length > 0) {
                            // 使用新的数据结构
                            order.feeDetails.forEach(fee => {
                                let feeText = '';
                                
                                if (fee.name === '停车费') {
                                    // 停车费格式：停车费 | 1个月 | ¥130.00 | 2025/12/1-2025/12/31| 皖CMV152
                                    const startDate = fee.startDate ? formatDate(fee.startDate).split(' ')[0] : '';
                                    const endDate = fee.endDate ? formatDate(fee.endDate).split(' ')[0] : '';
                                    const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                                    const carPlate = fee.carPlate || '';
                                    
                                    feeText = `${fee.name} | ${fee.quantity}${fee.unit} | ¥${formatPrice(fee.amount)} | ${dateRange} | ${carPlate}`;
                                } else {
                                    // 其他项目格式：电费 | 200.0度 | ¥170.00
                                    feeText = `${fee.name} | ${fee.quantity}${fee.unit} | ¥${formatPrice(fee.amount)}`;
                                }
                                
                                feeItemsArr.push(feeText);
                            });
                        } else {
                            // 旧的兼容方式
                            if (order.electricity && parseFloat(order.electricity.amount) > 0) {
                                feeItemsArr.push(`电费 | ${order.electricity.degree}度 | ¥${formatPrice(order.electricity.amount)}`);
                            }
                            if (order.coldWater && parseFloat(order.coldWater.amount) > 0) {
                                feeItemsArr.push(`冷水费 | ${order.coldWater.ton}吨 | ¥${formatPrice(order.coldWater.amount)}`);
                            }
                            if (order.hotWater && parseFloat(order.hotWater.amount) > 0) {
                                feeItemsArr.push(`热水费 | ${order.hotWater.ton}吨 | ¥${formatPrice(order.hotWater.amount)}`);
                            }
                            if (order.network && parseFloat(order.network.amount) > 0) {
                                feeItemsArr.push(`网费 | ${order.network.month}月 | ¥${formatPrice(order.network.amount)}`);
                            }
                            if (order.parking && parseFloat(order.parking.amount) > 0) {
                                const startDate = order.parking.startDate ? formatDate(order.parking.startDate).split(' ')[0] : '';
                                const endDate = order.parking.endDate ? formatDate(order.parking.endDate).split(' ')[0] : '';
                                const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                                const carPlate = order.parking.carPlate || '';
                                
                                feeItemsArr.push(`停车费 | ${order.parking.month}月 | ¥${formatPrice(order.parking.amount)} | ${dateRange} | ${carPlate}`);
                            }
                        }
                        
                        // 将数组转换为HTML，每项占一行
                        const feeItemsHtml = feeItemsArr.join('<br>');
                        const feeItemsStr = feeItemsArr.join('，'); // 保留原格式，以防其他地方需要
                        
                        // 准备打印数据
                        receiptData.value = {
                            time: order.entryTime,
                            building: order.address?.building || '',
                            room: order.address?.room || '',
                            residentName: order.residentName || order.address?.residentName || '',
                            residentPhone: order.residentPhone || order.address?.residentPhone || '',
                            paymentMethod: order.paymentMethod,
                            feeItems: feeItemsStr,
                            feeItemsHtml: feeItemsHtml, // 新增HTML格式
                            totalAmount: formatPrice(order.totalAmount),
                            billNumber: order.billNumber,
                            printTime: new Date().toLocaleString('zh-CN'),
                            community: user.value.community || ''
                        };
                        
                        // 打印凭据
                        setTimeout(() => {
                            printReceipt();
                        }, 100);
                        
                        // 记录重打小票操作日志
                        try {
                            await fetch('/api/log-reprint', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': `Bearer ${token}`
                                },
                                body: JSON.stringify({
                                    orderId: orderId,
                                    billNumber: order.billNumber,
                                    building: order.address?.building || '',
                                    room: order.address?.room || '',
                                    totalAmount: order.totalAmount
                                })
                            });
                        } catch (logError) {
                            console.error('记录重打小票日志失败:', logError);
                            // 日志记录失败不影响主流程
                        }
                        
                        ElMessage.success('小票重打成功');
                    } else {
                        throw new Error(result.message || '获取订单信息失败');
                    }
                } finally {
                    loading.close();
                }
            } catch (error) {
                // 如果是用户取消，不显示错误
                if (error === 'cancel' || error.message === 'cancel') {
                    return;
                }
                console.error('重打小票失败:', error);
                ElMessage.error(`重打小票失败: ${error.message || error}`);
            }
        };
        
        // 页面加载时初始化
        onMounted(() => {
            // 检查登录状态
            const token = sessionStorage.getItem('token');
            if (!token) {
                window.location.href = '/login';
                return;
            }
            
            // 检查token是否过期
            try {
                const payload = JSON.parse(atob(token.split('.')[1]));
                const exp = payload.exp * 1000; // 转换为毫秒
                
                // 检查token是否过期
                if (Date.now() >= exp) {
                    sessionStorage.removeItem('token');
                    sessionStorage.removeItem('user');
                    window.location.href = '/login';
                    return;
                }
                
                // 检查是否跨日期（比较当前日期和token创建日期）
                const tokenDate = new Date(exp).toDateString();
                const currentDate = new Date().toDateString();
                if (tokenDate !== currentDate) {
                    sessionStorage.removeItem('token');
                    sessionStorage.removeItem('user');
                    window.location.href = '/login';
                    return;
                }
                
                // 设置定时器，每5分钟检查一次token状态
                setInterval(() => {
                    const currentToken = sessionStorage.getItem('token');
                    if (!currentToken) return;
                    
                    try {
                        const currentPayload = JSON.parse(atob(currentToken.split('.')[1]));
                        const currentExp = currentPayload.exp * 1000;
                        
                        // 检查token是否过期
                        if (Date.now() >= currentExp) {
                            sessionStorage.removeItem('token');
                            sessionStorage.removeItem('user');
                            window.location.href = '/login';
                            return;
                        }
                        
                        // 检查是否跨日期
                        const currentTokenDate = new Date(currentExp).toDateString();
                        const nowDate = new Date().toDateString();
                        if (currentTokenDate !== nowDate) {
                            sessionStorage.removeItem('token');
                            sessionStorage.removeItem('user');
                            window.location.href = '/login';
                        }
                    } catch (e) {
                        console.error('Token检查失败:', e);
                    }
                }, 5 * 60 * 1000); // 5分钟检查一次
                
            } catch (e) {
                console.error('Token解析失败:', e);
                sessionStorage.removeItem('token');
                sessionStorage.removeItem('user');
                window.location.href = '/login';
                return;
            }
            
            // 初始化日历控件
            layui.use('laydate', function(){
                const laydate = layui.laydate;
                
                // 日期时间选择器已移除，不再需要初始化
                
                // 初始化订单查询页面的日期选择器
                // 开始时间选择器
                laydate.render({
                    elem: '#startTime',
                    type: 'datetime',
                    format: 'yyyy-MM-dd HH:mm',
                    max: 0, // 最大可选时间为当前时间
                    done: function(value, date){
                        // 验证日期范围
                        validateDateRange();
                    }
                });
                
                // 结束时间选择器
                laydate.render({
                    elem: '#endTime',
                    type: 'datetime',
                    format: 'yyyy-MM-dd HH:mm',
                    max: 0, // 最大可选时间为当前时间
                    done: function(value, date){
                        // 验证日期范围
                        validateDateRange();
                    }
                });
            });
            
            // 自定义月份年份控制器的函数
            function customizeMonthYearControls(instance) {
                // 获取月份年份容器
                const monthContainer = instance.calendarContainer.querySelector('.flatpickr-current-month');
                if (!monthContainer) return;
                
                // 获取当前显示的年月
                const currentMonth = instance.currentMonth;
                const currentYear = instance.currentYear;
                
                // 创建自定义控制器
                const customControls = document.createElement('div');
                customControls.className = 'custom-month-year-controls';
                customControls.style.cssText = `
                    display: flex;
                    align-items: center;
                    justify-content: flex-start;
                    width: 100%;
                    padding: 0 5px;
                    margin-top: 2px;
                    gap: 10px;
                `;
                
                // 月份控制区域
                const monthControls = document.createElement('div');
                monthControls.className = 'month-controls';
                monthControls.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 3px;
                `;
                
                // 月份减按钮
                const monthPrevBtn = document.createElement('button');
                monthPrevBtn.innerHTML = '<';
                monthPrevBtn.className = 'month-nav-btn prev-month';
                monthPrevBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                monthPrevBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeMonth(-1);
                    // 强制更新日历视图
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // 月份显示
                const monthDisplay = document.createElement('span');
                monthDisplay.className = 'month-display';
                monthDisplay.style.cssText = `
                    font-weight: bold;
                    min-width: 40px;
                    text-align: center;
                    color: #303133;
                    font-size: 14px;
                `;
                
                // 月份加按钮
                const monthNextBtn = document.createElement('button');
                monthNextBtn.innerHTML = '>';
                monthNextBtn.className = 'month-nav-btn next-month';
                monthNextBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                monthNextBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeMonth(1);
                    // 强制更新日历视图
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // 年份控制区域
                const yearControls = document.createElement('div');
                yearControls.className = 'year-controls';
                yearControls.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 3px;
                `;
                
                // 年份减按钮
                const yearPrevBtn = document.createElement('button');
                yearPrevBtn.innerHTML = '<';
                yearPrevBtn.className = 'year-nav-btn prev-year';
                yearPrevBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                yearPrevBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeYear(-1);
                    // 强制更新日历视图
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // 年份显示
                const yearDisplay = document.createElement('span');
                yearDisplay.className = 'year-display';
                yearDisplay.style.cssText = `
                    font-weight: bold;
                    min-width: 50px;
                    text-align: center;
                    color: #303133;
                    font-size: 14px;
                `;
                
                // 年份加按钮
                const yearNextBtn = document.createElement('button');
                yearNextBtn.innerHTML = '>';
                yearNextBtn.className = 'year-nav-btn next-year';
                yearNextBtn.style.cssText = `
                    width: 24px;
                    height: 24px;
                    border: none;
                    background: #409eff;
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: bold;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 14px;
                `;
                yearNextBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    instance.changeYear(1);
                    // 强制更新日历视图
                    instance.redraw();
                    updateMonthYearDisplay();
                });
                
                // 更新显示函数
                function updateMonthYearDisplay() {
                    const monthNames = ["1月", "2月", "3月", "4月", "5月", "6月", 
                                       "7月", "8月", "9月", "10月", "11月", "12月"];
                    monthDisplay.textContent = monthNames[instance.currentMonth];
                    yearDisplay.textContent = instance.currentYear + '年';
                }
                
                // 初始化显示
                updateMonthYearDisplay();
                
                // 组装控件
                monthControls.appendChild(monthPrevBtn);
                monthControls.appendChild(monthDisplay);
                monthControls.appendChild(monthNextBtn);
                
                yearControls.appendChild(yearPrevBtn);
                yearControls.appendChild(yearDisplay);
                yearControls.appendChild(yearNextBtn);
                
                customControls.appendChild(monthControls);
                
                // 添加分隔符
                const separator = document.createElement('div');
                separator.style.cssText = `
                    width: 1px;
                    height: 24px;
                    background: #dcdfe6;
                    margin: 0 8px;
                `;
                customControls.appendChild(separator);
                
                customControls.appendChild(yearControls);
                
                // 替换原有的月份年份显示
                monthContainer.innerHTML = '';
                monthContainer.appendChild(customControls);
                
                // 监听月份年份变化
                instance.calendarContainer.addEventListener('monthChange', updateMonthYearDisplay);
                instance.calendarContainer.addEventListener('yearChange', updateMonthYearDisplay);
            }
            
            // 添加确定和取消按钮的函数
            function addCalendarButtons(instance) {
                // 检查是否已经添加过按钮
                if (instance.calendarContainer.querySelector('.flatpickr-custom-buttons')) {
                    return;
                }
                
                // 创建按钮容器
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'flatpickr-custom-buttons';
                buttonContainer.style.cssText = `
                    display: flex;
                    justify-content: flex-end;
                    gap: 10px;
                    padding: 10px 15px;
                    border-top: 1px solid rgba(64, 158, 255, 0.1);
                    background: rgba(64, 158, 255, 0.05);
                    border-radius: 0 0 20px 20px;
                `;
                
                // 创建取消按钮
                const cancelButton = document.createElement('button');
                cancelButton.textContent = '取消';
                cancelButton.className = 'flatpickr-button flatpickr-cancel';
                cancelButton.style.cssText = `
                    padding: 6px 16px;
                    border: 1px solid #dcdfe6;
                    border-radius: 4px;
                    background: #ffffff;
                    color: #606266;
                    font-size: 14px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;
                cancelButton.addEventListener('click', function() {
                    instance.close();
                });
                
                // 创建确定按钮
                const confirmButton = document.createElement('button');
                confirmButton.textContent = '确定';
                confirmButton.className = 'flatpickr-button flatpickr-confirm';
                confirmButton.style.cssText = `
                    padding: 6px 16px;
                    border: 1px solid #409eff;
                    border-radius: 4px;
                    background: #409eff;
                    color: #ffffff;
                    font-size: 14px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                `;
                confirmButton.addEventListener('click', function() {
                    if (instance.selectedDates.length > 0) {
                        // 格式化选中的日期时间
                        const selectedDate = instance.selectedDates[0];
                        const year = selectedDate.getFullYear();
                        const month = String(selectedDate.getMonth() + 1).padStart(2, '0');
                        const day = String(selectedDate.getDate()).padStart(2, '0');
                        const hours = String(selectedDate.getHours()).padStart(2, '0');
                        const minutes = String(selectedDate.getMinutes()).padStart(2, '0');
                        const formattedDate = `${year}-${month}-${day} ${hours}:${minutes}`;
                        
                        // 更新Vue实例中的值
                        chargeDateTime.value = formattedDate;
                        // 更新输入框显示
                        instance.input.value = formattedDate;
                    }
                    instance.close();
                });
                
                // 添加按钮到容器
                buttonContainer.appendChild(cancelButton);
                buttonContainer.appendChild(confirmButton);
                
                // 将按钮容器添加到日历面板
                instance.calendarContainer.appendChild(buttonContainer);
            }
            
            // 自定义时间选择器，加宽显示框，去掉调节按钮
            function customizeTimeControls(instance) {
                // 查找时间选择器容器
                const timeContainer = instance.calendarContainer.querySelector('.flatpickr-time');
                if (!timeContainer) return;
                
                // 调整时间容器宽度，确保有足够空间
                timeContainer.style.width = '200px';
                timeContainer.style.padding = '10px 5px';
                
                // 查找分钟输入框
                const minuteInput = timeContainer.querySelector('.flatpickr-minute');
                if (!minuteInput) return;
                
                // 调整分钟输入框的宽度，去掉调节按钮
                minuteInput.style.width = '60px';
                minuteInput.style.paddingRight = '5px';
                
                // 查找小时输入框并调整宽度
                const hourInput = timeContainer.querySelector('.flatpickr-hour');
                if (hourInput) {
                    hourInput.style.width = '60px';
                }
                
                // 查找并移除可能存在的自定义分钟控制器
                const existingControls = timeContainer.querySelector('.custom-minute-controls');
                if (existingControls) {
                    existingControls.remove();
                }
            }
            
            // 使用 Promise 方式，避免 await 语法问题
            Promise.all([
                loadBuildings(),
                loadFeePrices(),
                loadRecentOrders(),
                loadQueryBuildings()
            ]).then(() => {
                console.log('页面初始化完成');
            }).catch((error) => {
                console.error('页面初始化失败:', error);
                ElMessage.error('页面加载失败，请刷新重试或联系管理员');
            });
        });

const debugPrices = () => {
    console.log('获取单价:', communityPrices.value);
    
    // 你指定的HTML结构（完全不变）
    const info = `<div style="line-height: 1.8; font-size: 14px;"> <strong style="font-size: 15px; color: #1989fa;">当前收费标准</strong> <hr style="border: none; border-top: 1px solid #eee; margin: 10px 0;"> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">电费：</span><strong>0.85</strong> 元/度</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">冷水费：</span><strong>6</strong> 元/吨</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">热水费：</span><strong>43.5</strong> 元/吨</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">网费：</span><strong>50</strong> 元/月</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">停车费：</span><strong>130</strong> 元/月</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">房租：</span><strong>800</strong> 元/月</div> <div style="margin: 8px 0;"><span style="display: inline-block; width: 80px;">管理费：</span><strong>100</strong> 元/月</div> </div>`;

    // 关键：添加 dangerouslyUseHTMLString: true 解析HTML
    ElMessageBox.alert(info, '收费标准信息', {
        confirmButtonText: '确定',
        width: '400px',
        dangerouslyUseHTMLString: true // 核心配置：允许解析HTML内容
    });
};
        
        // 初始化停车费日期选择器
        const initParkingDatePickers = () => {
            // 等待DOM更新后初始化
            nextTick(() => {
                console.log('开始初始化停车费日期选择器...');
                
                // 确保flatpickr已加载
                if (typeof flatpickr === 'undefined') {
                    console.error('flatpickr未加载');
                    return;
                }
                
                console.log('flatpickr已加载:', typeof flatpickr);
                
                // 检查DOM元素是否存在
                const startInput = document.getElementById('parkingStartDatePicker');
                const endInput = document.getElementById('parkingEndDatePicker');
                
                console.log('开始日期输入框:', startInput);
                console.log('结束日期输入框:', endInput);
                
                if (!startInput || !endInput) {
                    console.error('停车费日期输入框未找到');
                    return;
                }
                
                // 检查是否已经初始化过
                if (startInput._flatpickr || endInput._flatpickr) {
                    console.log('停车费日期选择器已初始化，跳过重新初始化');
                    console.log('开始日期flatpickr实例:', startInput._flatpickr);
                    console.log('结束日期flatpickr实例:', endInput._flatpickr);
                    
                    // 测试手动点击事件
                    startInput.addEventListener('click', function() {
                        console.log('开始日期输入框被点击');
                        if (startInput._flatpickr) {
                            console.log('尝试打开flatpickr日历');
                            startInput._flatpickr.open();
                        }
                    });
                    
                    endInput.addEventListener('click', function() {
                        console.log('结束日期输入框被点击');
                        if (endInput._flatpickr) {
                            console.log('尝试打开flatpickr日历');
                            endInput._flatpickr.open();
                        }
                    });
                    
                    return;
                }
                
                console.log('开始初始化flatpickr实例...');
                
                // 添加手动点击事件测试
                startInput.addEventListener('click', function() {
                    console.log('开始日期输入框被点击（初始化前）');
                });
                
                endInput.addEventListener('click', function() {
                    console.log('结束日期输入框被点击（初始化前）');
                });
                
                // 初始化开始日期选择器 - 使用相对位置跟随输入框
                const startPicker = flatpickr('#parkingStartDatePicker', {
                    dateFormat: 'Y/m/d',
                    locale: 'zh',
                    position: 'below', // 显示在输入框下方
                    appendTo: startInput.parentNode, // 附加到输入框的父元素
                    onChange: function(selectedDates, dateStr, instance) {
                        // 使用专门的处理函数
                        handleParkingStartDateChange(dateStr);
                    }
                });
                
                console.log('开始日期选择器初始化完成:', startPicker);
                
                // 初始化结束日期选择器 - 使用相对位置跟随输入框
                const endPicker = flatpickr('#parkingEndDatePicker', {
                    dateFormat: 'Y/m/d',
                    locale: 'zh',
                    position: 'below', // 显示在输入框下方
                    appendTo: endInput.parentNode, // 附加到输入框的父元素
                    onChange: function(selectedDates, dateStr, instance) {
                        // 使用专门的处理函数
                        handleParkingEndDateChange(dateStr);
                    }
                });
                
                console.log('结束日期选择器初始化完成:', endPicker);
            });
        };
        
        // 监听停车费项目的添加，初始化日期选择器
        watch(() => feeItems.value.some(item => item.type === 'parking'), (hasParking) => {
            if (hasParking) {
                nextTick(() => {
                    initParkingDatePickers();
                });
            }
        });
        
        // 监听停车费项目的数据变化，更新日期选择器值
        watch(() => getParkingItem(), (parkingItem) => {
            if (parkingItem) {
                nextTick(() => {
                    // 更新输入框的值
                    const startInput = document.getElementById('parkingStartDatePicker');
                    const endInput = document.getElementById('parkingEndDatePicker');
                    if (startInput) {
                        // 确保显示格式为 yyyy/MM/dd
                        startInput.value = parkingItem.startDate ? parkingItem.startDate.replace(/-/g, '/') : '';
                    }
                    if (endInput) {
                        // 确保显示格式为 yyyy/MM/dd
                        endInput.value = parkingItem.endDate ? parkingItem.endDate.replace(/-/g, '/') : '';
                    }
                });
            }
        }, { deep: true });

        // 订单查询功能相关变量
        const queryBuilding = ref('');
        const queryRoomId = ref('');
        const queryBuildings = ref([]);
        const queryRooms = ref([]);
        const queryData = ref([]);
        const queryLoading = ref(false);
        const queryPagination = ref({
            page: 1,
            per_page: 10,
            total: 0,
            pages: 0
        });
        const sortColumn = ref('');
        const sortOrder = ref('desc');
        const hasQueried = ref(false);
        const currentPageTotal = ref(0);
        const dateError = ref('');

        // 初始化订单查询的楼栋列表
        const loadQueryBuildings = async () => {
            try {
                const token = sessionStorage.getItem('token');
                const response = await fetch('/api/addresses?step=buildings', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    queryBuildings.value = result.data;
                } else {
                    ElMessage.error('加载楼栋列表失败');
                }
            } catch (error) {
                console.error('加载楼栋列表失败:', error);
                ElMessage.error('网络请求失败');
            }
        };

        // 订单查询的楼栋改变事件
        const onQueryBuildingChange = async (building) => {
            queryBuilding.value = building;
            queryRoomId.value = '';
            queryRooms.value = [];
            
            if (building) {
                try {
                    const token = sessionStorage.getItem('token');
                    const response = await fetch(`/api/addresses?step=rooms&building=${encodeURIComponent(building)}`, {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });
                    
                    const result = await response.json();
                    if (result.status === 'success') {
                        queryRooms.value = result.data;
                    } else {
                        ElMessage.error('加载房间列表失败');
                    }
                } catch (error) {
                    console.error('加载房间列表失败:', error);
                    ElMessage.error('网络请求失败');
                }
            }
        };

        // 订单查询的房间改变事件
        const onQueryRoomChange = (roomId) => {
            queryRoomId.value = roomId;
        };

        // 验证日期范围
        const validateDateRange = () => {
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            
            if (startTime && endTime) {
                const start = new Date(startTime);
                const end = new Date(endTime);
                
                if (start > end) {
                    dateError.value = '开始时间不能晚于结束时间';
                    return false;
                }
            }
            
            dateError.value = '';
            return true;
        };

        // 查询订单
        const queryOrders = async () => {
            if (!validateDateRange()) {
                return;
            }
            
            queryLoading.value = true;
            hasQueried.value = true;
            
            try {
                const token = sessionStorage.getItem('token');
                const params = new URLSearchParams();
                
                // 添加查询参数 - 修正参数名称以匹配后端API
                const startTime = document.getElementById('startTime').value;
                const endTime = document.getElementById('endTime').value;
                
                if (startTime) params.append('startDate', startTime);
                if (endTime) params.append('endDate', endTime);
                if (queryRoomId.value) params.append('addressId', queryRoomId.value);
                params.append('page', queryPagination.value.page);
                params.append('per_page', queryPagination.value.per_page);
                
                // 添加排序参数
                if (sortColumn.value) {
                    params.append('sort', sortColumn.value);
                    params.append('order', sortOrder.value);
                }
                
                // 修正API端点路径
                const response = await fetch(`/api/orders?${params.toString()}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    // 处理返回的数据以匹配前端表格显示格式
                    const processedData = result.data.map(order => {
                        // 构建费用项目字符串
                        const feeItems = [];
                        
                        if (order.电费金额 && parseFloat(order.电费金额) > 0) {
                            const degree = parseFloat(order.电费度数) || 0;
                            const amount = parseFloat(order.电费金额) || 0;
                            feeItems.push(`电费 | ${degree}度 | ¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.冷水金额 && parseFloat(order.冷水金额) > 0) {
                            const ton = parseFloat(order.冷水吨数) || 0;
                            const amount = parseFloat(order.冷水金额) || 0;
                            feeItems.push(`冷水费 | ${ton}吨 | ¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.热水金额 && parseFloat(order.热水金额) > 0) {
                            const ton = parseFloat(order.热水吨数) || 0;
                            const amount = parseFloat(order.热水金额) || 0;
                            feeItems.push(`热水费 | ${ton}吨 | ¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.网费金额 && parseFloat(order.网费金额) > 0) {
                            const month = parseInt(order.网费月数) || 0;
                            const amount = parseFloat(order.网费金额) || 0;
                            feeItems.push(`网费 | ${month}月 | ¥${amount.toFixed(2)}`);
                        }
                        
                        if (order.停车费金额 && parseFloat(order.停车费金额) > 0) {
                            const month = parseInt(order.停车费月数) || 0;
                            const amount = parseFloat(order.停车费金额) || 0;
                            const carPlate = order.车牌号 || '';
                            const startDate = order.停车开始日期 ? new Date(order.停车开始日期).toLocaleDateString('zh-CN') : '';
                            const endDate = order.停车结束日期 ? new Date(order.停车结束日期).toLocaleDateString('zh-CN') : '';
                            const dateRange = startDate && endDate ? `${startDate}-${endDate}` : '';
                            
                            feeItems.push(`停车费 | ${month}月 | ¥${amount.toFixed(2)} | ${dateRange} | ${carPlate}`);
                        }
                        // 房租（新增）
                        if (order.rent && parseFloat(order.rent.amount) > 0) {
                            const month = parseInt(order.rent.month) || 0;
                            const amount = parseFloat(order.rent.amount) || 0;
                            feeItems.push(`房租 | ${month}月 | ¥${amount.toFixed(2)}`);
                        }
                        
                        // 管理费（新增）
                        if (order.management && parseFloat(order.management.amount) > 0) {
                            const month = parseInt(order.management.month) || 0;
                            const amount = parseFloat(order.management.amount) || 0;
                            feeItems.push(`管理费 | ${month}月 | ¥${amount.toFixed(2)}`);
                        }





                        
                        return {
                            orderId: order.订单ID,
                            billNumber: order.账单号,
                            residentName: order.地址?.姓名 || '',
                            residentPhone: order.地址?.手机号 || '',
                            building: order.地址?.楼栋号 || '',
                            room: order.地址?.房间号 || '',
                            feeItems: feeItems.join('\n'),
                            totalAmount: parseFloat(order.收款金额) || 0,
                            paymentMethod: order.收款方式 || '',
                            entryTime: order.录入时间,
                            remark: order.备注 || ''
                        };
                    });
                    
                    queryData.value = processedData;
                    queryPagination.value = result.pagination;
                    
                    // 计算当前页合计金额
                    currentPageTotal.value = processedData.reduce((sum, order) => sum + order.totalAmount, 0);
                } else {
                    ElMessage.error(result.message || '查询订单失败');
                    queryData.value = [];
                    queryPagination.value.total = 0;
                    currentPageTotal.value = 0;
                }
            } catch (error) {
                console.error('查询订单失败:', error);
                ElMessage.error('网络请求失败');
                queryData.value = [];
                queryPagination.value.total = 0;
                currentPageTotal.value = 0;
            } finally {
                queryLoading.value = false;
            }
        };

        // 重置查询条件
        const resetQuery = () => {
            queryBuilding.value = '';
            queryRoomId.value = '';
            queryRooms.value = [];
            queryData.value = [];
            queryPagination.value = {
                page: 1,
                per_page: 10,
                total: 0,
                pages: 0
            };
            sortColumn.value = '';
            sortOrder.value = 'desc';
            hasQueried.value = false;
            currentPageTotal.value = 0;
            dateError.value = '';
            
            // 清空日期输入框
            document.getElementById('startTime').value = '';
            document.getElementById('endTime').value = '';
        };

        // 表格排序
        const sortByColumn = (column) => {
            if (sortColumn.value === column) {
                sortOrder.value = sortOrder.value === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn.value = column;
                sortOrder.value = 'asc';
            }
            
            // 重新查询
            if (hasQueried.value) {
                queryOrders();
            }
        };

        // 分页大小改变
        const handleSizeChange = (size) => {
            queryPagination.value.per_page = size;
            queryPagination.value.page = 1;
            if (hasQueried.value) {
                queryOrders();
            }
        };

        // 当前页改变
        const handleCurrentChange = (page) => {
            queryPagination.value.page = page;
            if (hasQueried.value) {
                queryOrders();
            }
        };

        // 显示订单详情
        const showOrderDetail = (order) => {
            let detailInfo = `订单号：${order.orderId}\n`;
            detailInfo += `客户信息：${order.residentName || '-'} ${order.residentPhone || '-'}\n`;
            detailInfo += `地址：${order.building || '-'}-${order.room || '-'}\n`;
            detailInfo += `收费金额：¥${formatPrice(order.totalAmount)}\n`;
            detailInfo += `收费日期：${formatDate(order.entryTime)}\n`;
            detailInfo += `收费项目：\n${formatFeeItems(order.feeItems)}`;
            
            if (order.remark) {
                detailInfo += `\n备注：${order.remark}`;
            }
            
            ElMessageBox.alert(detailInfo, '订单详情', {
                confirmButtonText: '确定',
                type: 'info'
            });
        };

        // 复制订单号
        const copyOrderId = async (orderId) => {
            try {
                await navigator.clipboard.writeText(orderId);
                // 显示自定义成功提示
                showCopySuccess('订单号已复制到剪贴板');
            } catch (error) {
                // 降级方案
                const textArea = document.createElement('textarea');
                textArea.value = orderId;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                // 显示自定义成功提示
                showCopySuccess('订单号已复制到剪贴板');
            }
        };

        // 显示复制成功提示
        const showCopySuccess = (message) => {
            // 移除已存在的提示
            const existingTooltip = document.querySelector('.copy-success-tooltip');
            if (existingTooltip) {
                existingTooltip.remove();
            }
            
            // 创建新的提示元素
            const tooltip = document.createElement('div');
            tooltip.className = 'copy-success-tooltip';
            tooltip.textContent = message;
            document.body.appendChild(tooltip);
            
            // 2秒后自动移除
            setTimeout(() => {
                if (tooltip.parentNode) {
                    tooltip.parentNode.removeChild(tooltip);
                }
            }, 2000);
        };

        // 格式化费用项目显示
        const formatFeeItems = (feeItems) => {
            if (!feeItems) return '-';
            
            // 如果是字符串，按换行符分割
            if (typeof feeItems === 'string') {
                return feeItems.split('\n').join('<br>');
            }
            
            // 如果是数组，拼接显示
            if (Array.isArray(feeItems)) {
                return feeItems.map(item => {
                    if (typeof item === 'object') {
                        return `${item.name || ''} | ${item.quantity || ''}${item.unit || ''} | ¥${formatPrice(item.amount || 0)}`;
                    }
                    return String(item);
                }).join('<br>');
            }
            
            return String(feeItems);
        };

        // 返回所有需要的变量和函数
        return {
            user,
            currentPage,
            buildings,
            rooms,
            selectedBuilding,
            selectedRoomId,
            feeItems,
            paymentMethod,
            remark,
            generating,
            residentName,
            residentPhone,
            phoneError,
            totalAmount,
            canGenerate,
            buttonDisabled,
            canDeleteOrder,
            todayUserOrders,
            recentOrders,
            todayTotalAmount,
            receiptData,
            // 退费模式相关
            isRefundMode,
            onRefundModeChange,
            validatePhone,
            onBuildingChange,
            onRoomChange,
            addFeeItem,
            updateItemAmount,
            updateItemQuantityFromAmount,
            removeFeeItem,
            handleQuantityChange,
            handleParkingQuantityChange,
            selectPaymentMethod,
            generateBill,
            clearForm,
            logout,
            goToQuery,
            goToDetailedQuery,
            debugPrices,
            loadFeePrices,
            formatPrice,
            formatDate,
            getParkingItem,
            saveParkingDetails,
            updateParkingEndDate,
            handleParkingStartDateChange,
            getFeeTypeName,
            getFeeUnit,
            goToFeePricesAdmin,
            communityPrices,
            reprintReceipt,
            deleteOrder,
            handleRedReverse,
            historyExpanded,
            historyLoading,
            userHistoryOrders,
            toggleHistory,
            loadUserPaymentHistory,
            // 订单查询相关
            queryBuilding,
            queryRoomId,
            queryBuildings,
            queryRooms,
            queryData,
            queryLoading,
            queryPagination,
            sortColumn,
            sortOrder,
            hasQueried,
            currentPageTotal,
            dateError,
            loadQueryBuildings,
            onQueryBuildingChange,
            onQueryRoomChange,
            validateDateRange,
            queryOrders,
            resetQuery,
            sortByColumn,
            handleSizeChange,
            handleCurrentChange,
            showOrderDetail,
            copyOrderId,
            formatFeeItems
        };
    }
});

// 使用ElementPlus并挂载应用
app.use(ElementPlus).mount('#app');
</script>

</body>
</html>